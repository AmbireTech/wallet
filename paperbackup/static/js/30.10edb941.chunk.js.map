{"version":3,"sources":["../../src/types.ts","../../node_modules/body-scroll-lock/lib/bodyScrollLock.min.js","../../src/consts.ts","../../src/utils.ts","../../src/event-polling.ts","../../src/init-helpers.ts","../../src/ramp-instant-sdk.ts","../node_modules/@transak/transak-sdk/dist/sdk.js"],"names":["EventSeverity","WidgetEventTypes","InternalEventTypes","exports","r","e","Array","isArray","t","o","length","from","Object","defineProperty","value","l","window","passive","addEventListener","removeEventListener","d","navigator","platform","test","c","u","a","s","v","f","some","options","allowTouchMove","m","event","target","touches","preventDefault","setTimeout","document","body","style","paddingRight","overflow","disableBodyScroll","i","console","error","targetElement","concat","ontouchstart","targetTouches","clientY","ontouchmove","n","scrollTop","scrollHeight","clientHeight","stopPropagation","reserveScrollBarGap","innerWidth","documentElement","clientWidth","clearAllBodyScrollLocks","forEach","enableBodyScroll","filter","baseWidgetUrl","getRandomIntString","String","crypto","getRandomValues","Uint32Array","Math","floor","random","widgetDesktopWidth","widgetDesktopHeight","minWidgetMobileWidth","minWidgetMobileHeight","normalizeConfigAndLogErrorsOnInvalidFields","config","errors","configCopy","includes","variant","push","fieldName","description","exampleValue","severity","WARNING","containerNode","Error","HTMLElement","contains","width","height","validateContainerNode","group","log","groupEnd","logErrors","initEventListenersDict","values","reduce","listenersDict","eventType","countListenersForEvent","listeners","internal","handler","determineWidgetVariant","toLocaleLowerCase","isDesktop","matchMedia","matches","concatRelativePath","base","path","url","normalizedBase","URL","href","endsWith","slice","normalizedPath","startsWith","substr","doFetchPurchase","apiUrl","purchaseExternalId","token","fetch","headers","rawResponse","ok","json","delay","ms","Promise","resolve","initWidgetIframeUrl","baseUrl","hostUrl","location","origin","preparedConfig","configWithoutIframeUrl","entries","key","searchParams","append","toString","initDOMNodeWithOverlay","dispatch","querySelector","shadowHost","createElement","shadow","attachShadow","mode","appendChild","getStylesForShadowDom","iframe","prepareIframeNode","overlay","classList","add","loader","innerHTML","querySelectorAll","type","WIDGET_CLOSE_REQUEST","payload","prepareOverlayNode","setAttribute","getBoundingClientRect","innerHeight","styles","isMobile","isEmbedded","textContent","_listeners","_isVisible","_isPollingForSwapStatus","_purchasePollingCredentials","font","head","importFonts","this","unsubscribe","bind","on","show","_handleEscapeClick","_dispatchEvent","_subscribeToWidgetEvents","_on","_processPurchasePollingLoop","_registerSdkEventHandlers","_runPostSubscribeHooks","_rawNormalizedConfig","widgetVariant","_config","widgetInstanceId","activeElement","blur","_isConfiguredAsHosted","_showUsingHostedMode","_isConfiguredAsEmbedded","_showUsingEmbeddedMode","_isConfiguredWithOverlay","_showUsingOverlayMode","callback","filteredHandlers","warn","eventHandlers","close","WIDGET_CLOSE","data","url0","url1","eventData","_event","widgetWindow","domNodes","remove","bodyScrollLock","_teardownEventSubscriptions","onConfigEvent","WIDGET_CONFIG_DONE","WIDGET_CONFIG_FAILED","container","textEl","buttonContainer","cancelButton","WIDGET_CLOSE_REQUEST_CANCELLED","exitButton","WIDGET_CLOSE_REQUEST_CONFIRMED","prepareCloseModalNode","modal","PURCHASE_CREATED","purchase","id","purchaseViewToken","keyCode","PURCHASE_SUCCESSFUL","PURCHASE_FAILED","actions","find","action","newStatus","isHandlerInternal","widgetUrl","_dispatch","initDOMNodeWithoutOverlay","widgetMode","parent","containerWidth","backgroundWebsiteHider","maxWidth","hideWebsiteBelow","open","undefined","module","code","p","call","require","objectCreate","create","objectCreatePolyfill","objectKeys","keys","objectKeysPolyfill","Function","prototype","functionBindPolyfill","EventEmitter","_events","hasOwnProperty","_eventsCount","_maxListeners","hasDefineProperty","defaultMaxListeners","x","err","$getMaxListeners","that","emitNone","isFn","self","len","arrayClone","emitOne","arg1","emitTwo","arg2","emitThree","arg3","emitMany","args","apply","_addListener","listener","prepend","events","existing","TypeError","newListener","emit","unshift","warned","w","name","emitter","count","message","onceWrapper","fired","removeListener","wrapFn","arguments","_onceWrap","state","wrapped","unwrap","evlistener","unwrapListeners","listenerCount","spliceOne","list","index","k","pop","arr","copy","ret","proto","F","obj","context","fn","enumerable","get","set","arg","setMaxListeners","isNaN","getMaxListeners","er","doError","addListener","prependListener","once","prependOnceListener","position","originalListener","shift","removeAllListeners","rawListeners","eventNames","Reflect","ownKeys","singleMatcher","RegExp","multiMatcher","decodeComponents","components","split","decodeURIComponent","join","left","right","decode","input","tokens","match","customDecodeURIComponent","replaceMap","exec","result","replace","encodedURI","predicate","isArr","val","indexOf","strictUriEncode","decodeComponent","splitOnFirst","filterObject","isNullOrUndefined","encoderForArrayFormat","arrayFormat","skipNull","skipEmptyString","encode","arrayFormatSeparator","parserForArrayFormat","accumulator","isEncodedArray","newValue","map","item","validateArrayFormatSeparator","strict","encodeURIComponent","keysSorter","sort","b","Number","removeHash","hashStart","getHash","hash","extract","queryStart","parseValue","parseNumbers","trim","parseBooleans","toLowerCase","parse","query","assign","formatter","param","Boolean","stringify","object","shouldFilter","objectCopy","parseUrl","url_","parseFragmentIdentifier","fragmentIdentifier","stringifyUrl","queryFromUrl","parsedQueryFromUrl","queryString","pick","exclude","exclusionFilter","string","separator","separatorIndex","str","charCodeAt","toUpperCase","getCSS","themeColor","closeSVGIcon","default","_default","SOMETHING_WRONG","ENTER_API_KEY","NOT_INITIALIZED_PROPERLY","TRANSAK_WIDGET_INITIALISED","TRANSAK_WIDGET_OPEN","TRANSAK_WIDGET_CLOSE_REQUEST","TRANSAK_WIDGET_CLOSE","TRANSAK_ORDER_CREATED","TRANSAK_ORDER_CANCELLED","TRANSAK_ORDER_FAILED","TRANSAK_ORDER_SUCCESSFUL","ENVIRONMENT","STAGING","FRONTEND","BACKEND","NAME","LOCAL_DEVELOPMENT","DEVELOPMENT","PRODUCTION","STATUS","INIT","TRANSAK_INITIALISED","_globalConfig","_errors","_interopRequireDefault","__esModule","_constants","_svg","_css","_queryString","_package","eventEmitter","TransakSDK","partnerData","sdkVersion","version","isInitialised","EVENTS","ALL_EVENTS","ERROR","generateURL","configData","environment","apiKey","cryptoCurrencyCode","defaultCryptoCurrency","walletAddress","fiatAmount","defaultFiatAmount","defaultCryptoAmount","walletAddressesData","networks","coins","JSON","fiatCurrency","countryCode","paymentMethod","defaultPaymentMethod","isAutoFillUserData","isFeeCalculationHidden","disablePaymentMethods","email","userData","partnerOrderId","partnerCustomerId","exchangeScreenTitle","hideMenu","accessToken","hideExchangeScreen","isDisableCrypto","redirectURL","hostURL","disableWalletAddressForm","cryptoCurrencyList","defaultNetwork","network","errorsLang","widgetWidth","widgetHeight","setStyle","getElementById","handleMessage","event_id","status","eventName","scroll","display","cb","init","closeRequest","iframeEl","contentWindow","postMessage","wrapper","getElementsByTagName","span","getElementsByClassName","onclick","attachEvent","UrlEncode","encodeornot","out"],"mappings":"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","file":"static/js/30.10edb941.chunk.js","sourcesContent":["type TAsset = string;\ntype TEthAddress = string;\ntype TSwapAmount = string;\ntype THostLogoUrl = string;\ntype THostApiKey = string;\ntype THostAppName = string;\ntype TURL = string;\ntype TDateString = string;\ntype TFiatCurrency = string;\ntype TFiatValue = string;\ntype TAddress = string;\ntype TEmailAddress = string;\ntype TCryptoAmount = string;\ntype TPoolFee = number;\ntype TRampFee = number;\ntype TAssetExchangeRate = number;\ntype TPurchaseHash = string;\ntype TActionID = string;\ntype TNewActionStatus = string;\ntype TActionTimestamp = string;\ntype TActionDetails = string;\ntype TWebhookStatusUrl = string;\ntype TFinalUrl = string;\ntype TContainerNode = HTMLElement;\nexport type TPurchaseExternalId = string;\n\nexport interface IHostConfig {\n  swapAsset?: TAsset;\n  swapAmount?: TSwapAmount;\n  fiatValue?: TFiatValue;\n  fiatCurrency?: TFiatCurrency;\n  userAddress?: TEthAddress;\n  userEmailAddress?: TEmailAddress;\n  hostApiKey?: THostApiKey;\n  hostLogoUrl: THostLogoUrl;\n  hostAppName: THostAppName;\n  url?: TURL;\n  variant?: AllWidgetVariants;\n  webhookStatusUrl?: TWebhookStatusUrl;\n  finalUrl?: TFinalUrl;\n  containerNode?: TContainerNode;\n  selectedCountryCode?: string;\n  defaultAsset?: TAsset;\n}\n\nexport interface IPurchasePollingCredentials {\n  token: string;\n  apiUrl: string;\n  purchaseExternalId: TPurchaseExternalId;\n}\n\nexport interface IHostConfigWithWidgetInstanceId extends IHostConfig {\n  widgetInstanceId: string;\n  variant: AllWidgetVariants;\n}\n\nexport interface IAssetInfo {\n  address: string | null;\n  symbol: string;\n  name: string;\n  decimals: number;\n}\n\nexport interface IPurchase {\n  id: TPurchaseExternalId;\n  endTime: TDateString | null;\n  /** @deprecated use `asset.address` */\n  tokenAddress: TAddress | null;\n  asset: IAssetInfo;\n  escrowAddress?: TAddress;\n  receiverAddress: TAddress;\n  cryptoAmount: TCryptoAmount;\n  /** @deprecated use `cryptoAmount` */\n  ethAmount?: TCryptoAmount;\n  /** @deprecated use `cryptoAmount` */\n  tokenAmount?: TCryptoAmount;\n  fiatCurrency: TFiatCurrency;\n  fiatValue: TFiatValue;\n  assetExchangeRate: TAssetExchangeRate;\n  poolFee: TPoolFee;\n  rampFee: TRampFee;\n  purchaseHash: TPurchaseHash;\n  actions: IAction[];\n}\n\nexport interface IAction {\n  id: TActionID;\n  newStatus: TNewActionStatus;\n  timestamp: TActionTimestamp;\n  details: TActionDetails;\n}\n\nexport enum EventSeverity {\n  VERBOSE = 'VERBOSE',\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARNING = 'WARNING',\n  ERROR = 'ERROR',\n  CRITICAL = 'CRITICAL',\n}\n\nexport interface IConfigError {\n  fieldName: string;\n  description: string;\n  exampleValue?: string;\n  severity: EventSeverity;\n}\n\nexport interface IWidgetEvent {\n  type: string;\n  payload: any | null;\n  internal?: boolean;\n}\n\nexport enum WidgetEventTypes {\n  WIDGET_CLOSE = 'WIDGET_CLOSE',\n  WIDGET_CONFIG_DONE = 'WIDGET_CONFIG_DONE',\n  WIDGET_CONFIG_FAILED = 'WIDGET_CONFIG_FAILED',\n  PURCHASE_CREATED = 'PURCHASE_CREATED',\n  PURCHASE_SUCCESSFUL = 'PURCHASE_SUCCESSFUL',\n  PURCHASE_FAILED = 'PURCHASE_FAILED',\n}\n\nexport enum InternalEventTypes {\n  WIDGET_CLOSE_REQUEST = 'WIDGET_CLOSE_REQUEST',\n  WIDGET_CLOSE_REQUEST_CANCELLED = 'WIDGET_CLOSE_REQUEST_CANCELLED',\n  WIDGET_CLOSE_REQUEST_CONFIRMED = 'WIDGET_CLOSE_REQUEST_CONFIRMED',\n}\n\nexport type TAllEventTypes = WidgetEventTypes | InternalEventTypes;\n\nexport interface IWidgetCloseEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CLOSE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseCreatedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_CREATED;\n  payload: {\n    purchase: IPurchase;\n    purchaseViewToken: string;\n    apiUrl: string;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseSuccessfulEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_SUCCESSFUL;\n  payload: {\n    purchase: IPurchase;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseFailedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_FAILED;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigDoneEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_DONE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigFailedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_FAILED;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetCloseRequestEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST;\n  payload: null;\n  widgetInstanceId?: string;\n  internal: boolean;\n}\n\nexport interface IWidgetCloseRequestCancelledEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED;\n  payload: null;\n  internal: true;\n}\n\nexport interface IWidgetCloseRequestConfirmedEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED;\n  payload: null;\n  internal: true;\n}\n\nexport type TWidgetEvents =\n  | IWidgetCloseEvent\n  | IWidgetConfigDoneEvent\n  | IWidgetConfigFailedEvent\n  | IPurchaseCreatedEvent\n  | IPurchaseFailedEvent\n  | IPurchaseSuccessfulEvent;\n\nexport type TInternalEvents =\n  | IWidgetCloseRequestEvent\n  | IWidgetCloseRequestCancelledEvent\n  | IWidgetCloseRequestConfirmedEvent;\n\nexport type TAllEvents = TWidgetEvents | TInternalEvents;\n\nexport type WidgetVariantTypes = 'desktop' | 'mobile' | 'hosted-desktop' | 'hosted-mobile';\n\nexport type SyntheticWidgetVariants =\n  | 'hosted-auto'\n  | 'auto'\n  | 'embedded-desktop'\n  | 'embedded-mobile';\n\nexport type AllWidgetVariants = WidgetVariantTypes | SyntheticWidgetVariants;\n\nexport type TUnsubscribeToken = string;\n\nexport type TEventListenerDict = {\n  [EventType in TAllEvents['type']]: IEventListener[];\n};\n\nexport interface IEventListener {\n  internal: boolean;\n  callback(evt: TAllEvents): any;\n}\n","!function(e,t){if(\"function\"==typeof define&&define.amd)define([\"exports\"],t);else if(\"undefined\"!=typeof exports)t(exports);else{var o={};t(o),e.bodyScrollLock=o}}(this,function(exports){\"use strict\";function r(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}Object.defineProperty(exports,\"__esModule\",{value:!0});var l=!1;if(\"undefined\"!=typeof window){var e={get passive(){l=!0}};window.addEventListener(\"testPassive\",null,e),window.removeEventListener(\"testPassive\",null,e)}var d=\"undefined\"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),c=[],u=!1,a=-1,s=void 0,v=void 0,f=function(t){return c.some(function(e){return!(!e.options.allowTouchMove||!e.options.allowTouchMove(t))})},m=function(e){var t=e||window.event;return!!f(t.target)||(1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1))},o=function(){setTimeout(function(){void 0!==v&&(document.body.style.paddingRight=v,v=void 0),void 0!==s&&(document.body.style.overflow=s,s=void 0)})};exports.disableBodyScroll=function(i,e){if(d){if(!i)return void console.error(\"disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.\");if(i&&!c.some(function(e){return e.targetElement===i})){var t={targetElement:i,options:e||{}};c=[].concat(r(c),[t]),i.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},i.ontouchmove=function(e){var t,o,n,r;1===e.targetTouches.length&&(o=i,r=(t=e).targetTouches[0].clientY-a,!f(t.target)&&(o&&0===o.scrollTop&&0<r?m(t):(n=o)&&n.scrollHeight-n.scrollTop<=n.clientHeight&&r<0?m(t):t.stopPropagation()))},u||(document.addEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!0)}}else{n=e,setTimeout(function(){if(void 0===v){var e=!!n&&!0===n.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(v=document.body.style.paddingRight,document.body.style.paddingRight=t+\"px\")}void 0===s&&(s=document.body.style.overflow,document.body.style.overflow=\"hidden\")});var o={targetElement:i,options:e||{}};c=[].concat(r(c),[o])}var n},exports.clearAllBodyScrollLocks=function(){d?(c.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),u&&(document.removeEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!1),c=[],a=-1):(o(),c=[])},exports.enableBodyScroll=function(t){if(d){if(!t)return void console.error(\"enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.\");t.ontouchstart=null,t.ontouchmove=null,c=c.filter(function(e){return e.targetElement!==t}),u&&0===c.length&&(document.removeEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!1)}else(c=c.filter(function(e){return e.targetElement!==t})).length||o()}});\n","export const baseWidgetUrl = 'https://buy.ramp.network/';\n","import {\n  AllWidgetVariants,\n  EventSeverity,\n  IConfigError,\n  IHostConfig,\n  InternalEventTypes,\n  SyntheticWidgetVariants,\n  TAllEventTypes,\n  TEventListenerDict,\n  WidgetEventTypes,\n  WidgetVariantTypes,\n} from './types';\n\nexport function getRandomIntString(): string {\n  try {\n    return String(crypto.getRandomValues(new Uint32Array(1))[0]);\n  } catch {\n    // if `crypto` is not supported, fall back to Math.random\n    // tslint:disable-next-line:no-magic-numbers\n    return String(Math.floor(Math.random() * 10000000));\n  }\n}\n\nexport const widgetDesktopWidth = 895;\nexport const widgetDesktopHeight = 590;\n\nexport const minWidgetMobileWidth = 320;\nexport const minWidgetMobileHeight = 667;\n\nexport function normalizeConfigAndLogErrorsOnInvalidFields(\n  config: Partial<IHostConfig>\n): IHostConfig {\n  const errors: IConfigError[] = [];\n  const configCopy = { ...config };\n\n  if (\n    ![\n      'desktop',\n      'mobile',\n      'hosted-desktop',\n      'hosted-mobile',\n      'hosted-auto',\n      'auto',\n      'embedded-desktop',\n      'embedded-mobile',\n    ].includes(config.variant!)\n  ) {\n    configCopy.variant = 'desktop';\n\n    errors.push({\n      fieldName: 'variant',\n      description: 'Invalid value for `variant` config field ',\n      exampleValue: `'desktop'`,\n      severity: EventSeverity.WARNING,\n    });\n  }\n\n  if (config.variant === 'embedded-desktop' || config.variant === 'embedded-mobile') {\n    validateContainerNode(config.containerNode, config.variant);\n  }\n\n  if (!['embedded-desktop', 'embedded-mobile'].includes(configCopy.variant!)) {\n    delete configCopy.containerNode;\n  }\n\n  logErrors(errors);\n\n  return configCopy as IHostConfig;\n}\n\nfunction logErrors(errors: IConfigError[]): void {\n  if (!errors.length) {\n    return;\n  }\n\n  // tslint:disable:no-console\n  console.group('Config errors');\n\n  errors.forEach((error) => {\n    console.group(error.fieldName);\n\n    console.log(error.description);\n    console.log(`Example expected value: ${error.exampleValue}`);\n    console.log(`Severity: ${error.severity}`);\n\n    console.groupEnd();\n  });\n\n  console.groupEnd();\n  // tslint:enable:no-console\n}\n\nexport function initEventListenersDict(): TEventListenerDict {\n  const widgetEventTypes = Array.from(Object.values(WidgetEventTypes));\n  const internalEventTypes = Array.from(Object.values(InternalEventTypes));\n\n  return [...widgetEventTypes, ...internalEventTypes].reduce<TEventListenerDict>(\n    (listenersDict: TEventListenerDict, eventType: TAllEventTypes) => {\n      listenersDict[eventType] = [];\n\n      return listenersDict;\n    },\n    {} as any\n  ) as TEventListenerDict;\n}\n\nexport function countListenersForEvent(\n  listeners: TEventListenerDict,\n  event: TAllEventTypes,\n  internal: boolean = false\n): number {\n  return listeners[event].filter((handler) => handler.internal === internal).length;\n}\n\nexport function determineWidgetVariant(config: IHostConfig): AllWidgetVariants {\n  const mediaQuery = '(min-width: 920px) and (min-height: 630px)';\n  const variant = config.variant?.toLocaleLowerCase();\n\n  if (\n    variant === 'mobile' ||\n    variant === 'desktop' ||\n    variant === 'hosted-mobile' ||\n    variant === 'hosted-desktop' ||\n    variant === 'embedded-desktop' ||\n    variant === 'embedded-mobile'\n  ) {\n    return variant;\n  }\n\n  const isDesktop = window.matchMedia(mediaQuery).matches;\n\n  if (variant === 'hosted-auto') {\n    return isDesktop ? 'hosted-desktop' : 'hosted-mobile';\n  }\n\n  return isDesktop ? 'desktop' : 'mobile';\n}\n\nexport function isHtmlElement(element: Element): element is HTMLElement {\n  return typeof (element as any).blur === 'function';\n}\n\nfunction validateContainerNode(\n  containerNode: HTMLElement | undefined,\n  variant: SyntheticWidgetVariants\n): void {\n  if (!document.body) {\n    throw new Error(\"Couldn't find <body> element.\");\n  }\n\n  if (!(containerNode instanceof HTMLElement)) {\n    throw new Error('Container node has to be a proper HTML element.');\n  }\n\n  if (!document.body.contains(containerNode)) {\n    throw new Error('Container node must be attached to the document.');\n  }\n\n  const { width, height } = containerNode.getBoundingClientRect();\n\n  if (variant === 'embedded-desktop') {\n    if (width + 1 < widgetDesktopWidth) {\n      throw new Error(`Container node must be at least ${widgetDesktopWidth}px wide.`);\n    }\n\n    if (height + 1 < widgetDesktopHeight) {\n      throw new Error(`Container node must be at least ${widgetDesktopHeight}px tall.`);\n    }\n  } else if (variant === 'embedded-mobile') {\n    if (width + 1 < minWidgetMobileWidth) {\n      throw new Error(`Container node must be at least ${minWidgetMobileWidth}px wide.`);\n    }\n\n    if (height + 1 < minWidgetMobileHeight) {\n      throw new Error(`Container node must be at least ${minWidgetMobileHeight}px tall.`);\n    }\n  }\n}\n\n/**\n * Concatenates `base` with `path`, always treating `path` as a relative path. Ignores:\n *   - trailing slash in `base`\n *   - leading slash in `path`\n * @param base base URL, e.g.: 'http://example.com/api' or 'http://example.com/service/api/'\n * @param path path to append, e.g.: 'user/getByEmail' or '/swap'\n */\nexport function concatRelativePath(base: string | URL, path: string): URL {\n  const normalizedBase = urlWithoutTrailingSlash(base instanceof URL ? base.href : base);\n  const normalizedPath = path.startsWith('/') ? path.substr(1) : path;\n  return new URL(`${normalizedBase}/${normalizedPath}`);\n}\n\nexport function urlWithoutTrailingSlash(url: string): string {\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n","import { IPurchase, TPurchaseExternalId } from './types';\nimport { concatRelativePath } from './utils';\n\nexport async function doFetchPurchase(\n  apiUrl: string,\n  purchaseExternalId: TPurchaseExternalId,\n  token: string\n): Promise<IPurchase | null> {\n  try {\n    const rawResponse = await fetch(\n      concatRelativePath(apiUrl, `/host-api/purchase/${purchaseExternalId}?secret=${token}`).href,\n      {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n    );\n\n    if (!rawResponse.ok) {\n      throw new Error(`Request for purchase #${purchaseExternalId} failed`);\n    }\n\n    const response = await rawResponse.json();\n\n    return response as IPurchase;\n  } catch {\n    return null;\n  }\n}\n\nexport async function delay(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n","import { baseWidgetUrl } from './consts';\nimport {\n  AllWidgetVariants,\n  IHostConfigWithWidgetInstanceId,\n  InternalEventTypes,\n  TAllEvents,\n  WidgetVariantTypes,\n} from './types';\nimport {\n  minWidgetMobileHeight,\n  minWidgetMobileWidth,\n  widgetDesktopHeight,\n  widgetDesktopWidth,\n} from './utils';\n\nexport function initWidgetIframeUrl(config: IHostConfigWithWidgetInstanceId): string {\n  const baseUrl = new URL(config.url || baseWidgetUrl);\n  const hostUrl = window.location.origin;\n\n  const { containerNode, url, ...configWithoutIframeUrl } = config;\n\n  const preparedConfig = { ...configWithoutIframeUrl, hostUrl };\n\n  Object.entries(preparedConfig).forEach(([key, value]) => {\n    if (value) {\n      baseUrl.searchParams.append(key, value);\n    }\n  });\n\n  return baseUrl.toString();\n}\n\nexport function hideWebsiteBelow(\n  parent: Element | ShadowRoot,\n  containerWidth?: number | undefined\n): void {\n  const backgroundWebsiteHider = document.createElement('div');\n  backgroundWebsiteHider.classList.add('background-hider');\n\n  if (containerWidth) {\n    backgroundWebsiteHider.style.maxWidth = `${containerWidth}px`;\n  }\n\n  parent.appendChild(backgroundWebsiteHider);\n}\n\nexport function initDOMNodeWithOverlay(\n  url: string,\n  dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithWidgetInstanceId\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: HTMLDivElement;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant);\n  const overlay = prepareOverlayNode(iframe, dispatch);\n\n  overlay.appendChild(iframe);\n  shadow.appendChild(overlay);\n\n  return {\n    body,\n    iframe,\n    overlay,\n    shadow,\n    shadowHost,\n  };\n}\n\nexport function initDOMNodeWithoutOverlay(\n  url: string,\n  _dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithWidgetInstanceId\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: null;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  const container = document.createElement('div');\n  container.classList.add('embedded-container');\n\n  shadow.appendChild(container);\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  container.appendChild(loader);\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant, config.containerNode);\n\n  container.appendChild(iframe);\n\n  return {\n    body,\n    iframe,\n    overlay: null,\n    shadow,\n    shadowHost,\n  };\n}\n\nexport function importFonts(): void {\n  if (document.querySelector('[data-ramp-font]')) {\n    return;\n  }\n\n  const font = document.createElement('link');\n\n  font.setAttribute(\n    'href',\n    'https://fonts.googleapis.com/css?family=Poppins:200,400,500,600,700&display=swap&subset=latin-ext'\n  );\n  font.setAttribute('rel', 'stylesheet');\n  font.setAttribute('data-ramp-font', '');\n\n  document.head.appendChild(font);\n}\n\nfunction prepareIframeNode(\n  url: string,\n  variant: AllWidgetVariants,\n  containerNode?: HTMLElement\n): HTMLIFrameElement {\n  const iframe = document.createElement('iframe');\n\n  iframe.setAttribute('src', url);\n\n  if (containerNode) {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : containerNode.getBoundingClientRect().width.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : containerNode.getBoundingClientRect().height.toString()\n    );\n  } else {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : window.innerWidth.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : window.innerHeight.toString()\n    );\n  }\n\n  iframe.classList.add('iframe');\n\n  return iframe;\n}\n\nfunction prepareOverlayNode(\n  iframe: HTMLIFrameElement,\n  dispatch: (event: TAllEvents) => void\n): HTMLDivElement {\n  const overlay = document.createElement('div');\n\n  overlay.classList.add('overlay');\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  overlay.appendChild(loader);\n\n  overlay.addEventListener('click', (event) => {\n    if (event.target !== iframe && !overlay.querySelectorAll('.close-modal').length) {\n      dispatch({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  });\n\n  return overlay;\n}\n\nexport function areUrlsEqual(url0: string, url1: string): boolean {\n  return new URL(url0).toString() === new URL(url1).toString();\n}\n\nexport function isCloseModalAlreadyOpen(containerNode: HTMLElement): boolean {\n  return containerNode.querySelectorAll('.close-modal').length !== 0;\n}\n\nexport function prepareCloseModalNode(dispatch: (event: TAllEvents) => void): HTMLDivElement {\n  const container = document.createElement('div');\n  container.classList.add('close-modal');\n\n  const textEl = document.createElement('div');\n  textEl.classList.add('close-modal__text');\n  textEl.textContent = 'Are you sure you want to exit Ramp and abandon the transaction?';\n\n  const buttonContainer = document.createElement('div');\n  buttonContainer.classList.add('close-modal__button-container');\n\n  const cancelButton = document.createElement('button');\n  cancelButton.setAttribute('type', 'button');\n  cancelButton.classList.add('close-modal__button');\n  cancelButton.classList.add('close-modal__button--cancel');\n  cancelButton.textContent = 'Cancel';\n  cancelButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  const exitButton = document.createElement('button');\n  exitButton.setAttribute('type', 'button');\n  exitButton.classList.add('close-modal__button');\n  exitButton.classList.add('close-modal__button--exit');\n  exitButton.textContent = 'Exit';\n  exitButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  buttonContainer.appendChild(cancelButton);\n  buttonContainer.appendChild(exitButton);\n\n  container.appendChild(textEl);\n  container.appendChild(buttonContainer);\n\n  return container;\n}\n\nfunction getStylesForShadowDom(variant: AllWidgetVariants): HTMLStyleElement {\n  const styles = document.createElement('style');\n\n  const isMobile =\n    variant === 'mobile' || variant === 'hosted-mobile' || variant === 'embedded-mobile';\n  const isEmbedded = variant === 'embedded-mobile' || variant === 'embedded-desktop';\n\n  styles.textContent = `\n\n    .background-hider {\n      content: '';\n      height: 30vh;\n      width: 100vw;\n      position: fixed;\n      bottom: 0;\n      transform: translateY(50%);\n      background-color: #f5f8fb;\n      z-index: 999;\n    }\n\n    .overlay {\n      position: fixed;\n      z-index: 1000;\n      width: 100vw;\n      height: ${isMobile ? '100%;' : '100vh;'}\n      top: 0;\n      left: 0;\n      overflow: hidden;\n      background-color: rgba(166, 174, 185, 0.7);\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n    }\n\n    .embedded-container {\n      z-index: 1000;\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n      min-width: ${isMobile ? minWidgetMobileWidth : widgetDesktopWidth}px;\n      min-height: ${isMobile ? minWidgetMobileHeight : widgetDesktopHeight}px;\n    }\n\n    .loader-container {\n      align-self: center;\n    }\n\n    .loader {\n      transform-origin: center;\n      animation: logoAnimation 4s linear infinite;\n      width: 100px;\n      height: auto;\n      align-self: center;\n    }\n\n    .loader path:nth-child(3) {\n      transform-origin: center;\n      position: relative;\n    }\n\n    .loader path:nth-child(1) {\n      transform-origin: center;\n      position: relative;\n      animation: box1Animation 4s linear infinite;\n      transform: scale(0.4) translateX(6px);\n    }\n\n    .loader path:nth-child(2) {\n      transform-origin: center;\n      position: relative;\n      animation: box4Animation 4s linear infinite;\n      transform: scale(0.4) translateX(-6px);\n    }\n\n    @keyframes logoAnimation {\n      10% {\n        transform: rotate(180deg);\n      }\n      30%{\n        transform: rotate(360deg);\n      }\n      70% {\n        transform: rotate(360deg);\n      }\n      90% {\n        transform: rotate(520deg);\n      }\n      100% {\n        transform: rotate(720deg);\n      }\n    }\n\n    @keyframes box1Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(6px);\n      }\n    }\n\n\n    @keyframes box4Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(-6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(-6px);\n      }\n    }\n\n    .iframe {\n      border: none;\n      user-select: none;\n      visibility: hidden;\n      position: absolute;\n    }\n\n    .iframe.visible {\n      visibility: visible;\n      ${\n        !isEmbedded && isMobile\n          ? `\n        width: 100vw;\n        height: 100%;\n      `\n          : ''\n      }\n    }\n\n    .close-modal {\n      font-family: 'Poppins', sans-serif;\n      width: 678px;\n      height: 276px;\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      transform: translate(-50%, -50%);\n      z-index: 9999;\n      box-shadow: 0px 54px 200px rgba(36, 37, 57, 0.2);\n      display: flex;\n      flex-flow: column nowrap;\n      justify-content: flex-start;\n      align-items: center;\n      padding: 35px;\n      border-radius: 8px;\n      background: #fff;\n\n      box-sizing: border-box;\n    }\n\n    .close-modal * {\n      box-sizing: border-box;\n    }\n\n    .close-modal__text {\n      margin: 40px auto 30px;\n      font-weight: 600;\n      font-size: 24px;\n      line-height: 36px;\n      text-align: center;\n\n      color: #242539;\n    }\n\n    .close-modal__button-container {\n      width: 318px;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .close-modal__button {\n      background: #fff;\n      border: 2px solid #EDEEF3;\n      border-radius: 74px;\n      width: 152px;\n      height: 56px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 14px;\n      line-height: 21px;\n      color: #2B2D56;\n      text-transform: uppercase;\n    }\n\n    .close-modal__button--exit {\n      background: #DD3E56;\n      box-shadow: 0px 8px 34px rgba(221, 62, 86, 0.4);\n      color: #fff;\n      border-color: transparent;\n    }\n  `;\n\n  return styles;\n}\n","import bodyScrollLock from 'body-scroll-lock';\nimport { baseWidgetUrl } from './consts';\nimport { delay, doFetchPurchase } from './event-polling';\nimport { hideWebsiteBelow } from './init-helpers';\n\nimport {\n  areUrlsEqual,\n  importFonts,\n  initDOMNodeWithoutOverlay,\n  initDOMNodeWithOverlay,\n  initWidgetIframeUrl,\n  isCloseModalAlreadyOpen,\n  prepareCloseModalNode,\n} from './init-helpers';\n\nimport {\n  IHostConfig,\n  IHostConfigWithWidgetInstanceId,\n  InternalEventTypes,\n  IPurchaseCreatedEvent,\n  IPurchasePollingCredentials,\n  TAllEvents,\n  TAllEventTypes,\n  TEventListenerDict,\n  TWidgetEvents,\n  WidgetEventTypes,\n} from './types';\n\nimport {\n  countListenersForEvent,\n  determineWidgetVariant,\n  getRandomIntString,\n  initEventListenersDict,\n  isHtmlElement,\n  normalizeConfigAndLogErrorsOnInvalidFields,\n} from './utils';\n\nexport {\n  IWidgetCloseEvent as WidgetCloseEvent,\n  IWidgetCloseRequestCancelledEvent as WidgetCloseRequestCancelledEvent,\n  IWidgetCloseRequestConfirmedEvent as WidgetCloseRequestConfirmedEvent,\n  IWidgetCloseRequestEvent as WidgetCloseRequestEvent,\n  IWidgetConfigDoneEvent as WidgetConfigDoneEvent,\n  IWidgetEvent as RampInstantEvent,\n  TWidgetEvents as RampInstantEvents,\n  WidgetEventTypes as RampInstantEventTypes,\n  AllWidgetVariants as RampInstantWidgetVariantTypes,\n  IPurchase as RampInstantPurchase,\n} from './types';\n\nexport class RampInstantSDK {\n  public widgetWindow?: Window;\n  public domNodes?: {\n    body: HTMLBodyElement | null;\n    iframe: HTMLIFrameElement;\n    overlay: HTMLDivElement | null;\n    shadowHost: HTMLDivElement;\n    shadow: ShadowRoot;\n  };\n\n  private _config: IHostConfigWithWidgetInstanceId;\n  private _rawNormalizedConfig: IHostConfig;\n  private _listeners: TEventListenerDict = initEventListenersDict();\n  private _isVisible: boolean = false;\n  private _isPollingForSwapStatus: boolean = false;\n  private _purchasePollingCredentials: IPurchasePollingCredentials | null = null;\n\n  constructor(config: IHostConfig) {\n    importFonts();\n\n    this.unsubscribe = this.unsubscribe.bind(this);\n    this.on = this.on.bind(this);\n    this.show = this.show.bind(this);\n    this._handleEscapeClick = this._handleEscapeClick.bind(this);\n    this._dispatchEvent = this._dispatchEvent.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._on = this._on.bind(this);\n    this._processPurchasePollingLoop = this._processPurchasePollingLoop.bind(this);\n    this._registerSdkEventHandlers = this._registerSdkEventHandlers.bind(this);\n    this._runPostSubscribeHooks = this._runPostSubscribeHooks.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n\n    this._rawNormalizedConfig = normalizeConfigAndLogErrorsOnInvalidFields({\n      variant: 'desktop',\n      ...config,\n    });\n\n    const widgetVariant = determineWidgetVariant(this._rawNormalizedConfig);\n\n    this._config = {\n      ...this._rawNormalizedConfig,\n      variant: widgetVariant,\n      widgetInstanceId: getRandomIntString(),\n    };\n  }\n\n  public show(): RampInstantSDK {\n    if (this._isVisible) {\n      throw new Error('Widget is already visible - you can only call this once per instance');\n    }\n\n    if (document.activeElement && isHtmlElement(document.activeElement)) {\n      document.activeElement.blur();\n    }\n\n    this._registerSdkEventHandlers();\n\n    window.addEventListener('message', this._subscribeToWidgetEvents);\n\n    if (this._isConfiguredAsHosted()) {\n      this._showUsingHostedMode();\n    } else if (this._isConfiguredAsEmbedded()) {\n      this._showUsingEmbeddedMode();\n    } else if (this._isConfiguredWithOverlay()) {\n      this._showUsingOverlayMode();\n    }\n\n    window.addEventListener('keydown', this._handleEscapeClick, true);\n\n    return this;\n  }\n\n  public on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any\n  ): RampInstantSDK {\n    this._on(type, callback, false);\n\n    return this;\n  }\n\n  public unsubscribe(\n    type: TAllEvents['type'] | '*',\n    callback: (event: TAllEvents) => any\n  ): RampInstantSDK {\n    if (type === '*') {\n      const allTypes = Object.entries(this._listeners);\n\n      allTypes.forEach(([key, eventHandlers]) => {\n        const filteredHandlers = eventHandlers.filter((l) => l.callback !== callback);\n        this._listeners[key as TAllEventTypes] = filteredHandlers;\n      });\n    } else {\n      this._listeners[type] = this._listeners[type].filter((l) => l.callback !== callback);\n    }\n\n    return this;\n  }\n\n  public _on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any,\n    internal: boolean\n  ): void {\n    if (type !== '*' && !this._listeners[type]) {\n      // tslint:disable-next-line:no-console\n      console.warn(\n        `Unknown / unsupported event name - '${type}'. This listener will have no effect.`\n      );\n    }\n\n    if (type === '*') {\n      const allTypes = Object.values(this._listeners);\n      allTypes.forEach((eventHandlers) => eventHandlers.push({ callback, internal }));\n    } else {\n      this._listeners[type].push({ callback, internal });\n    }\n\n    this._runPostSubscribeHooks(type, internal);\n  }\n\n  public close(): RampInstantSDK {\n    this._dispatchEvent({\n      type: WidgetEventTypes.WIDGET_CLOSE,\n      payload: null,\n      widgetInstanceId: this._config.widgetInstanceId,\n    });\n\n    return this;\n  }\n\n  private _subscribeToWidgetEvents(event: MessageEvent): void {\n    if (!event.data) {\n      return;\n    }\n\n    if (!areUrlsEqual(event.origin, this._config.url || baseWidgetUrl)) {\n      return;\n    }\n\n    const eventData = event.data as TWidgetEvents;\n\n    if (\n      !eventData.widgetInstanceId ||\n      eventData.widgetInstanceId !== this._config.widgetInstanceId\n    ) {\n      return;\n    }\n\n    this._dispatchEvent(eventData);\n  }\n\n  private _registerSdkEventHandlers(): void {\n    this._on(\n      WidgetEventTypes.WIDGET_CLOSE,\n      (_event) => {\n        if (this._isConfiguredAsHosted()) {\n          try {\n            this.widgetWindow?.close();\n          } catch (e) {\n            throw new Error('Could not close the widget window');\n          }\n        } else {\n          this.domNodes?.shadowHost.remove();\n          bodyScrollLock.clearAllBodyScrollLocks();\n        }\n\n        this._teardownEventSubscriptions();\n      },\n      true\n    );\n\n    const onConfigEvent = () => {\n      if (this._isConfiguredAsHosted()) {\n        return;\n      }\n\n      this.domNodes?.iframe.classList.add('visible');\n\n      const loader = this.domNodes?.shadow.querySelector('.loader-container');\n\n      if (loader) {\n        loader.remove();\n      }\n    };\n\n    this._on(WidgetEventTypes.WIDGET_CONFIG_DONE, onConfigEvent, true);\n    this._on(WidgetEventTypes.WIDGET_CONFIG_FAILED, onConfigEvent, true);\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        if (this._config.variant === 'mobile' || isCloseModalAlreadyOpen(this.domNodes!.overlay!)) {\n          return;\n        }\n\n        this.domNodes!.overlay!.appendChild(prepareCloseModalNode(this._dispatchEvent));\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      (_event) => {\n        this._dispatchEvent({\n          type: WidgetEventTypes.WIDGET_CLOSE,\n          payload: null,\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        const modal = this.domNodes!.overlay!.querySelector('.close-modal');\n\n        if (modal) {\n          modal.remove();\n        }\n      },\n      true\n    );\n\n    this._on(\n      WidgetEventTypes.PURCHASE_CREATED,\n      (event: IPurchaseCreatedEvent) => {\n        this._purchasePollingCredentials = {\n          apiUrl: event.payload.apiUrl,\n          purchaseExternalId: event.payload.purchase.id,\n          token: event.payload.purchaseViewToken,\n        };\n\n        // tslint:disable-next-line:no-floating-promises\n        this._processPurchasePollingLoop(this._purchasePollingCredentials);\n      },\n      true\n    );\n  }\n\n  private _dispatchEvent(event: TAllEvents): void {\n    const { type } = event;\n\n    this._listeners[type].forEach((handler) => handler.callback(event));\n  }\n\n  private _handleEscapeClick(event: KeyboardEvent): void {\n    const escKeyCode = 27;\n\n    if (event.key === 'Escape' || event.key === 'Esc' || event.keyCode === escKeyCode) {\n      this._dispatchEvent({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  }\n\n  // Event subscriptions aren't cleared so that host can receive a PAYMENT_SUCCESSFUL event\n  // even after the widget has been closed\n  private _teardownEventSubscriptions(): void {\n    window.removeEventListener('keydown', this._handleEscapeClick, true);\n    window.removeEventListener('message', this._subscribeToWidgetEvents);\n  }\n\n  private async _processPurchasePollingLoop({\n    apiUrl,\n    purchaseExternalId,\n    token,\n  }: IPurchasePollingCredentials): Promise<void> {\n    this._isPollingForSwapStatus = true;\n\n    while (\n      countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_SUCCESSFUL) > 0 ||\n      countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_FAILED) > 0\n    ) {\n      // tslint:disable-next-line:no-magic-numbers\n      await delay(1000);\n\n      const purchase = await doFetchPurchase(apiUrl, purchaseExternalId, token);\n\n      if (!purchase) {\n        continue;\n      }\n\n      if (purchase.actions.find((action) => action.newStatus === 'RELEASED')) {\n        this._dispatchEvent({\n          type: WidgetEventTypes.PURCHASE_SUCCESSFUL,\n          payload: {\n            purchase,\n          },\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n        return;\n      }\n\n      if (purchase.actions.find((action) => action.newStatus === 'ERROR')) {\n        this._dispatchEvent({\n          type: WidgetEventTypes.PURCHASE_FAILED,\n          payload: null,\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n        return;\n      }\n    }\n\n    this._isPollingForSwapStatus = false;\n  }\n\n  private _runPostSubscribeHooks(\n    eventType: TAllEventTypes | '*',\n    isHandlerInternal: boolean\n  ): void {\n    /*\n     *  Handles a case where a host subscribes to these events after\n     *  the `PURCHASE_CREATED` event is fired\n     */\n    if (\n      (eventType === '*' ||\n        eventType === WidgetEventTypes.PURCHASE_SUCCESSFUL ||\n        WidgetEventTypes.PURCHASE_FAILED) &&\n      this._purchasePollingCredentials &&\n      !this._isPollingForSwapStatus\n    ) {\n      // tslint:disable-next-line:no-floating-promises\n      this._processPurchasePollingLoop(this._purchasePollingCredentials);\n    }\n  }\n\n  private _showUsingEmbeddedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithoutOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this._config.containerNode?.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n  }\n\n  private _showUsingOverlayMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this.domNodes.body.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n\n    bodyScrollLock.disableBodyScroll(this.domNodes.iframe);\n\n    const widgetMode = determineWidgetVariant(this._config);\n\n    if (widgetMode !== 'desktop' && widgetMode !== 'embedded-desktop') {\n      hideWebsiteBelow(this.domNodes.shadow);\n    }\n  }\n\n  private _showUsingHostedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.widgetWindow = window.open(widgetUrl) ?? undefined;\n  }\n\n  private _isConfiguredWithOverlay(): boolean {\n    return ['desktop', 'mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsHosted(): boolean {\n    return ['hosted-desktop', 'hosted-mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsEmbedded(): boolean {\n    return ['embedded-desktop', 'embedded-mobile'].includes(this._rawNormalizedConfig.variant!);\n  }\n}\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.TransakSDK = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar objectCreate = Object.create || objectCreatePolyfill\nvar objectKeys = Object.keys || objectKeysPolyfill\nvar bind = Function.prototype.bind || functionBindPolyfill\n\nfunction EventEmitter() {\n  if (!this._events || !Object.prototype.hasOwnProperty.call(this, '_events')) {\n    this._events = objectCreate(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nvar hasDefineProperty;\ntry {\n  var o = {};\n  if (Object.defineProperty) Object.defineProperty(o, 'x', { value: 0 });\n  hasDefineProperty = o.x === 0;\n} catch (err) { hasDefineProperty = false }\nif (hasDefineProperty) {\n  Object.defineProperty(EventEmitter, 'defaultMaxListeners', {\n    enumerable: true,\n    get: function() {\n      return defaultMaxListeners;\n    },\n    set: function(arg) {\n      // check whether the input is a positive number (whose value is zero or\n      // greater and not a NaN).\n      if (typeof arg !== 'number' || arg < 0 || arg !== arg)\n        throw new TypeError('\"defaultMaxListeners\" must be a positive number');\n      defaultMaxListeners = arg;\n    }\n  });\n} else {\n  EventEmitter.defaultMaxListeners = defaultMaxListeners;\n}\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    if (arguments.length > 1)\n      er = arguments[1];\n    if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Unhandled \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n      // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n      // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = objectCreate(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n          listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n          prepend ? [listener, existing] : [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n            existing.length + ' \"' + String(type) + '\" listeners ' +\n            'added. Use emitter.setMaxListeners() to ' +\n            'increase limit.');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        if (typeof console === 'object' && console.warn) {\n          console.warn('%s: %s', w.name, w.message);\n        }\n      }\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    switch (arguments.length) {\n      case 0:\n        return this.listener.call(this.target);\n      case 1:\n        return this.listener.call(this.target, arguments[0]);\n      case 2:\n        return this.listener.call(this.target, arguments[0], arguments[1]);\n      case 3:\n        return this.listener.call(this.target, arguments[0], arguments[1],\n            arguments[2]);\n      default:\n        var args = new Array(arguments.length);\n        for (var i = 0; i < args.length; ++i)\n          args[i] = arguments[i];\n        this.listener.apply(this.target, args);\n    }\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = bind.call(onceWrapper, state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = objectCreate(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else\n          spliceOne(list, position);\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = objectCreate(null);\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = objectCreate(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = objectKeys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = objectCreate(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (!events)\n    return [];\n\n  var evlistener = events[type];\n  if (!evlistener)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction objectCreatePolyfill(proto) {\n  var F = function() {};\n  F.prototype = proto;\n  return new F;\n}\nfunction objectKeysPolyfill(obj) {\n  var keys = [];\n  for (var k in obj) if (Object.prototype.hasOwnProperty.call(obj, k)) {\n    keys.push(k);\n  }\n  return k;\n}\nfunction functionBindPolyfill(context) {\n  var fn = this;\n  return function () {\n    return fn.apply(context, arguments);\n  };\n}\n\n},{}],2:[function(require,module,exports){\n'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n\n},{}],3:[function(require,module,exports){\n'use strict';\nmodule.exports = function (obj, predicate) {\n\tvar ret = {};\n\tvar keys = Object.keys(obj);\n\tvar isArr = Array.isArray(predicate);\n\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tvar key = keys[i];\n\t\tvar val = obj[key];\n\n\t\tif (isArr ? predicate.indexOf(key) !== -1 : predicate(key, val, obj)) {\n\t\t\tret[key] = val;\n\t\t}\n\t}\n\n\treturn ret;\n};\n\n},{}],4:[function(require,module,exports){\n'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\nconst filterObject = require('filter-obj');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (value === null || value === undefined || value.length === 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n\t\t\t\tconst isEncodedArray = (typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator));\n\t\t\t\tvalue = isEncodedArray ? decode(value, options) : value;\n\t\t\t\tconst newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(query, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof query !== 'string') {\n\t\treturn ret;\n\t}\n\n\tquery = query.trim().replace(/^[?#&]/, '');\n\n\tif (!query) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of query.split('&')) {\n\t\tif (param === '') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : ['comma', 'separator'].includes(options.arrayFormat) ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (url, options) => {\n\toptions = Object.assign({\n\t\tdecode: true\n\t}, options);\n\n\tconst [url_, hash] = splitOnFirst(url, '#');\n\n\treturn Object.assign(\n\t\t{\n\t\t\turl: url_.split('?')[0] || '',\n\t\t\tquery: parse(extract(url), options)\n\t\t},\n\t\toptions && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}\n\t);\n};\n\nexports.stringifyUrl = (object, options) => {\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true\n\t}, options);\n\n\tconst url = removeHash(object.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(object.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl, {sort: false});\n\n\tconst query = Object.assign(parsedQueryFromUrl, object.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(object.url);\n\tif (object.fragmentIdentifier) {\n\t\thash = `#${encode(object.fragmentIdentifier, options)}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n\nexports.pick = (input, filter, options) => {\n\toptions = Object.assign({\n\t\tparseFragmentIdentifier: true\n\t}, options);\n\n\tconst {url, query, fragmentIdentifier} = exports.parseUrl(input, options);\n\treturn exports.stringifyUrl({\n\t\turl,\n\t\tquery: filterObject(query, filter),\n\t\tfragmentIdentifier\n\t}, options);\n};\n\nexports.exclude = (input, filter, options) => {\n\tconst exclusionFilter = Array.isArray(filter) ? key => !filter.includes(key) : (key, value) => !filter(key, value);\n\n\treturn exports.pick(input, exclusionFilter, options);\n};\n\n},{\"decode-uri-component\":2,\"filter-obj\":3,\"split-on-first\":5,\"strict-uri-encode\":6}],5:[function(require,module,exports){\n'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n\n},{}],6:[function(require,module,exports){\n'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n\n},{}],7:[function(require,module,exports){\nmodule.exports={\n  \"name\": \"@transak/transak-sdk\",\n  \"version\": \"1.0.29\",\n  \"description\": \"Transak SDK that allows you to easily integrate the fiat on/ramp\",\n  \"main\": \"dist/sdk.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\",\n    \"build\": \"browserify ./src/index.js -o ./dist/sdk.js -p esmify -s TransakSDK\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/Transak/transak-sdk.git\"\n  },\n  \"keywords\": [\n    \"fiat\",\n    \"ramp\",\n    \"on\",\n    \"off\",\n    \"cryptocurrency\"\n  ],\n  \"author\": \"Transak\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"events\": \"^3.1.0\",\n    \"query-string\": \"^6.12.1\",\n    \"request\": \"^2.88.2\"\n  },\n  \"devDependencies\": {\n    \"browserify\": \"^16.5.0\",\n    \"esmify\": \"^2.1.1\"\n  },\n  \"browserslist\": {\n    \"production\": [\n      \">0.2%\",\n      \"not dead\",\n      \"not op_mini all\"\n    ],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  }\n}\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCSS = getCSS;\n\nfunction getCSS(themeColor, height, width) {\n  return `\n/* Modal Content/Box */\n.transak_close {\n    float: right;\n      animation: 5s transak_fadeIn;\n      animation-fill-mode: forwards;\n      visibility: hidden;\n    transition: 0.5s;\n    position: absolute;\n    right: -5px;\n    width: 35px;\n    margin-top: -15px;\n    height: 35px;\n    font-weight: bold;\n    z-index: 1;\n    background: white;\n    color: #${themeColor};\n    border-radius: 50%;\n}\n\n@keyframes transak_fadeIn {\n  0% {\n    opacity: 0;\n  }\n  50% {\n   visibility: hidden;\n    opacity: 0;\n  }\n  100% {\n    visibility: visible;\n    opacity: 1;\n  }\n}\n\n.transak_close:hover,\n.transak_close:focus {\n  color: white;\n  background: #${themeColor};\n  text-decoration: none;\n  cursor: pointer;\n}\n\n.transak_modal {\n  display: block;\n  width: ${width};\n  max-width: 500px;\n  height: ${height};\n  max-height: 100%;\n  position: fixed;\n  z-index: 100;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  background: white;\n      border: none;\n    border-radius: 2%;\n    margin: 0px auto;\n    display: block;\n}\n.transak_closed {\n  display: none;\n}\n\n#transakOnOffRampWidget{\n min-height: ${height}; \n    position: absolute; \n    border: none; \n    border-radius: 2%; \n    margin: 0px auto; \n    display: block;\n}\n\n.transak_modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 50;\n  \n  background: rgba(0, 0, 0, 0.6);\n}\n\n.transak_modal-content{\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n}\n\n.transak_modal .close-button {\n  position: absolute;\n  z-index: 1;\n  top: 10px;\n  right: 20px;\n  background: black;\n  color: white;\n  padding: 5px 10px;\n  font-size: 1.3rem;\n}\n\n.transak_transakContainer{\n    height: 100%;\n    width:100%;\n}\n\n#transakFiatOnOffRamp{\n    margin-left: 10px;\n    margin-right: 10px;\n}\n\n\n@media all and (max-width: ${width}) {\n  .transak_modal {\n    height: 100%;\n    max-height:${height};\n    top: 53%;\n  }\n}\n\n@media all and (max-height: ${height}) and (max-width: ${width}) {\n    #transakOnOffRampWidget{\n    padding-bottom: 15px;\n    }\n}\n`;\n}\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.closeSVGIcon = void 0;\nlet closeSVGIcon = `<svg version=\"1.1\" fill=\"currentColor\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n\\t viewBox=\"0 0 612 612\" style=\"enable-background:new 0 0 612 612;\" xml:space=\"preserve\">\n<g>\n\\t<g id=\"_x31_0_23_\">\n\\t\\t<g>\n\\t\\t\\t<path d=\"M306,0C136.992,0,0,136.992,0,306s136.992,306,306,306c168.988,0,306-137.012,306-306S475.008,0,306,0z M414.19,387.147\n\\t\\t\\t\\tc7.478,7.478,7.478,19.584,0,27.043c-7.479,7.478-19.584,7.478-27.043,0l-81.032-81.033l-81.588,81.588\n\\t\\t\\t\\tc-7.535,7.516-19.737,7.516-27.253,0c-7.535-7.535-7.535-19.737,0-27.254l81.587-81.587l-81.033-81.033\n\\t\\t\\t\\tc-7.478-7.478-7.478-19.584,0-27.042c7.478-7.478,19.584-7.478,27.042,0l81.033,81.033l82.181-82.18\n\\t\\t\\t\\tc7.535-7.535,19.736-7.535,27.253,0c7.535,7.535,7.535,19.737,0,27.253l-82.181,82.181L414.19,387.147z\"/>\n\\t\\t</g>\n\\t</g>\n</g>\n</svg>`;\nexports.closeSVGIcon = closeSVGIcon;\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = {\n  SOMETHING_WRONG: `[Transak SDK] => Oops something went wrong please try again. Contact us at hello@transak.com`,\n  ENTER_API_KEY: `[Transak SDK] => Please enter your API Key`,\n  NOT_INITIALIZED_PROPERLY: `[Transak SDK] => Transak SDK is not initialized properly`\n};\nexports.default = _default;\n\n},{}],11:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = {\n  TRANSAK_WIDGET_INITIALISED: 'TRANSAK_WIDGET_INITIALISED',\n  TRANSAK_WIDGET_OPEN: 'TRANSAK_WIDGET_OPEN',\n  TRANSAK_WIDGET_CLOSE_REQUEST: 'TRANSAK_WIDGET_CLOSE_REQUEST',\n  TRANSAK_WIDGET_CLOSE: 'TRANSAK_WIDGET_CLOSE',\n  TRANSAK_ORDER_CREATED: 'TRANSAK_ORDER_CREATED',\n  TRANSAK_ORDER_CANCELLED: 'TRANSAK_ORDER_CANCELLED',\n  TRANSAK_ORDER_FAILED: 'TRANSAK_ORDER_FAILED',\n  TRANSAK_ORDER_SUCCESSFUL: 'TRANSAK_ORDER_SUCCESSFUL'\n};\nexports.default = _default;\n\n},{}],12:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = {\n  ENVIRONMENT: {\n    STAGING: {\n      FRONTEND: 'https://staging-global.transak.com',\n      BACKEND: 'https://staging-api.transak.com/api/v1',\n      NAME: 'STAGING'\n    },\n    LOCAL_DEVELOPMENT: {\n      FRONTEND: 'http://localhost:3000',\n      BACKEND: 'http://localhost:8292/api/v2',\n      NAME: 'LOCAL_DEVELOPMENT'\n    },\n    DEVELOPMENT: {\n      FRONTEND: 'https://development-global.transak.com',\n      BACKEND: 'https://development-api.transak.com/api/v2',\n      NAME: 'DEVELOPMENT'\n    },\n    PRODUCTION: {\n      FRONTEND: 'https://global.transak.com',\n      BACKEND: 'https://api.transak.com/api/v2',\n      NAME: 'PRODUCTION'\n    }\n  },\n  STATUS: {\n    INIT: 'init',\n    TRANSAK_INITIALISED: 'transak_initialised'\n  }\n};\nexports.default = _default;\n\n},{}],13:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"EVENTS\", {\n  enumerable: true,\n  get: function () {\n    return _events.default;\n  }\n});\nObject.defineProperty(exports, \"config\", {\n  enumerable: true,\n  get: function () {\n    return _globalConfig.default;\n  }\n});\nObject.defineProperty(exports, \"errorsLang\", {\n  enumerable: true,\n  get: function () {\n    return _errors.default;\n  }\n});\n\nvar _globalConfig = _interopRequireDefault(require(\"./globalConfig\"));\n\nvar _errors = _interopRequireDefault(require(\"./errors\"));\n\nvar _events = _interopRequireDefault(require(\"./events\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n},{\"./errors\":10,\"./events\":11,\"./globalConfig\":12}],14:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _events = _interopRequireDefault(require(\"events\"));\n\nvar _constants = require(\"./constants\");\n\nvar _generalUtil = require(\"./utils/generalUtil\");\n\nvar _svg = require(\"./assets/svg\");\n\nvar _css = require(\"./assets/css\");\n\nvar _queryString = _interopRequireDefault(require(\"query-string\"));\n\nvar _package = require(\"../package.json\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst eventEmitter = new _events.default.EventEmitter();\n\nfunction TransakSDK(partnerData) {\n  this.sdkVersion = _package.version;\n  this.partnerData = partnerData;\n  this.isInitialised = false;\n  this.EVENTS = _constants.EVENTS;\n  this.ALL_EVENTS = '*';\n  this.ERROR = 'TRANSAK_ERROR';\n}\n\nTransakSDK.prototype.on = function (type, cb) {\n  if (type === this.ALL_EVENTS) {\n    for (let eventName in _constants.EVENTS) {\n      eventEmitter.on(_constants.EVENTS[eventName], cb);\n    }\n  }\n\n  if (_constants.EVENTS[type]) eventEmitter.on(type, cb);\n  if (type === this.ERROR) eventEmitter.on(this.ERROR, cb);\n};\n\nTransakSDK.prototype.init = function () {\n  this.modal(this);\n};\n\nTransakSDK.prototype.close = async function () {\n  let modal = document.getElementById(\"transakFiatOnOffRamp\");\n\n  if (modal && modal.style) {\n    modal.style.display = \"none\";\n    modal.innerHTML = \"\";\n    await modal.remove();\n  }\n};\n\nTransakSDK.prototype.closeRequest = function () {\n  let iframeEl = document.getElementById('transakOnOffRampWidget');\n  if (iframeEl) iframeEl.contentWindow.postMessage({\n    event_id: _constants.EVENTS.TRANSAK_WIDGET_CLOSE_REQUEST,\n    data: true\n  }, '*');\n};\n\nTransakSDK.prototype.modal = async function () {\n  try {\n    if (this.partnerData) {\n      let {\n        url,\n        width,\n        height,\n        partnerData\n      } = await generateURL({ ...this.partnerData,\n        sdkVersion: this.sdkVersion\n      });\n      let wrapper = document.createElement('div');\n      wrapper.id = \"transakFiatOnOffRamp\";\n      wrapper.innerHTML = `<div class=\"transak_modal-overlay\" id=\"transak_modal-overlay\"></div><div class=\"transak_modal\" id=\"transak_modal\"><div class=\"transak_modal-content\"><span class=\"transak_close\">${_svg.closeSVGIcon}</span><div class=\"transakContainer\"><iframe id=\"transakOnOffRampWidget\" allow=\"camera;fullscreen;accelerometer;gyroscope;magnetometer\" allowFullScreen src=\"${url}\" style=\"width: ${width}; height: ${height}\"></iframe></div></div></div>`;\n      let container = document.getElementsByTagName(\"body\");\n      if (!container) container = document.getElementsByTagName(\"html\");\n      if (!container) container = document.getElementsByTagName(\"div\");\n      await container[0].appendChild(wrapper);\n      await setStyle(this.partnerData.themeColor, width, height);\n      let modal = document.getElementById(\"transakFiatOnOffRamp\");\n      let span = document.getElementsByClassName(\"transak_close\")[0]; //Prevent background scrolling when overlay appears\n\n      document.documentElement.style.overflow = 'hidden';\n      document.body.scroll = \"no\";\n      if (modal && modal.style) modal.style.display = \"block\";\n      this.isInitialised = true;\n      eventEmitter.emit(_constants.EVENTS.TRANSAK_WIDGET_INITIALISED, {\n        status: true,\n        eventName: _constants.EVENTS.TRANSAK_WIDGET_INITIALISED\n      }); // When the user clicks on <span> (x), close the modal\n\n      span.onclick = () => {\n        return this.closeRequest();\n      }; // When the user clicks anywhere outside of the modal, close it\n\n\n      window.onclick = event => {\n        if (event.target === document.getElementById(\"transak_modal-overlay\")) this.closeRequest();\n      };\n\n      if (window.addEventListener) window.addEventListener(\"message\", handleMessage);else window.attachEvent(\"onmessage\", handleMessage);\n    }\n  } catch (e) {\n    throw e;\n  }\n};\n\nasync function generateURL(configData) {\n  let partnerData = {},\n      environment = 'development',\n      queryString = \"\",\n      width = \"100%\",\n      height = \"100%\";\n\n  if (configData) {\n    if (configData.apiKey) {\n      if (configData.environment) {\n        if (_constants.config.ENVIRONMENT[configData.environment]) environment = _constants.config.ENVIRONMENT[configData.environment].NAME;\n      }\n\n      try {\n        environment = environment.toUpperCase(); // let partnerDataBackend = await fetchAPIKey(configData.apiKey, config.ENVIRONMENT[environment].BACKEND);\n        // if (partnerDataBackend) {\n\n        partnerData.apiKey = configData.apiKey;\n        if (configData.sdkVersion) partnerData.sdkVersion = configData.sdkVersion;\n        if (configData.cryptoCurrencyCode) partnerData.cryptoCurrencyCode = configData.cryptoCurrencyCode;\n        if (configData.defaultCryptoCurrency) partnerData.defaultCryptoCurrency = configData.defaultCryptoCurrency;\n        if (configData.walletAddress) partnerData.walletAddress = configData.walletAddress;\n        if (configData.themeColor) partnerData.themeColor = configData.themeColor.replace(\"#\", \"\");\n        if (configData.walletAddress) partnerData.walletAddress = configData.walletAddress;\n        if (configData.fiatAmount) partnerData.fiatAmount = configData.fiatAmount;\n        if (configData.defaultFiatAmount) partnerData.defaultFiatAmount = configData.defaultFiatAmount;\n        if (configData.defaultCryptoAmount) partnerData.defaultCryptoAmount = configData.defaultCryptoAmount;\n\n        if (configData.walletAddressesData && (configData.walletAddressesData.networks || configData.walletAddressesData.coins)) {\n          partnerData.walletAddressesData = {};\n          if (configData.walletAddressesData.networks) partnerData.walletAddressesData.networks = configData.walletAddressesData.networks;\n          if (configData.walletAddressesData.coins) partnerData.walletAddressesData.coins = configData.walletAddressesData.coins;\n          partnerData.walletAddressesData = JSON.stringify(partnerData.walletAddressesData);\n        }\n\n        if (configData.fiatCurrency) partnerData.fiatCurrency = configData.fiatCurrency;\n        if (configData.countryCode) partnerData.countryCode = configData.countryCode;\n        if (configData.paymentMethod) partnerData.paymentMethod = configData.paymentMethod;\n        if (configData.defaultPaymentMethod) partnerData.defaultPaymentMethod = configData.defaultPaymentMethod;\n        if (configData.isAutoFillUserData) partnerData.isAutoFillUserData = configData.isAutoFillUserData;\n        if (configData.isFeeCalculationHidden) partnerData.isFeeCalculationHidden = configData.isFeeCalculationHidden;\n        if (configData.disablePaymentMethods) partnerData.disablePaymentMethods = configData.disablePaymentMethods;\n        if (configData.email) partnerData.email = configData.email;\n        if (configData.userData) partnerData.userData = JSON.stringify(configData.userData);\n        if (configData.partnerOrderId) partnerData.partnerOrderId = configData.partnerOrderId;\n        if (configData.partnerCustomerId) partnerData.partnerCustomerId = configData.partnerCustomerId;\n        if (configData.exchangeScreenTitle) partnerData.exchangeScreenTitle = configData.exchangeScreenTitle;\n        if (configData.hideMenu) partnerData.hideMenu = configData.hideMenu;\n        if (configData.accessToken) partnerData.accessToken = configData.accessToken;\n        if (configData.hideExchangeScreen) partnerData.hideExchangeScreen = configData.hideExchangeScreen;\n        if (configData.isDisableCrypto) partnerData.isDisableCrypto = configData.isDisableCrypto;\n        if (configData.redirectURL) partnerData.redirectURL = configData.redirectURL;\n        if (configData.hostURL) partnerData.hostURL = configData.hostURL ? configData.hostURL : window.location.origin;\n        if (configData.disableWalletAddressForm) partnerData.disableWalletAddressForm = configData.disableWalletAddressForm;\n        if (configData.cryptoCurrencyList) partnerData.cryptoCurrencyList = configData.cryptoCurrencyList.split(',');\n        if (configData.networks) partnerData.networks = configData.networks.split(',');\n        if (configData.defaultNetwork) partnerData.defaultNetwork = configData.defaultNetwork;\n        if (configData.network) partnerData.network = configData.network;\n        queryString = _queryString.default.stringify(partnerData, {\n          arrayFormat: 'comma'\n        });\n      } catch (e) {\n        throw e;\n      }\n    } else throw _constants.errorsLang.ENTER_API_KEY;\n\n    if (configData.widgetWidth) width = configData.widgetWidth;\n    if (configData.widgetHeight) height = configData.widgetHeight;\n  }\n\n  return {\n    width,\n    height,\n    partnerData,\n    url: `${_constants.config.ENVIRONMENT[environment].FRONTEND}?${queryString}`\n  };\n}\n\nasync function setStyle(themeColor, width, height) {\n  let style = await document.createElement('style');\n  style.innerHTML = (0, _css.getCSS)(themeColor, height, width);\n  let modal = document.getElementById(\"transakFiatOnOffRamp\");\n  if (modal) await modal.appendChild(style);\n}\n\nfunction handleMessage(event) {\n  let environment;\n  if (event.origin === _constants.config.ENVIRONMENT.LOCAL_DEVELOPMENT.FRONTEND) environment = _constants.config.ENVIRONMENT.LOCAL_DEVELOPMENT.NAME;else if (event.origin === _constants.config.ENVIRONMENT.PRODUCTION.FRONTEND) environment = _constants.config.ENVIRONMENT.PRODUCTION.NAME;else if (event.origin === _constants.config.ENVIRONMENT.STAGING.FRONTEND) environment = _constants.config.ENVIRONMENT.STAGING.NAME;else if (event.origin === _constants.config.ENVIRONMENT.DEVELOPMENT.FRONTEND) environment = _constants.config.ENVIRONMENT.DEVELOPMENT.NAME;\n\n  if (environment) {\n    if (event && event.data && event.data.event_id) {\n      switch (event.data.event_id) {\n        case _constants.EVENTS.TRANSAK_WIDGET_CLOSE:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_WIDGET_CLOSE, {\n              status: true,\n              eventName: _constants.EVENTS.TRANSAK_WIDGET_CLOSE\n            }); //enable background scrolling when overlay appears\n\n            document.documentElement.style.overflow = 'scroll';\n            document.body.scroll = \"yes\";\n            let modal = document.getElementById(\"transakFiatOnOffRamp\");\n\n            if (modal && modal.style) {\n              modal.style.display = \"none\";\n              modal.innerHTML = \"\";\n              modal.remove();\n            }\n\n            break;\n          }\n\n        case _constants.EVENTS.TRANSAK_ORDER_CREATED:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_ORDER_CREATED, {\n              status: event.data.data,\n              eventName: _constants.EVENTS.TRANSAK_ORDER_CREATED\n            });\n            break;\n          }\n\n        case _constants.EVENTS.TRANSAK_ORDER_CANCELLED:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_ORDER_CANCELLED, {\n              status: event.data.data,\n              eventName: _constants.EVENTS.TRANSAK_ORDER_CANCELLED\n            });\n            break;\n          }\n\n        case _constants.EVENTS.TRANSAK_ORDER_FAILED:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_ORDER_FAILED, {\n              status: event.data.data,\n              eventName: _constants.EVENTS.TRANSAK_ORDER_FAILED\n            });\n            break;\n          }\n\n        case _constants.EVENTS.TRANSAK_ORDER_SUCCESSFUL:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_ORDER_SUCCESSFUL, {\n              status: event.data.data,\n              eventName: _constants.EVENTS.TRANSAK_ORDER_SUCCESSFUL\n            });\n            break;\n          }\n\n        case _constants.EVENTS.TRANSAK_WIDGET_OPEN:\n          {\n            eventEmitter.emit(_constants.EVENTS.TRANSAK_WIDGET_OPEN, {\n              status: true,\n              eventName: _constants.EVENTS.TRANSAK_WIDGET_OPEN\n            });\n            break;\n          }\n\n        default:\n          {}\n      }\n    }\n  }\n}\n\nvar _default = TransakSDK;\nexports.default = _default;\n\n},{\"../package.json\":7,\"./assets/css\":8,\"./assets/svg\":9,\"./constants\":13,\"./utils/generalUtil\":15,\"events\":1,\"query-string\":4}],15:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UrlEncode = UrlEncode;\nexports.default = void 0;\n\nfunction UrlEncode(data, encodeornot) {\n  if (typeof data == 'object') {\n    let out = [];\n\n    for (let key in data) {\n      out.push(key + '=' + (encodeornot ? encodeURIComponent(data[key]) : data[key]));\n    }\n\n    let finalStr = out.join('&');\n    return finalStr;\n  } else {\n    console.warn('error occur');\n  }\n}\n\n;\nvar _default = {\n  UrlEncode\n};\nexports.default = _default;\n\n},{}]},{},[14])(14)\n});\n"],"sourceRoot":""}