(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[21],{1555:function(e,s,t){},1556:function(e,s,t){},1645:function(e,s,t){"use strict";t.r(s);var n=t(2),a=t.n(n),r=t(11),c=t(7),o=(t(1555),t(152)),d=t(228),i=t(37),u=t(30),l=t(3),b=t(55),m=t(21),f=t(44),j=t(77),v=t(683),O=t(233),h=t(91),g=(t(1556),t(311)),p=t(664),x=t(34),k=t(4),w=function(e){var s=e.addresses,t=e.addAddress,n=e.removeAddress,a=e.onSelectAddress,r=e.selectedNetwork,o=Object(x.f)().showModal,d=[{inputType:"name",label:"Name",placeholder:"Address title"},{inputType:"address",label:"Address / Unstoppable domains\u24c7 / ENS\u24c7",placeholder:"Address / Unstoppable Domains / ENS",validate:function(e){return Object(h.b)(e)}}],u=Object(k.jsx)(p.a,{title:"Add New Address",selectedNetwork:r,inputs:d,onClose:function(e){var s=Object(c.a)(e,3),n=s[0],a=s[1],r=s[2];return t(n,a,r)}});return Object(k.jsxs)("div",{id:"addresses",className:"panel",children:[Object(k.jsx)("div",{className:"title",children:"Address Book"}),Object(k.jsx)("div",{className:"content",children:Object(k.jsx)(g.a,{noAccounts:!0,addresses:s,removeAddress:n,onSelectAddress:a})}),Object(k.jsx)("div",{className:"separator"}),Object(k.jsx)(j.e,{icon:Object(k.jsx)(i.C,{}),onClick:function(){return o(u)},children:"Add Address"})]})},y=t(60),A=t(596),T=t(604),S=t(151),C=t(234),N=t(813),L=new m.Interface(t(607)),U=["Binance","Huobi","KuCoin","Gate.io","FTX"];s.default=Object(u.withRouter)((function(e){var s,t=e.history,n=e.portfolio,m=e.selectedAcc,g=e.selectedNetwork,p=e.addRequest,I=e.addressBook,F=e.relayerURL,D=I.addresses,R=I.addAddress,B=I.removeAddress,E=I.isKnownAddress,M=Object(N.a)({relayerURL:F,selectedAcc:m,network:g,portfolio:n,useRelayerData:x.j}).feeAssetsRes,_=M&&M.length&&M.filter((function(e){return e.network===g.id&&!e.disableGasTankDeposit})),G=Object(u.useParams)().tokenAddressOrSymbol,P=Object(f.a)().addToast,Y=Object(u.useLocation)().state,z=Object(l.useState)(Y||null),K=Object(c.a)(z,1)[0],V=Object(h.b)(G)?G:(null===(s=n.tokens.find((function(e){return e.symbol===G})))||void 0===s?void 0:s.address)||null,W=Object(l.useState)(V),H=Object(c.a)(W,2),J=H[0],X=H[1],q=Object(l.useState)(0),$=Object(c.a)(q,2),Q=$[0],Z=$[1],ee=Object(l.useState)(""),se=Object(c.a)(ee,2),te=se[0],ne=se[1],ae=Object(l.useState)(K?S.a.feeCollector:""),re=Object(c.a)(ae,2),ce=re[0],oe=re[1],de=Object(l.useState)(""),ie=Object(c.a)(de,2),ue=ie[0],le=ie[1],be=Object(l.useState)(""),me=Object(c.a)(be,2),fe=me[0],je=me[1],ve=Object(l.useState)(!0),Oe=Object(c.a)(ve,2),he=Oe[0],ge=Oe[1],pe=Object(l.useState)(!1),xe=Object(c.a)(pe,2),ke=xe[0],we=xe[1],ye=Object(l.useState)(!1),Ae=Object(c.a)(ye,2),Te=Ae[0],Se=Ae[1],Ce=Object(l.useState)(""),Ne=Object(c.a)(Ce,2),Le=Ne[0],Ue=Ne[1],Ie=Object(l.useState)({success:{amount:!1,address:!1},messages:{amount:"",address:""}}),Fe=Object(c.a)(Ie,2),De=Fe[0],Re=Fe[1],Be=Object(l.useState)(""),Ee=Object(c.a)(Be,2),Me=Ee[0],_e=Ee[1],Ge=Object(l.useRef)(null),Pe=((null===K||void 0===K?void 0:K.isTopUp)?n.tokens.filter((function(e){return _&&(null===_||void 0===_?void 0:_.some((function(s){return s.address.toLowerCase()===e.address.toLowerCase()})))})):n.tokens).map((function(e){var s=e.label,t=e.symbol,n=e.address,a=e.img,r=e.tokenImageUrl,c=e.network;return{label:s||t,value:n,icon:a||r,fallbackIcon:Object(A.a)(c,n)}})),Ye=n.tokens.find((function(e){return e.address===J})),ze=Object(l.useMemo)((function(){if(!Ye)return{maxAmount:"0",maxAmountFormatted:"0.00"};var e=Ye.balanceRaw,s=Ye.decimals,t=Ye.balance;return{maxAmount:b.ethers.utils.formatUnits(e,s),maxAmountFormatted:Object(T.a)(t,!0,s)}}),[Ye]),Ke=ze.maxAmount,Ve=ze.maxAmountFormatted,We=Object(l.useMemo)((function(){return!K&&0===Number(V)&&y.a.map((function(e){return e.id})).filter((function(e){return"ethereum"!==e})).includes(g.id)}),[K,V,g.id]),He=function(e){if(e){var s=Ye.decimals,t=b.ethers.utils.parseUnits(e,s).toHexString();ne(t)}Z(e)};Object(l.useEffect)((function(){if(_e(""),null===K||void 0===K?void 0:K.isTopUp){var e=_&&_.find((function(e){var s,t;return(null===e||void 0===e||null===(s=e.address)||void 0===s?void 0:s.toLowerCase())===(null===Ye||void 0===Ye||null===(t=Ye.address)||void 0===t?void 0:t.toLowerCase())}));if(null===e||void 0===e?void 0:e.baseToken){var s=_&&_.find((function(s){return s.address.toLowerCase()===e.baseToken.toLowerCase()}));_e("Token ".concat(e.symbol.toUpperCase()," will be converted to ").concat(s.symbol.toUpperCase()," without additional fees."))}}}),[_,null===K||void 0===K?void 0:K.isTopUp,Ye]),Object(l.useEffect)((function(){Z(0),ne(""),Se(!1)}),[J,g.id]),Object(l.useEffect)((function(){Ye&&t.replace({pathname:"/wallet/transfer/".concat(0!==Number(J)?J:Ye.symbol)})}),[J,t,Ye]),Object(l.useEffect)((function(){var e=Object(v.d)(Q,Ye);if(ce.startsWith("0x")&&-1===ce.indexOf(".")){""!==ue&&le(""),""!==fe&&je("");var s=Object(v.c)(ce,m,ke,E);Re({success:{amount:e.success,address:s.success},messages:{amount:e.message?e.message:"",address:s.message?s.message:""}}),ge(!s.success||!e.success||We&&!Te)}else{Ge.current&&clearTimeout(Ge.current);var t=function(){var s=Object(r.a)(a.a.mark((function s(){var t,n,r,c,o,d,i;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(O.a)(ce,Ye?Ye.symbol:null,g.unstoppableDomainsChain);case 2:return t=s.sent,n=Object(C.a)(Ye?Ye.symbol:null),s.next=6,Object(C.b)(ce,n);case 6:r=s.sent,Ge.current=null,c=!!t,d="",d=(o=!!r)?r:c?t:ce,i=Object(v.c)(d,m,ke,E,c,o),le(t),je(r),Re({success:{amount:e.success,address:i.success},messages:{amount:e.message?e.message:"",address:i.message?i.message:""}}),ge(!i.success||!e.success||We&&!Te);case 17:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();Ge.current=setTimeout(Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t().catch(console.error));case 1:case"end":return e.stop()}}),e)}))),300)}return function(){return clearTimeout(Ge.current)}}),[ce,Q,m,Ye,ke,We,Te,E,P,g,R,ue,he,fe]);var Je=Object(k.jsxs)("div",{className:"amount-label",children:["Available Amount: ",Object(k.jsxs)("span",{children:[Ve," ",null===Ye||void 0===Ye?void 0:Ye.symbol]})]});return Object(k.jsxs)("div",{id:"transfer",style:{justifyContent:K?"center":""},children:[Object(k.jsxs)("div",{className:"panel",children:[Object(k.jsx)("div",{className:"title",children:"Send"}),n.isCurrNetworkBalanceLoading?Object(k.jsx)(j.m,{}):Pe.length?Object(k.jsxs)("div",{className:"form",children:[Object(k.jsx)(j.t,{searchable:!0,defaultValue:J,items:Pe.sort((function(e,s){return e.label.toLowerCase()>s.label.toLowerCase()?1:-1})),onChange:function(e){var s=e.value;return X(s)}}),Me?Object(k.jsxs)("p",{className:"gas-tank-convert-msg",children:[Object(k.jsx)(i.db,{})," ",Me]}):Object(k.jsx)(k.Fragment,{}),Object(k.jsx)(j.p,{label:Je,value:Q,precision:null===Ye||void 0===Ye?void 0:Ye.decimals,onInput:He,button:"MAX",onButtonClick:function(){return He(Ke)}}),De.messages.amount&&Object(k.jsxs)("div",{className:"validation-error",children:[Object(k.jsx)(o.t,{size:12}),"\xa0",De.messages.amount]}),K?Object(k.jsxs)("p",{className:"gas-tank-msg",children:[Object(k.jsx)(i.db,{})," ",null===K||void 0===K?void 0:K.gasTankMsg]}):Object(k.jsxs)("div",{id:"recipient-field",children:[Object(k.jsx)(j.w,{placeholder:"Recipient",info:"Please double-check the recipient address, blockchain transactions are not reversible.",value:ce,onInput:oe}),Object(k.jsx)(j.y,{label:fe?"Valid Ethereum Name Services\u24c7 domain":"You can use Ethereum Name Service\u24c7",children:Object(k.jsx)("div",{id:"ens-logo",className:fe?"ens-logo-active ":""})}),Object(k.jsx)(j.y,{label:ue?"Valid Unstoppable domains\u24c7 domain":"You can use Unstoppable domains\u24c7",children:Object(k.jsx)("div",{id:"udomains-logo",className:ue?"ud-logo-active ":""})}),Object(k.jsx)(j.a,{addresses:D.filter((function(e){return e.address!==m})),addAddress:R,removeAddress:B,newAddress:Le,onClose:function(){return Ue(null)},onSelectAddress:function(e){return oe(e)},selectedNetwork:g})]}),De.messages.address&&Object(k.jsxs)("div",{className:"validation-error",children:[Object(k.jsx)(o.t,{size:12}),"\xa0",De.messages.address]}),Object(k.jsx)("div",{className:"separator"}),Object(k.jsx)(j.b,{address:ce,onAddNewAddress:function(){return Ue(ce)},onChange:function(e){return we(e)},isKnownAddress:E,uDAddress:ue,ensAddress:fe}),We?Object(k.jsx)(j.g,{id:"binance-address-warning",label:Object(k.jsxs)("span",{id:"binance-address-warning-label",children:["I confirm this address is not a ",U.join(" / ")," address: ",Object(k.jsx)("br",{}),"These platforms do not support $",null===Ye||void 0===Ye?void 0:Ye.symbol," deposits from smart wallets",Object(k.jsx)("a",{href:"https://help.ambire.com/hc/en-us/articles/4415473743506-Statement-on-MATIC-BNB-deposits-to-Binance",target:"_blank",rel:"noreferrer",children:Object(k.jsx)(i.u,{size:20})})]}),checked:Te,onChange:function(e){var s=e.target;return Se(s.checked)}}):null,Object(k.jsx)(j.e,{icon:Object(k.jsx)(d.i,{}),disabled:he,onClick:function(){var e=ue||(fe||ce);if(te)try{var s={to:Ye.address,value:"0",data:L.encodeFunctionData("transfer",[e,te])};0===Number(Ye.address)&&(s.to=e,s.value=te,s.data="0x");var t={id:"transfer_".concat(Date.now()),type:"eth_sendTransaction",chainId:g.chainId,account:m,txn:s,meta:null};ue?t.meta={addressLabel:{addressLabel:ce,address:ue}}:fe&&(t.meta={addressLabel:{addressLabel:ce,address:fe}}),p(t),Z(0)}catch(n){console.error(n),P("Error: ".concat(n.message||n),{error:!0})}},children:"Send"})]}):Object(k.jsx)(j.o,{})]}),!K&&Object(k.jsx)(w,{selectedAsset:Ye,selectedNetwork:g,addresses:D,addAddress:R,removeAddress:B,onSelectAddress:function(e){return oe(e)}})]})}))},636:function(e,s,t){"use strict";t.d(s,"a",(function(){return a}));var n=t(108);function a(e,s){if(null==e)return{};var t,a,r=Object(n.a)(e,s);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)t=c[a],s.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}},683:function(e,s,t){"use strict";t.d(s,"a",(function(){return o})),t.d(s,"b",(function(){return u})),t.d(s,"c",(function(){return d})),t.d(s,"d",(function(){return i}));var n=t(21),a=t(91),r=t(151),c=function(e){return e&&e.length?e&&Object(a.b)(e)?{success:!0}:{success:!1,message:"Invalid address."}:{success:!1,message:""}},o=function(e,s){var t=c(e);return t.success?e&&s&&e===s?{success:!1,message:"The entered address should be different than the your own account address."}:{success:!0}:t},d=function(e,s,t,n,o,d){var i=c(e);return i.success?e&&e===r.a.feeCollector?{success:!0}:e&&s&&e===s?{success:!1,message:"The entered address should be different than the your own account address."}:e&&Object(a.a)(e)?{success:!1,message:"You are trying to send tokens to a smart contract. Doing so would burn them."}:!e||n(e)||t||o||d?!e||n(e)||t||!o&&!d?{success:!0}:{success:!1,message:"You're trying to send to an ".concat(o?"Unstoppable domain":"Ethereum Name Service",". If you really trust to the person who gave you, confirm using the checkbox below.")}:{success:!1,message:"You're trying to send to an unknown address. If you're really sure, confirm using the checkbox below."}:i},i=function(e,s){if(!e||!e.length)return{success:!1,message:""};if(!(e&&e>0))return{success:!1,message:"The amount must be greater than 0."};try{if(e&&s&&s.decimals){var t=e.slice(0,e.indexOf(".")+s.decimals+1),a=Object(n.parseUnits)(t,s.decimals);if(a&&s.balanceRaw&&a.gt(s.balanceRaw))return{success:!1,message:"The amount is greater than the asset's balance: ".concat(null===s||void 0===s?void 0:s.balance," ").concat(null===s||void 0===s?void 0:s.symbol,".")}}}catch(r){console.error(r)}return{success:!0}},u=function(e,s,t,n,a,r,c,o,i){var u,l=d(e,s,t,n,o,i);return l.success?a&&s&&(null===(u=a.owner)||void 0===u?void 0:u.address.toLowerCase())!==s.toLowerCase()?{success:!1,message:"The NFT you're trying to send is not owned by you!"}:r&&c&&r.id!==c?{success:!1,message:"The selected network is not the correct one."}:{success:!0}:l}},813:function(e,s,t){"use strict";var n=t(8),a=t(21),r=t(3);function c(e){return(null===e||void 0===e?void 0:e.address)&&"0x0000000000000000000000000000000000000000"!==(null===e||void 0===e?void 0:e.address)?3e4:12e3}var o=t(636),d=t(607),i=t(26),u=t(151),l=["txId","txns","submittedAt","gasTankFee","identity"],b=new a.Interface(d),m=b.getSighash(b.getFunction("transfer").format()),f=u.a.feeCollector;function j(e){return e[0]===f||!(!e[2].startsWith(m)||function(e){try{var s=b.decodeFunctionData("transfer",e);return Object(n.a)({value:i.a.from(s._value)},s)}catch(t){return console.error(t),{}}}(e[2])._to!==f)}var v=t(242);s.a=function(e){var s=e.relayerURL,t=e.selectedAcc,d=e.network,u=e.portfolio,O=e.useRelayerData,h=Object(v.a)().cacheBreak,g=u.tokens,p=s?"".concat(s,"/gas-tank/").concat(t,"/getBalance?cacheBreak=").concat(h):null,x=s?"".concat(s,"/gas-tank/assets?cacheBreak=").concat(h):null,k=s?"".concat(s,"/identity/").concat(t,"/").concat(null===d||void 0===d?void 0:d.id,"/transactions"):null,w=O({url:p}),y=w.data,A=w.isLoading,T=O({url:x}).data,S=O({url:k}).data,C=Object(r.useMemo)((function(){return y&&y.length&&y.map((function(e){return e.balanceInUSD})).reduce((function(e,s){return e+s}),0)}),[y]),N=Object(r.useMemo)((function(){return S&&S.txns.length&&S.txns.filter((function(e){return!!e.gasTankFee}))}),[S]),L=Object(r.useMemo)((function(){return T&&T.length&&T.filter((function(e){return e.network===(null===d||void 0===d?void 0:d.id)}))}),[T,null===d||void 0===d?void 0:d.id]),U=S&&S.txns.length&&S.txns,I=Object(r.useMemo)((function(){return U&&U.length&&function(e){var s=[];return e.forEach((function(e){var t=e.txId,a=e.txns,r=e.submittedAt,c=e.gasTankFee,d=e.identity,u=Object(o.a)(e,l),v=a.filter((function(e,s){return j(e)&&(c||s<a.length-1)})).map((function(e){return e[0]===f?Object(n.a)({submittedAt:r,address:"0x0000000000000000000000000000000000000000",value:i.a.from(e[1]),identity:d,txId:t},u):e[2].startsWith(m)&&b.decodeFunctionData("transfer",e[2])._to===f?Object(n.a)({submittedAt:r,address:e[0],value:i.a.from(b.decodeFunctionData("transfer",e[2])._value),identity:d,txId:t},u):null}));v.length&&s.push(v[0])})),s}(U)}),[U]),F=Object(r.useMemo)((function(){return null===L||void 0===L?void 0:L.map((function(e){var s=null===g||void 0===g?void 0:g.find((function(s){return s.address.toLowerCase()===e.address.toLowerCase()}));return s?Object(n.a)(Object(n.a)({},s),{},{tokenImageUrl:e.icon,decimals:e.decimals,symbol:e.symbol,balance:s.balance,disableGasTankDeposit:!!e.disableGasTankDeposit,balanceUSD:parseFloat(s.balance)*parseFloat(L.find((function(e){return e.address.toLowerCase()===s.address.toLowerCase()})).price||0)}):Object(n.a)(Object(n.a)({},e),{},{tokenImageUrl:e.icon,balance:0,balanceUSD:0,decimals:0,address:e.address.toLowerCase(),symbol:e.symbol.toUpperCase()})}))}),[L,g]),D=Object(r.useMemo)((function(){return N&&N.length&&N.map((function(e){var s=T?T.find((function(s){return s.symbol===e.feeToken})):null,t=s?c(s):null;return{saved:t?e.feeInUSDPerGas*t:0,cashback:e.gasTankFee&&e.gasTankFee.cashback?Object(a.formatUnits)(e.gasTankFee.cashback.toString(),null===s||void 0===s?void 0:s.decimals).toString()*(null===s||void 0===s?void 0:s.price):0}}))}),[T,N]);return{balancesRes:y,gasTankBalances:C,isLoading:A,gasTankTxns:N,feeAssetsRes:T,gasTankFilledTxns:I,totalSavedResult:D,availableFeeAssets:F}}}}]);
//# sourceMappingURL=21.b9b51e97.chunk.js.map