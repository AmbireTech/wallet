(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[15],{1582:function(e,t,n){},1583:function(e,t,n){},1584:function(e,t,n){},1612:function(e,t,n){},1613:function(e,t,n){},1641:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),s=n(8),a=n(11),i=n(7),o=(n(1582),n(37)),u=n(957),l=n(3),d=n(77),b=n(21),j=n(151),p=n(219),h=n(34),f=n(655),m=(n(1583),n(675)),x=n(703),O=n(727),g=n.n(O),v=n(671),w=n(631),y=n(153),k=n(632),N=n(683),A=n(152),C=n(658),S=n(617),I=n(4),E=function(e){var t=e.selectedNetwork,n=e.selectedAcc,r=e.onAddBtnClicked,u=Object(l.useState)({address:"",index:0}),b=Object(i.a)(u,2),j=b[0],p=b[1],f=Object(l.useState)(""),O=Object(i.a)(f,2),E=O[0],T=O[1],P=Object(l.useState)(!0),L=Object(i.a)(P,2),D=L[0],B=L[1],U=Object(l.useState)(!0),F=Object(i.a)(U,2),q=F[0],M=F[1],R=Object(l.useState)(null),K=Object(i.a)(R,2),z=K[0],J=K[1],Y=Object(l.useState)(!1),W=Object(i.a)(Y,2),H=W[0],_=W[1],G=Object(l.useState)(""),V=Object(i.a)(G,2),Q=V[0],X=V[1],Z=Object(h.f)().showModal,$=Object(l.useState)({success:!1,message:""}),ee=Object(i.a)($,2),te=ee[0],ne=ee[1];function re(){return ce.apply(this,arguments)}function ce(){return(ce=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(y.a)()){e.next=5;break}return e.next=3,se();case 3:e.next=7;break;case 5:return e.next=7,ie();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(){return ae.apply(this,arguments)}function ae(){return(ae=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new m.LedgerSubprovider({networkId:0,ledgerEthereumClientFactoryAsync:x.ledgerEthereumBrowserClientFactoryAsync,baseDerivationPath:k.a}),e.next=3,t.getAccountsAsync(100);case 3:n=e.sent,J({addresses:n,signerName:"Ledger"}),M(!0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return oe.apply(this,arguments)}function oe(){return(oe=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,Object(k.b)();case 4:if(1!==(n=e.sent).length){e.next=9;break}return e.abrupt("return",me({address:n[0],index:0}));case 9:J({address:n,signerName:"Ledger"}),M(!0);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0),t=e.t0.statusCode&&"InvalidChannel"===e.t0.id?"Invalid channel":e.t0.statusCode&&25873===e.t0.statusCode?"Please make sure your ledger is connected and the ethereum app is open":e.t0.message;case 17:t&&T("Ledger error: ".concat(t.message||t));case 18:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return(le=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.a.manifest({email:"contactus@ambire.com",appUrl:"https://wallet.ambire.com"}),t=new v.TrezorSubprovider({trezorConnectClientApi:g.a}),e.next=4,t.getAccountsAsync(100);case 4:n=e.sent,J({addresses:n,signerName:"Trezor"}),M(!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return be.apply(this,arguments)}function be(){return(be=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof window.ethereum){e.next=2;break}throw new Error("MetaMask not available");case 2:return t=window.ethereum,e.next=5,t.request({method:"eth_requestAccounts"});case 5:if((n=e.sent).length){e.next=8;break}throw new Error("No accounts connected");case 8:if(1!==n.length){e.next=10;break}return e.abrupt("return",me({address:n[0],index:0}));case 10:J({addresses:n,signerName:"Web3"}),M(!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=function(e){var t=e.addresses,n=e.deviceId,r=e.commKey,c=e.isPaired;J({addresses:t,signerName:"Lattice",signerExtra:{type:"Lattice",deviceId:n,commKey:r,isPaired:c}}),M(!0)};function pe(){return he.apply(this,arguments)}function he(){return(he=Object(a.a)(c.a.mark((function e(){var t,r,s,a,i,o,u,l,d,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.signerExtra||"Lattice"!==n.signerExtra.type||!n.signerExtra.isPaired){e.next=30;break}return t=n.signerExtra,r=t.commKey,s=t.deviceId,a=Object(S.c)(r),_(!0),e.next=6,Object(S.a)(a,s);case 6:if(i=e.sent,o=i.isPaired,!(u=i.errConnect)){e.next=13;break}return _(!1),T(u.message||u),e.abrupt("return");case 13:if(o){e.next=18;break}return _(!1),a.pair(""),T("The Lattice device is not paired! Please re-add your account!.",{timeout:3e4}),e.abrupt("return");case 18:return e.next=20,Object(S.b)(a);case 20:if(l=e.sent,d=l.res,!(b=l.errGetAddresses)){e.next=27;break}return _(!1),T("Lattice: ".concat(b),{error:!0}),e.abrupt("return");case 27:d&&(_(!1),je({addresses:d,deviceId:s,commKey:r,isPaired:!0})),e.next=31;break;case 30:Z(Object(I.jsx)(C.a,{addresses:je}));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe=function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(""),e.prev=1,e.next=4,t();case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0),T("Unexpected error: ".concat(e.t0.message||e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),me=Object(l.useCallback)((function(e){p(e),M((function(e){return!e})),z&&X("".concat(z.signerName," address # ").concat(e.index+1)),J(null)}),[z]),xe=Object(l.useCallback)((function(){return J(null)}),[]);Object(l.useEffect)((function(){q&&z&&Z(Object(I.jsx)(w.a,{signersToChoose:z.addresses,selectedNetwork:t,onSignerAddressClicked:me,description:"You will authorize the selected ".concat(z.signerName," address to sign transactions for your account."),onCloseBtnClicked:xe}))}),[xe,q,me,t,Z,z]);var Oe=Object(I.jsxs)("div",{className:"wallet-btns-wrapper",children:[Object(I.jsxs)(d.e,{onClick:function(){return fe(ue)},children:[Object(I.jsx)("div",{className:"icon",style:{backgroundImage:"url(./resources/trezor.png)"}}),"Trezor"]}),Object(I.jsxs)(d.e,{onClick:function(){return fe(re)},children:[Object(I.jsx)("div",{className:"icon",style:{backgroundImage:"url(./resources/ledger.png)"}}),"Ledger"]}),Object(I.jsxs)(d.e,{onClick:function(){return fe(pe)},children:[Object(I.jsx)("div",{className:"icon",style:{backgroundImage:"url(./resources/grid-plus.png)"}}),"Grid+ Lattice1"]}),Object(I.jsxs)(d.e,{onClick:function(){return fe(de)},children:[Object(I.jsx)("div",{className:"icon",style:{backgroundImage:"url(./resources/metamask.png)"}}),"Metamask / Browser"]})]});return Object(l.useEffect)((function(){var e=Object(N.a)(j.address,n.id);B(!e.success),ne({success:e.success,message:e.message?e.message:""})}),[n,j.address]),Object(I.jsxs)("div",{className:"content",children:[H&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h3",{children:"It may takes a while."}),Object(I.jsx)("h3",{children:"Please wait..."}),Object(I.jsx)(d.m,{})]}),!H&&Object(I.jsxs)("div",{className:"signer",children:[Object(I.jsxs)("div",{className:"signer-address-input",children:[Object(I.jsx)(d.w,{placeholder:"Enter signer address",className:"depositAddress",value:j.address,info:Q,onInput:function(e){Q.length&&X(""),p(Object(s.a)(Object(s.a)({},j),{},{address:e}))}}),Object(I.jsx)(d.j,{style:{height:"60px"},title:"Connect signer",closeOnClick:!0,children:Oe})]}),Object(I.jsx)("div",{className:"btns-wrapper",children:Object(I.jsx)(d.e,{disabled:D,icon:Object(I.jsx)(o.C,{}),onClick:function(){return r(j)},small:!0,children:"Add"})})]}),te.message&&Object(I.jsxs)("div",{className:"validation-error",children:[Object(I.jsx)(A.t,{size:12}),"\xa0",te.message]}),E?Object(I.jsx)("h3",{className:"error",children:E}):Object(I.jsx)(I.Fragment,{})]})},T=n(44),P=n(30),L=n(814),D=n(678),B=(n(1584),n(1585)),U=n(959),F=n.n(U),q=n(84),M=n(55),R=function(e){var t=e.relayerURL,n=e.selectedAcc,r=e.setCacheBreak,s=Object(h.f)().hideModal,o=Object(T.a)().addToast,u=Object(l.useMemo)((function(){return B.authenticator.generateSecret(20)}),[]),b=Object(l.useState)(!1),j=Object(i.a)(b,2),p=j[0],f=j[1],m=Object(l.useState)(null),x=Object(i.a)(m,2),O=x[0],g=x[1],v=Object(l.useState)(""),w=Object(i.a)(v,2),y=w[0],k=w[1],N=Object(l.useState)(!1),A=Object(i.a)(N,2),C=A[0],S=A[1],E=Object(l.useState)(""),P=Object(i.a)(E,2),L=P[0],D=P[1],U=Object(l.useState)(!1),R=Object(i.a)(U,2),K=R[0],z=R[1],J=Object(l.useState)(),Y=Object(i.a)(J,2),W=Y[0],H=Y[1];Object(l.useEffect)((function(){H(M.ethers.utils.hexlify(M.ethers.utils.toUtf8Bytes(JSON.stringify({otp:u,timestamp:(new Date).getTime()}))))}),[u]);var _=Object(l.useCallback)((function(){var e=B.authenticator.keyuri(n.email,"Ambire Wallet",u);F.a.toDataURL(e,{quality:1,margin:1},(function(e,t){e?(console.log(e),o(e.message,{error:!0})):g(t)}))}),[o,u,n.email]);Object(l.useEffect)(_,[_]);var G=function(){var e=Object(a.a)(c.a.mark((function e(){var r,s,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return o("Email/pass accounts not supported without a relayer connection",{error:!0}),e.abrupt("return");case 3:return e.next=5,Object(q.d)("".concat(t,"/second-key/").concat(n.id,"/ethereum/sign"),{toSign:W});case 5:r=e.sent,s=r.success,a=r.confCodeRequired,s||o("Unexpected error. This should never happen, please report this on help.ambire.com",{error:!0}),"email"!==a&&o("Expected email verification. This should never happen, please report this on help.ambire.com",{error:!0}),s&&"email"===a&&o("A confirmation code was sent to your email, please enter it along...");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(a.a)(c.a.mark((function e(){var a,i,l,d,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B.authenticator.verify({token:y,secret:u})){e.next=5;break}return o("Invalid or outdated OTP code entered. If you keep seeing this, please ensure your system clock is synced correctly.",{error:!0}),f(!1),e.abrupt("return");case 5:if(e.prev=5,L.length){e.next=9;break}return o("Please enter the code from authenticator app."),e.abrupt("return");case 9:return e.next=11,Object(q.d)("".concat(t,"/second-key/").concat(n.id,"/ethereum/sign"),{toSign:W,code:L});case 11:if(a=e.sent,i=a.success,l=a.signatureEthers,d=a.message,i){e.next=17;break}throw new Error(d||"unknown error");case 17:return e.next=19,Object(q.d)("".concat(t,"/identity/").concat(n.id,"/modify"),{otp:W,sig:l});case 19:if(!(b=e.sent).success){e.next=28;break}o("You have successfully enabled two-factor authentication."),r(),Q(),f(!1),s(),e.next=29;break;case 28:throw new Error("".concat(b.message||"unknown error"));case 29:e.next=36;break;case 31:e.prev=31,e.t0=e.catch(5),console.error(e.t0),o("OTP: "+e.t0.message||!1,{error:!0}),f(!1);case 36:case"end":return e.stop()}}),e,null,[[5,31]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){D(""),k("")};return Object(I.jsx)(d.n,{title:"Two Factor Authentication",topLeft:Object(I.jsx)(d.h,{seconds:300,setTimeIsUp:function(e){z(e)}}),children:Object(I.jsxs)("div",{id:"otp-auth",children:[K&&Object(I.jsx)("div",{className:"timer-reset-msg",children:"Please reopen the modal to reset the session."}),Object(I.jsx)("div",{className:"img-wrapper",children:Object(I.jsx)("img",{alt:"qr-code",src:O})}),Object(I.jsxs)("div",{className:"img-msg",style:{marginBottom:C?"0px":"22px"},children:[!C&&Object(I.jsx)("span",{className:"click-here",onClick:function(){S((function(e){return!e}))},children:"Unable to scan code? Click here."}),C&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("span",{children:"Enter this OTP in your app:"}),Object(I.jsx)("div",{children:u})]})]}),Object(I.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f(!0),V()},children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:"Confirmation code sent via Email"}),Object(I.jsxs)("div",{className:"input-wrapper",children:[Object(I.jsx)(d.w,{small:!0,pattern:"[0-9]+",title:"Confirmation code should be 6 digits",autoComplete:"nope",required:!0,minLength:6,maxLength:6,placeholder:"Confirmation code",value:L,onInput:function(e){return D(e)}}),Object(I.jsx)(d.e,{type:"button",small:!0,disabled:K,onClick:G,children:"Send Email"})]}),Object(I.jsx)("h4",{children:"Authenticator app code"}),Object(I.jsx)(d.w,{placeholder:"Enter the code from authenticator app",onInput:k,value:y,pattern:"[0-9]{6}",required:!0})]}),Object(I.jsx)("div",{className:"buttons",children:p?Object(I.jsx)(d.e,{disabled:!0,children:Object(I.jsx)(d.m,{})}):Object(I.jsx)(d.e,{type:"submit",disabled:K,children:"Enable 2FA"})})]})]})})},K=(n(1612),function(e){var t=e.relayerURL,n=e.selectedAcc,r=e.setCacheBreak,s=Object(h.f)().hideModal,o=Object(T.a)().addToast,u=Object(l.useState)(!1),b=Object(i.a)(u,2),j=b[0],p=b[1],f=Object(l.useState)(""),m=Object(i.a)(f,2),x=m[0],O=m[1],g=Object(l.useState)(!1),v=Object(i.a)(g,2),w=v[0],y=v[1],k=Object(l.useState)(),N=Object(i.a)(k,2),A=N[0],C=N[1];Object(l.useEffect)((function(){C(M.ethers.utils.hexlify(M.ethers.utils.toUtf8Bytes(JSON.stringify({otp:null,timestamp:(new Date).getTime()}))))}),[]);var S=function(){var e=Object(a.a)(c.a.mark((function e(){var a,i,u,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(q.d)("".concat(t,"/second-key/").concat(n.id,"/ethereum/sign"),{toSign:A,code:x});case 3:if(a=e.sent,i=a.success,u=a.signatureEthers,l=a.message,i){e.next=9;break}throw new Error(l||"unknown error");case 9:return e.next=11,Object(q.d)("".concat(t,"/identity/").concat(n.id,"/modify"),{otp:A,sig:u});case 11:if(!(d=e.sent).success){e.next=20;break}o("You have successfully disabled two-factor authentication."),r(),E(),p(!1),s(),e.next=21;break;case 20:throw new Error("".concat(d.message||"unknown error"));case 21:e.next=28;break;case 23:e.prev=23,e.t0=e.catch(0),console.error(e.t0),o("OTP: "+e.t0.message||!1,{error:!0}),p(!1);case 28:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(){return e.apply(this,arguments)}}(),E=function(){O("")};return Object(I.jsx)(d.n,{id:"disable-otp-modal",title:"Disable Two Factor Authentication",topLeft:Object(I.jsx)(d.h,{seconds:300,setTimeIsUp:function(e){y(e)}}),children:Object(I.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p(!0),S()},children:[w&&Object(I.jsx)("div",{className:"timer-reset-msg",children:"Please reopen the modal to reset the session."}),Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:"Authenticator app code"}),Object(I.jsx)(d.w,{placeholder:"Enter the code from authenticator app",onInput:O,value:x,pattern:"[0-9]{6}",required:!0})]}),Object(I.jsx)("div",{className:"buttons",children:j?Object(I.jsx)(d.e,{disabled:!0,children:Object(I.jsx)(d.m,{})}):Object(I.jsx)(d.e,{type:"submit",disabled:w,children:"Disable 2FA"})})]})})}),z=(n(1613),n(684)),J=n(249),Y=function(e){var t,n=e.selectedAccount,r=e.accounts,c=e.onOpen,a=e.onAddAccount,i=e.relayerURL,o=Object(J.a)().showModal,u=function(){o(Object(I.jsx)(z.b,{selectedAccount:n,accounts:r,onAddAccount:a}))},l=function(){o(Object(I.jsx)(z.c,{accounts:r,onAddAccount:a,selectedAccount:n,relayerURL:i}))};return Object(I.jsxs)("div",{id:"backup",children:[Object(I.jsxs)("div",{className:"panel",children:[Object(I.jsx)("div",{className:"panel-title",children:"Backup current account"}),Object(I.jsxs)("div",{className:"backup-note",children:[Object(I.jsx)("b",{children:"Note:"})," Those backups exports will be importable in Ambire Wallet only. They are not importable in other wallets."]}),Object(I.jsxs)("div",{className:"content",id:"export",children:[Object(I.jsxs)("div",{className:"panel-sub",children:[Object(I.jsx)("div",{className:"backupIcon",children:Object(I.jsx)(A.k,{})}),Object(I.jsxs)("div",{className:"backup-info",children:[Object(I.jsxs)("p",{children:["Download a backup of your current account (",n.id.slice(0,5),"...",n.id.slice(-3),") encrypted with your password. It's safe to store in iCloud/Google Drive, but you cannot use it to restore your account if you forget the password."]}),Object(I.jsx)("a",{className:"buttonLink",type:"button",href:"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(n))),download:"".concat(n.id,".json"),children:Object(I.jsx)(d.e,{small:!0,full:!0,onClick:function(){a(Object(s.a)(Object(s.a)({},n),{},{downloadedBackup:!0}))},children:"Export as JSON"})})]})]}),Object(I.jsxs)("div",{className:"panel-sub",children:[Object(I.jsx)("div",{className:"backupIcon",children:Object(I.jsx)(A.m,{})}),Object(I.jsxs)("div",{className:"backup-info",children:[Object(I.jsxs)("p",{children:["Backup your account (",n.id.slice(0,5),"...",n.id.slice(-3),") on paper as a seed phrase. The seed phrase will be unencrypted, so store it safely."]}),(t=n,t.email?t.primaryKeyBackup?Object(I.jsx)(d.e,{full:!0,small:!0,onClick:u,children:"Backup on paper"}):Object(I.jsx)(d.e,{full:!0,small:!0,disabled:!0,className:"email-accounts-only",children:"Keys required for paper backup"}):Object(I.jsx)(d.e,{full:!0,small:!0,disabled:!0,className:"email-accounts-only",children:"Available for emails accounts only"}))]})]})]})]}),Object(I.jsxs)("div",{className:"panel",id:"import",children:[Object(I.jsx)("div",{className:"panel-title",children:"Import an account from backup"}),Object(I.jsxs)("div",{className:"backup-note",children:[Object(I.jsx)("b",{children:"Note:"})," Only backups previously saved with Ambire Wallet are compatible."]}),Object(I.jsxs)("div",{className:"panel-sub",children:[Object(I.jsx)("div",{className:"backupIcon",children:Object(I.jsx)(A.l,{})}),Object(I.jsxs)("div",{className:"backup-info",children:[Object(I.jsxs)("p",{children:["Import an Ambire account from a backed up JSON file.",Object(I.jsx)("br",{}),"You can also drag and drop an account backup JSON file on this page"]}),Object(I.jsx)(d.e,{small:!0,full:!0,onClick:c,children:"Import from JSON"})]})]}),Object(I.jsxs)("div",{className:"panel-sub",children:[Object(I.jsx)("div",{className:"backupIcon",children:Object(I.jsx)(A.n,{})}),Object(I.jsxs)("div",{className:"backup-info",children:[Object(I.jsxs)("p",{children:["Update your Ambire account (",n.id.slice(0,5),"...",n.id.slice(-3),") with signer keys from a backed up seed phrase"]}),function(e){return e.email?e.primaryKeyBackup?Object(I.jsx)(d.e,{full:!0,small:!0,disabled:!0,children:"Keys already active"}):Object(I.jsx)(d.e,{small:!0,full:!0,onClick:l,children:"Import from paper"}):Object(I.jsx)(d.e,{full:!0,small:!0,disabled:!0,className:"email-accounts-only",children:"Available for emails accounts only"})}(n)]})]})]})]})},W=n(810),H=n(155),_=n(154),G=new b.Interface(n(367));t.default=function(e){var t=e.relayerURL,n=e.selectedAcc,r=e.selectedNetwork,m=e.accounts,x=e.addRequest,O=e.showSendTxns,g=e.onAddAccount,v=Object(_.a)().constants.humanizerInfo,w=Object(h.f)().showModal,y=Object(l.useState)((function(){return Date.now()})),k=Object(i.a)(y,2),N=k[0],A=k[1];Object(l.useEffect)((function(){Date.now()-N>3e4&&A(Date.now());var e=setTimeout((function(){return A(Date.now())}),4e4);return function(){return clearTimeout(e)}}),[N]);var C=t?"".concat(t,"/identity/").concat(n,"/").concat(r.id,"/privileges?cacheBreak=").concat(N):null,S=Object(h.j)({url:C}),B=S.data,U=S.errMsg,F=S.isLoading,q=B?B.privileges:{},M=B?B.otpEnabled:null,z=B&&B.recoveryLock,J=Object(T.a)().addToast,V=Object(P.useHistory)(),Q=m.find((function(e){return e.id===n})),X=function(e,t){return{to:n,data:G.encodeFunctionData("setAddrPrivilege",[e,t]),value:"0x00"}},Z=function(e){try{x({id:"setPriv_".concat(e.data),type:"eth_sendTransaction",txn:e,chainId:r.chainId,account:n})}catch(t){console.error(t),J("Error: ".concat(t.message||t),{error:!0})}},$=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}return e.abrupt("return",J(Object(I.jsxs)("span",{children:["To make this signer default, please ",Object(I.jsx)("a",{href:"#/email-login",children:"please login with the email"})]}),{url:"/#/email-login",error:!0}));case 4:g(Object(s.a)(Object(s.a)({},t),{},{signer:{address:n},signerExtra:null})),J("This signer is now the default. If it is a hardware wallet, you will have to re-add the account manually to connect it directly, otherwise you will have to add this signer address to your web3 wallet.",{timeout:3e4});case 6:V.push("/wallet/security");case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ee=function(){t?w(Object(I.jsx)(f.a,{account:Q,selectedNetwork:r,relayerURL:t,onAddAccount:g,showSendTxns:O})):J("Unsupported without a connection to the relayer",{error:!0})},te=function(){if(!t)return J("Unsupported without a connection to the relayer",{error:!0});w(Object(I.jsx)(R,{relayerURL:t,selectedAcc:Q,setCacheBreak:function(){A(Date.now())}}))},ne=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",J("Unsupported without a connection to the relayer",{error:!0}));case 2:w(Object(I.jsx)(K,{relayerURL:t,selectedAcc:Q,setCacheBreak:function(){A(Date.now())}}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=Object(l.useCallback)((function(e,t){var n=new FileReader;if(t.length&&J("".concat(t[0].file.path," - ").concat((t[0].file.size/1024).toFixed(2)," KB. ").concat(t[0].errors[0].message),{error:!0}),e.length){var r=e[0];n.readAsText(r,"UTF-8"),n.onload=function(e){var t=e.target.result,n=JSON.parse(t),r=Object(D.b)(n);r.success?g(n,{select:!0}):J(r.message,{error:!0})}}}),[J,g]),ce=Object(L.a)({onDrop:re,noClick:!0,noKeyboard:!0,accept:"application/json",maxFiles:1,validator:D.a}),se=ce.getRootProps,ae=ce.getInputProps,ie=ce.open,oe=ce.isDragActive,ue=ce.isDragAccept,le=ce.isDragReject,de=q[Q.signer.quickAccManager]&&(z&&z.status&&!F||q&&Q.signer.quickAccManager&&Q.signer.preRecovery&&function(e){var t=new b.AbiCoder,n=e.timelock,r=e.one,c=e.two;return Object(b.keccak256)(t.encode(["tuple(uint, address, address)"],[[n,r,c]]))}(Q.signer)!==q[Q.signer.quickAccManager]),be=Object.entries(q).map((function(e){var t=Object(i.a)(e,2),n=t[0];if(!t[1])return null;var r=Object(H.b)(v,n)||null,c=n===j.a.quickAccManager,s=c?"Email/password signer (".concat(Q.email||"unknown email",")"):"".concat(n," ").concat(r&&r!==n?"(".concat(r,")"):""),a=(c?Q.signer.quickAccManager:Q.signer.address)===n,u=c&&!de;return Object(I.jsxs)("li",{children:[Object(I.jsx)(d.w,{className:"depositAddress",value:s,disabled:!0}),Object(I.jsxs)("div",{className:"btns-wrapper",children:[c&&null!==M&&(M?Object(I.jsx)(d.e,{red:!0,onClick:ne,small:!0,children:"Disable 2FA"}):Object(I.jsx)(d.e,{onClick:te,small:!0,children:"Enable 2FA"})),c&&Object(I.jsx)(d.e,{disabled:!u,title:de?"Account recovery already in progress":"",onClick:ee,small:!0,children:"Change password"}),Object(I.jsx)(d.e,{disabled:a,title:a?"Signer is already default":"",onClick:function(){return $(Q,n,c)},small:!0,children:"Make default"}),Object(I.jsx)(d.e,{onClick:function(){return function(e){var t=X(e,p.a.false);Z(t)}(n)},small:!0,red:!0,icon:Object(I.jsx)(o.T,{}),title:a?"Cannot remove the currently used signer":"",disabled:a,children:"Remove"})]})]},n)})).filter((function(e){return e})),je=F&&!B,pe=t?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"panel",id:"signers",children:[de&&!je&&Object(I.jsx)(W.a,{recoveryLock:z,showSendTxns:O,selectedAccount:Q,selectedNetwork:r}),Object(I.jsxs)("div",{className:"network-warning",children:[Object(I.jsx)(o.v,{size:36}),Object(I.jsxs)("div",{children:["Please note: signer settings are network-specific. You are currently looking at and modifying the signers on ",r.name,". \xa0",Object(I.jsx)("a",{href:"https://help.ambire.com/hc/en-us/articles/4410885684242-Signers",target:"_blank",rel:"noreferrer",children:"Need help? Click here."})]})]}),Object(I.jsx)("div",{className:"panel-title",children:"Authorized signers"}),U&&Object(I.jsxs)("h3",{className:"error",children:["Error getting authorized signers: ",U]}),je&&Object(I.jsx)(d.m,{}),Object(I.jsx)("ul",{className:"content",children:!je&&be})]}),Object(I.jsxs)("div",{className:"panel",children:[Object(I.jsx)("div",{className:"panel-title",children:"Add new signer"}),Object(I.jsx)(E,{onAddBtnClicked:function(e){var t=X(e.address,p.a.true);Z(t)},selectedNetwork:r,selectedAcc:Q})]})]}):Object(I.jsxs)("div",{className:"panel",children:[Object(I.jsx)("div",{className:"panel-title",children:"Authorized signers"}),Object(I.jsx)("h3",{className:"error",children:"Unsupported: not connected to a relayer."})]});return Object(I.jsxs)("section",Object(s.a)(Object(s.a)({id:"security",className:(oe?"activeStyle ":"")+(ue?"acceptStyle ":"")+(le?"rejectStyle ":"")},se()),{},{children:[(ue||le)&&Object(I.jsx)("div",{className:ue?"acceptStyleIcon":"rejectStyleIcon",children:Object(I.jsx)(u.a,{size:100})}),Object(I.jsx)("input",Object(s.a)({},ae())),pe,Object(I.jsx)(Y,{selectedAccount:Q,accounts:m,onOpen:ie,onAddAccount:g})]}))}},632:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return w})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return A}));var r=n(8),c=n(2),s=n.n(c),a=n(11),i=n(710),o=n(717),u=n(619),l=n(231),d=n(611),b=null,j="44'/60'/0'/0";function p(){return h.apply(this,arguments)}function h(){return(h=Object(a.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.list();case 2:if(!(b=e.sent).length){e.next=11;break}if(!b[0].opened){e.next=8;break}return e.abrupt("return",new i.a(b[0]));case 8:return e.abrupt("return",i.a.open(b[0]));case 9:e.next=22;break;case 11:return e.prev=11,e.next=14,i.a.request();case 14:return e.abrupt("return",e.sent);case 17:if(e.prev=17,e.t0=e.catch(11),!e.t0.message.includes("reading 'open'")){e.next=21;break}throw new Error("ledger WebHID request denied");case 21:throw new Error("Could not request WebHID ledger: "+e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[11,17]])})))).apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return(m=Object(a.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return t=e.sent,e.next=5,x(t);case 5:return n=e.sent,t.close(),e.abrupt("return",n.map((function(e){return e.address})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return O.apply(this,arguments)}function O(){return(O=Object(a.a)(s.a.mark((function t(n){var r,c,a,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="m/".concat(j),t.next=3,g(n,r).then((function(e){return e})).catch((function(e){throw 25871===e.statusCode||27404===e.statusCode?Error("Please make sure your ledger is unlocked and running the Ethereum app. "+e.message):Error("Could not get address from ledger : "+e)}));case 3:return c=t.sent,(a=new d).publicKey=e.from(c.publicKey,"hex"),a.chainCode=e.from(c.chainCode,"hex"),i=I(a),o={hdKey:a,address:i,derivationPath:r,baseDerivationPath:j},t.abrupt("return",S(o,1));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(e,t){return v.apply(this,arguments)}function v(){return(v=Object(a.a)(s.a.mark((function e(t,n){var r,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new o.a(t),a=new Promise((function(e,t){r=setTimeout((function(){return t(new Error("Device took too long to respond..."))}),1e4)})),e.abrupt("return",Promise.race([c.getAddress(n,!1,!0),a]).then((function(e){return clearTimeout(r),e})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return y.apply(this,arguments)}function y(){return(y=Object(a.a)(s.a.mark((function e(t,n){var c,a,i,l,d,b,j,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return c=e.sent,a=t.from,delete(i=Object(r.a)(Object(r.a)({},t),{},{gasLimit:t.gasLimit||t.gas,chainId:n})).from,delete i.gas,l=Object(u.a)(i),e.next=10,x(c);case 10:if(d=e.sent,d[0].address.toLowerCase()!==a.toLowerCase()){e.next=30;break}return e.prev=13,e.next=16,new o.a(c).signTransaction(d[0].derivationPath,l.substr(2));case 16:j=e.sent,e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(13),new Error("Could not sign transaction "+e.t0);case 22:if(h=parseInt(j.v,16),Math.floor((h-35)/2)===n){e.next=26;break}throw new Error("Invalid returned V 0x"+j.v);case 26:delete i.v,b=Object(u.a)(i,{r:"0x"+j.r,s:"0x"+j.s,v:h}),e.next=31;break;case 30:throw new Error("Incorrect address. Are you using the correct account/ledger?");case 31:return c.close(),e.abrupt("return",b);case 33:case"end":return e.stop()}}),e,null,[[13,19]])})))).apply(this,arguments)}function k(e,t){return N.apply(this,arguments)}function N(){return(N=Object(a.a)(s.a.mark((function e(t,n){var r,c,a,i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return r=e.sent,e.next=5,x(r);case 5:if(c=e.sent,(a=c[0]).address.toLowerCase()!==n.toLowerCase()){e.next=20;break}return e.prev=8,e.next=11,new o.a(r).signPersonalMessage(a.derivationPath,t.substr(2));case 11:u=e.sent,i="0x"+u.r+u.s+u.v.toString(16),e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(8),new Error("Signature denied "+e.t0.message);case 18:e.next=21;break;case 20:throw new Error("Incorrect address. Are you using the correct account/ledger?");case 21:return r.close(),e.abrupt("return",i);case 23:case"end":return e.stop()}}),e,null,[[8,15]])})))).apply(this,arguments)}function A(e,t,n){return C.apply(this,arguments)}function C(){return(C=Object(a.a)(s.a.mark((function e(t,n,r){var c,a,i,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return c=e.sent,e.next=5,x(c);case 5:if(a=e.sent,(i=a[0]).address.toLowerCase()!==r.toLowerCase()){e.next=20;break}return e.prev=8,e.next=11,new o.a(c).signEIP712HashedMessage(i.derivationPath,t,n);case 11:l=e.sent,u="0x"+l.r+l.s+l.v.toString(16),e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(8),new Error("Signature denied "+e.t0.message);case 18:e.next=21;break;case 20:throw new Error("Incorrect address. Are you using the correct account/ledger?");case 21:return c.close(),e.abrupt("return",u);case 23:case"end":return e.stop()}}),e,null,[[8,15]])})))).apply(this,arguments)}function S(e,t){for(var n=[],r=0;r<t;r++){var c="m/".concat(e.baseDerivationPath,"/").concat(r),s="m/".concat(r),a=e.hdKey.derive(s),i={address:I(a),hdKey:a,baseDerivationPath:e.baseDerivationPath,derivationPath:c};n.push(i)}return n}function I(e){var t=e.publicKey,n=l.publicToAddress(t,!0).toString("hex");return l.addHexPrefix(n).toLowerCase()}}).call(this,n(25).Buffer)},683:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u}));var r=n(21),c=n(91),s=n(151),a=function(e){return e&&e.length?e&&Object(c.b)(e)?{success:!0}:{success:!1,message:"Invalid address."}:{success:!1,message:""}},i=function(e,t){var n=a(e);return n.success?e&&t&&e===t?{success:!1,message:"The entered address should be different than the your own account address."}:{success:!0}:n},o=function(e,t,n,r,i,o){var u=a(e);return u.success?e&&e===s.a.feeCollector?{success:!0}:e&&t&&e===t?{success:!1,message:"The entered address should be different than the your own account address."}:e&&Object(c.a)(e)?{success:!1,message:"You are trying to send tokens to a smart contract. Doing so would burn them."}:!e||r(e)||n||i||o?!e||r(e)||n||!i&&!o?{success:!0}:{success:!1,message:"You're trying to send to an ".concat(i?"Unstoppable domain":"Ethereum Name Service",". If you really trust to the person who gave you, confirm using the checkbox below.")}:{success:!1,message:"You're trying to send to an unknown address. If you're really sure, confirm using the checkbox below."}:u},u=function(e,t){if(!e||!e.length)return{success:!1,message:""};if(!(e&&e>0))return{success:!1,message:"The amount must be greater than 0."};try{if(e&&t&&t.decimals){var n=e.slice(0,e.indexOf(".")+t.decimals+1),c=Object(r.parseUnits)(n,t.decimals);if(c&&t.balanceRaw&&c.gt(t.balanceRaw))return{success:!1,message:"The amount is greater than the asset's balance: ".concat(null===t||void 0===t?void 0:t.balance," ").concat(null===t||void 0===t?void 0:t.symbol,".")}}}catch(s){console.error(s)}return{success:!0}},l=function(e,t,n,r,c,s,a,i,u){var l,d=o(e,t,n,r,i,u);return d.success?c&&t&&(null===(l=c.owner)||void 0===l?void 0:l.address.toLowerCase())!==t.toLowerCase()?{success:!1,message:"The NFT you're trying to send is not owned by you!"}:s&&a&&s.id!==a?{success:!1,message:"The selected network is not the correct one."}:{success:!0}:d}},699:function(e,t){},700:function(e,t){},704:function(e,t){},708:function(e,t){},810:function(e,t,n){"use strict";var r=n(2),c=n.n(r),s=n(11),a=n(228),i=n(184),o=n(679),u=n(4);t.a=function(e){var t=e.recoveryLock,n=e.showSendTxns,r=e.selectedAccount,l=e.selectedNetwork,d=t&&"requestedButNotInitiated"!==t.status,b=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=2;break}return e.abrupt("return");case 2:t=Object(o.a)(r.id,l.id,r.signer.preRecovery,{signer:r.signer,primaryKeyBackup:r.primaryKeyBackup}),n(t,!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=t?t.status:"requestedButNotInitiated",p=function(e){return e>86400?"".concat(Math.ceil(e/86400)," days"):"".concat(Math.ceil(e/1440)," hours")},h=d?"ready"===j?"success":"warning":"warning action";return Object(u.jsxs)("div",{className:"notification-banner notification-hollow ".concat(h),onClick:function(){return b()},children:["ready"===j?Object(u.jsx)(i.b,{}):Object(u.jsx)(a.b,{}),"requestedButNotInitiated"===j?Object(u.jsxs)(u.Fragment,{children:["Password reset requested but not initiated for ",l.name,". Click here to initiate it."]}):"initiationTxnPending"===j?Object(u.jsxs)(u.Fragment,{children:["Initiation transaction is currently pending. Once mined, you will need to wait ",p(t.timelock)," for the reset to be done on ",l.name,"."]}):"waitingTimelock"===j?Object(u.jsxs)(u.Fragment,{children:["Password reset on ",l.name," is currently pending. ",p(t.remaining)," remaining."]}):"ready"===j?Object(u.jsxs)(u.Fragment,{children:["Password reset on ",l.name," is now complete! You can start signing transactions with your new password!"]}):"failed"===j?Object(u.jsx)(u.Fragment,{children:"Something went wrong while resetting your password. Please contact support at help.ambire.com"}):null]})}}}]);
//# sourceMappingURL=15.20062cdd.chunk.js.map