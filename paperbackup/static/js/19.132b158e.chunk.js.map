{"version":3,"sources":["components/Wallet/Gas/GasDetails/GasDetails.js","components/Wallet/Gas/GasTank/GasTank.js","components/Wallet/Gas/Gas.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/ambire-common/src/constants/gasSpeeds.ts","../node_modules/ambire-common/src/helpers/sendTxnHelpers/sendTxnHelpers.ts","../node_modules/ambire-common/src/services/isFeeCollectorTxn/isFeeCollectorTxn.ts","../node_modules/ambire-common/src/hooks/useGasTankData/index.ts","../node_modules/ambire-common/src/hooks/useGasTankData/useGasTankData.ts"],"names":["GasDetails","gasData","GAS_PRICES","GAS_SPEEDS","reduce","acc","speed","gasPrice","maxPriorityFeePerGas","id","className","Date","updated","toDateString","toTimeString","substr","map","index","Math","round","ACTION_GAS_COSTS","a","name","rowIndex","gas","AMBIRE_OVERHEAD_COST","gasFeeAssets","native","toFixed","GasTank","network","relayerURL","portfolio","account","userSorting","setUserSorting","gasTankState","setGasTankState","useGasTankData","selectedAcc","useRelayerData","isLoading","balancesRes","gasTankBalances","totalSavedResult","gasTankFilledTxns","feeAssetsRes","availableFeeAssets","showModal","useModals","addToast","useToasts","gasTankBalancesFormatted","formatFloatTokenAmount","totalSaved","length","i","saved","b","totalCashBack","cashback","isBalanceLoading","sortType","tokens","isMobileScreen","useCheckMobileScreen","useState","failedImg","setFailedImg","sortedTokens","filter","item","disableGasTankDeposit","sort","balanceUSD","items","chainId","indexOf","address","toLowerCase","decreasing","symbol","toUpperCase","localeCompare","useDragAndDrop","list","prev","dragStart","dragEnter","target","handle","dragTarget","drop","currentAccGasTankState","find","isEnabled","style","cursor","onClick","GasTankBalanceByTokensModal","data","checked","onChange","updatedGasTankDetails","error","toggleGasTank","label","color","tokenImageUrl","balance","decimals","icon","img","send","category","sortedTokensLength","logo","includes","getTokenIcon","disabled","draggable","onDragStart","e","current","contains","preventDefault","onMouseDown","onDragEnter","onDragEnd","onDragOver","size","src","alt","onError","failed","to","pathname","state","gasTankMsg","isTopUp","small","tokenItem","key","date","tokenDetails","submittedAt","toLocaleDateString","toLocaleTimeString","toString","width","height","formatUnits","value","href","explorerUrl","txId","rel","stopPropagation","r","Gas","selectedNetwork","selectedAccount","now","cacheBreak","setCacheBreak","useEffect","intvl","setTimeout","clearTimeout","url","errMsg","isGasTankAvailable","_objectWithoutProperties","source","excluded","Object","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","getAddedGas","token","ERC20AbiInterface","Interface","ERC20ABI","TRANSFER_SIGHASH","getSighash","getFunction","format","feeCollector","accountPresets","isFeeCollectorTxn","txn","startsWith","res","decodeFunctionData","BigNumber","from","_value","console","getTxnTransferInfo","_to","useCacheBreak","urlGetBalance","urlGetFeeAssets","urlGetTransactions","executedTxnsRes","useMemo","balanceInUSD","gasTankTxns","txns","gasTankFee","feeAssetsPerNetwork","executedTxns","transactions","depositTxns","forEach","identity","rest","filteredTxns","txnCall","fillTxn","push","getGasTankFilledTxns","isFound","x","parseFloat","price","feeTokenDetails","feeToken","savedGas","feeInUSDPerGas"],"mappings":"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","file":"static/js/19.132b158e.chunk.js","sourcesContent":["import './GasDetails.scss'\n\nimport { GAS_SPEEDS } from 'ambire-common/src/constants/gasSpeeds'\nimport { ACTION_GAS_COSTS, AMBIRE_OVERHEAD_COST } from 'ambire-common/src/constants/actionGasCosts'\n\nconst GasDetails = ({ gasData }) => {\n  const GAS_PRICES = GAS_SPEEDS.reduce((acc, speed) => {\n    acc[speed] =\n        gasData.gasPrice.maxPriorityFeePerGas\n          ? (gasData.gasPrice.maxPriorityFeePerGas[speed] + gasData.gasPrice[speed])\n          : gasData.gasPrice[speed]\n    return acc\n  }, {})\n\n  return (\n    <div id='gas-details-modal'>\n      <div className='gas-details-date'>\n        Last updated: { new Date(gasData.gasPrice.updated).toDateString() + ' ' + new Date(gasData.gasPrice.updated).toTimeString().substr(0, 8) }\n      </div>\n      <div className='gas-speed-row'>\n        {\n          GAS_SPEEDS.map((speed, index) => {\n            return (\n              <div className='gas-speed-block' key={index}>\n                <div className='gas-speed-name'>{speed}</div>\n                <div className='gas-speed-price'>\n                  {Math.round(GAS_PRICES[speed] / 10 ** 9)} Gwei\n                </div>\n              </div>\n            )\n          })\n        }\n      </div>\n      <h4>Estimated Cost of Transaction Actions</h4>\n     <div className='table-wrapper'>\n      <table className='gas-action-costs'>\n          <thead>\n          <tr>\n            <th>Action</th>\n            {GAS_SPEEDS.map((speed, index) => <th key={index}>{speed}</th>)}\n          </tr>\n          </thead>\n          <tbody>\n          {\n            ACTION_GAS_COSTS.map((a, index) => <tr key={index}>\n              <td>{a.name}</td>\n              {GAS_SPEEDS.map((speed, rowIndex) => <td key={rowIndex}>${(GAS_PRICES[speed] * (a.gas + AMBIRE_OVERHEAD_COST) / 10 ** 18 * gasData.gasFeeAssets.native).toFixed(2)}</td>)}\n            </tr>)\n          }\n          </tbody>\n        </table>\n      </div>\n    </div>\n  )\n}\n\nexport default GasDetails\n","import useGasTankData from 'ambire-common/src/hooks/useGasTankData'\n\nimport './GasTank.scss'\nimport { Toggle } from 'components/common'\nimport { useState } from 'react'\nimport { GiToken, GiGasPump } from 'react-icons/gi'\nimport { NavLink } from 'react-router-dom'\nimport { Button, Loading } from 'components/common'\nimport { MdDragIndicator, MdOutlineSort } from 'react-icons/md'\nimport { useDragAndDrop, useCheckMobileScreen } from 'hooks'\nimport { getTokenIcon } from 'lib/icons'\nimport { formatFloatTokenAmount } from 'lib/formatters'\nimport { ToolTip } from 'components/common'\nimport { useRelayerData } from 'hooks'\nimport { useModals } from 'hooks'\nimport GasTankBalanceByTokensModal from 'components/Modals/GasTankBalanceByTokensModal/GasTankBalanceByTokensModal'\nimport { HiOutlineExternalLink } from 'react-icons/hi'\nimport { formatUnits } from 'ethers/lib/utils'\n// eslint-disable-next-line import/no-relative-parent-imports\nimport { useToasts } from '../../../../hooks/toasts'\n\nconst GasTank = ({ \n    network, \n    relayerURL, \n    portfolio, \n    account, \n    userSorting, \n    setUserSorting,\n    gasTankState, \n    setGasTankState \n}) => {\n    const {\n        isLoading,\n        balancesRes,\n        gasTankBalances,\n        totalSavedResult,\n        gasTankFilledTxns,\n        feeAssetsRes,\n        availableFeeAssets\n      } = useGasTankData({\n        relayerURL,\n        selectedAcc: account,\n        network,\n        portfolio,\n        useRelayerData\n      })\n\n    const { showModal } = useModals()\n    const { addToast } = useToasts()\n\n    const gasTankBalancesFormatted = gasTankBalances ? formatFloatTokenAmount(gasTankBalances, true, 2) : '0.00'\n    const totalSaved = totalSavedResult && totalSavedResult.length && \n        formatFloatTokenAmount(totalSavedResult.map(i => i.saved).reduce((a, b) => a + b), true, 2)\n    const totalCashBack = totalSavedResult && totalSavedResult.length && \n        formatFloatTokenAmount(totalSavedResult.map(i => i.cashback).reduce((a, b) => a + b), true, 2)\n        \n    const { isBalanceLoading } = portfolio\n    const sortType = userSorting.tokens?.sortType || 'decreasing'\n    const isMobileScreen = useCheckMobileScreen()\n    const [failedImg, setFailedImg] = useState([])\n    const toLocaleDateTime = date => `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`\n    const sortedTokens = availableFeeAssets?.filter(item => !item.disableGasTankDeposit).sort((a, b) => b.balanceUSD - a.balanceUSD).sort((a, b) => {\n        if (sortType === 'custom' && userSorting.tokens?.items?.[`${account}-${network.chainId}`]?.length) {\n            const addressA = userSorting.tokens.items[`${account}-${network.chainId}`].indexOf(a.address.toLowerCase())\n            const addressB = userSorting.tokens.items[`${account}-${network.chainId}`].indexOf(b.address.toLowerCase())\n            const sorted = addressA - addressB\n            return sorted\n        } else {\n            const decreasing = b.balanceUSD - a.balanceUSD\n            if (decreasing === 0) return a.symbol.toUpperCase().localeCompare(b.symbol.toUpperCase())\n            return decreasing\n        }\n    })\n\n    const onDropEnd = (list) => {        \n        setUserSorting(\n            prev => ({\n                ...prev,\n                tokens: {\n                    sortType: 'custom',\n                    items: {\n                        ...prev.tokens?.items,\n                        [`${account}-${network.chainId}`]: list\n                    }\n                }\n            })\n        )\n    }\n\n    const { dragStart, dragEnter, target, handle, dragTarget,drop } = useDragAndDrop('address', onDropEnd)\n    const currentAccGasTankState = gasTankState.length ? \n    gasTankState.find(i => i.account === account) :\n        setGasTankState([\n            ...gasTankState,\n            { account: account, isEnabled: false }\n        ])\n    const toggleGasTank = () => {\n        if (!gasTankBalances && !gasTankBalances.length) {\n            addToast('Add assets from the list to the Gas Tank to enable it.', { error: true })\n            return \n        }\n\n        const updatedGasTankDetails = \n            gasTankState.map(item => (item.account === account) ? \n            { ...item, isEnabled: !item.isEnabled } : item)\n        setGasTankState(updatedGasTankDetails)\n    }\n\n    const openGasTankBalanceByTokensModal = () => {\n        showModal(<GasTankBalanceByTokensModal data={ (balancesRes && balancesRes.length) ? balancesRes : [] }/>)\n    }\n\n    const tokenItem = (index, img, symbol, balance, balanceUSD, address, send = false, network, decimals, category, sortedTokensLength) => \n        {\n            const logo = failedImg.includes(img) ? getTokenIcon(network, address) : img\n                \n            return (<div className=\"token\" key={`token-${address}-${index}`}\n                disabled={balance === 0}\n                draggable={category === 'tokens' && sortedTokensLength > 1 && sortType === 'custom' && !isMobileScreen}\n                onDragStart={(e) => {\n                    if (handle.current === target.current || handle.current.contains(target.current)) dragStart(e, index)\n                    else e.preventDefault();\n                }}\n                onMouseDown={(e) => dragTarget(e, index)}\n                onDragEnter={(e) => dragEnter(e, index)}\n                onDragEnd={() => drop(sortedTokens)}\n                onDragOver={(e) => e.preventDefault()}\n                >\n                {sortedTokensLength > 1 && sortType === 'custom' && !isMobileScreen && <MdDragIndicator size={20} className='drag-handle' onClick={(e) => dragStart(e, index)} id={`${index}-handle`} />}\n                <div className=\"icon\">\n                    { \n                        failedImg.includes(logo) ?\n                            <GiToken size={20}/>\n                            :\n                            <img src={logo} draggable=\"false\" alt=\"Token Icon\" onError={() => setFailedImg(failed => [...failed, logo])}/>\n                    }\n                </div>\n                <div className=\"name\">\n                    { symbol.toUpperCase() }\n                </div>\n                <div className=\"separator\"></div>\n                <div className=\"balance\">\n                    <div className=\"currency\">\n                        <span className=\"value\" >{ formatFloatTokenAmount(balance, true, 4) }</span>\n                    </div>\n                    <div className=\"dollar\">\n                        <span className=\"symbol\">$</span> { balanceUSD.toFixed(2) }\n                    </div>\n                </div>\n                {\n                    send ? \n                        <div className=\"actions\">\n                            <NavLink to={{\n                                pathname: `/wallet/transfer/${address}`,\n                                state: {\n                                    gasTankMsg: 'Warning: You are about to top up your Gas Tank. Top ups to the Gas Tank are non-refundable.',\n                                    isTopUp: true\n                                }\n                            }}>\n                                <Button small>Top up</Button>\n                            </NavLink>\n                        </div>\n                        :\n                        null\n                }\n            </div>)\n        }\n\n    return (\n        <div id=\"gas-tank\">\n            <div className='heading-wrapper'>\n                <div className=\"balance-wrapper\" style={{ cursor: 'pointer' }} onClick={openGasTankBalanceByTokensModal}>\n                    <span><GiGasPump/> Balance on All Networks</span>\n                    { (!isLoading && gasTankBalances) ?\n                        (<div className={ (gasTankBalancesFormatted.length > 6)? 'inner-wrapper-left small-font' : 'inner-wrapper-left' } >\n                            <span>$ </span>{ gasTankBalancesFormatted }\n                        </div>) : \n                        <Loading /> }\n                    {/* TODO: Add functionality for drag and drop */}\n                    {/* <span>Drag and drop tokens here</span> */}\n                    <span>More details...</span>\n                </div>\n                <div className='switch-wrapper'>\n                    <Toggle checked={currentAccGasTankState.isEnabled} onChange={() => toggleGasTank()}/>\n                    {currentAccGasTankState.isEnabled ? <span>Enabled</span> : <span>Disabled</span>}\n                </div>\n\n                <div className=\"balance-wrapper total-save\">\n                    <div className='inner-wrapper-right'>\n                        <div className='label green'>Total Saved: </div> \n                        <div className='amount'><span>$</span> {totalSaved ? totalSaved : '0.00'}</div>\n                    </div>\n                    <div className='inner-wrapper-right'>\n                        <div className='label'>Total Cashback: </div> \n                        <div className='amount'><span>$</span> {totalCashBack ? totalCashBack : '0.00'}</div>\n                    </div>\n                    <span>From transaction fees on {network.id.toUpperCase()}</span>\n                </div>\n            </div>\n            <div>\n                <p className='benefit'>Save over 20% of fees by enabling the gas tank</p>\n                <p>This is your special account for pre-paying transaction fees.</p>\n                <p>By filling up your Gas Tank, you are setting aside, or prepaying for network fees.</p>\n                <p>Only the tokens listed below are eligible for filling up your Gas Tank. You can add more tokens to your Gas Tank at any time.</p>\n                <p>The tokens in your Gas Tank can pay network fees on all supported networks.</p>\n            </div>\n            <div className=\"sort-holder\">\n                <span className='title'>Available fee tokens on {network.id.toUpperCase()}</span>\n                {sortedTokens && !isMobileScreen &&  (\n                    <div className=\"sort-buttons\">\n                        <ToolTip label='Sorted tokens by drag and drop'>\n                            <MdDragIndicator color={sortType === \"custom\" ? \"#80ffdb\" : \"\"} cursor=\"pointer\" onClick={() => setUserSorting(prev => ({\n                                ...prev,\n                                tokens: {\n                                    ...prev.tokens,\n                                    sortType: 'custom'\n                                }\n                            }))} />\n                        </ToolTip>\n                        <ToolTip label='Sorted tokens by DESC balance'>\n                            <MdOutlineSort color={sortType === \"decreasing\" ? \"#80ffdb\" : \"\"} cursor=\"pointer\" onClick={() => setUserSorting(prev => ({\n                                ...prev,\n                                tokens: {\n                                    ...prev.tokens,\n                                    sortType: 'decreasing'\n                                }\n                            }))} />\n                        </ToolTip>\n                    </div>\n                )}\n            </div>\n            <div className=\"list\">\n                { !isBalanceLoading ?\n                        sortedTokens && sortedTokens?.map(({ address, symbol, tokenImageUrl, balance, balanceUSD, network, decimals, icon }, i) =>\n                            tokenItem(\n                                i, \n                                tokenImageUrl = tokenImageUrl || icon, \n                                symbol, \n                                balance, \n                                balanceUSD, \n                                address, \n                                true, \n                                network, \n                                decimals, \n                                'tokens', \n                                sortedTokens.length\n                            ))\n                        : <Loading />  }\n            </div>\n            <div>\n                <NavLink to={{\n                    pathname: `/wallet/transfer/`,\n                    state: {\n                        gasTankMsg: 'Warning: You are about to top up your Gas Tank. Top ups to the Gas Tank are non-refundable.',\n                        isTopUp: true\n                    }\n                }}>\n                    <Button className='deposit-button' small>top up gas tank</Button>\n                </NavLink>\n            </div>\n            <span className='title'>Gas Tank top ups history on {network.id.toUpperCase()}</span>\n            <p className='warning-msg'>Warning: It will take some time to top up the Gas Tank after the transaction is signed.</p>\n            <div className=\"txns-wrapper\">\n                {\n                    gasTankFilledTxns && gasTankFilledTxns.length ? gasTankFilledTxns.map((item, key) => {\n                        const tokenDetails = feeAssetsRes && feeAssetsRes.length ? \n                            feeAssetsRes.find(({address, network}) => address.toLowerCase() === item.address.toLowerCase() && network === item.network) : null\n                        if (!tokenDetails) return null // txn to gas Tank with not eligible token\n                        return (\n                            <div key={key} className=\"txns-item-wrapper\">\n                                <div className='logo'><GiGasPump size={20} /></div>\n                                <div className='date'>{ item.submittedAt && toLocaleDateTime(new Date(item.submittedAt)).toString() }</div>\n                                <div className='balance'>\n                                    { tokenDetails && \n                                        (<>\n                                            <img width=\"25px\" height='25px' alt='logo' src={tokenDetails.icon || getTokenIcon(item.network, item.address)} /> \n                                            <div>{ tokenDetails.symbol.toUpperCase() }</div>\n                                            { tokenDetails && formatUnits(item.value.toString(), tokenDetails.decimals).toString() }\n                                        </>)\n                                    }\n                                </div>\n                                <div className='logo'>\n                                    <a\n                                        href={network.explorerUrl + '/tx/'+ item.txId}\n                                        target='_blank'\n                                        rel='noreferrer'\n                                        onClick={e => e.stopPropagation()}\n                                    >\n                                        <HiOutlineExternalLink size={20} />\n                                    </a>\n                                </div>\n                            </div>)\n                    }).filter(r => r) : <p>No top ups were made to Gas Tank on {network.id.toUpperCase()}</p>\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default GasTank\n","import './Gas.scss'\n\nimport GasDetails from './GasDetails/GasDetails'\nimport GasTank from './GasTank/GasTank'\nimport { useState, useEffect } from 'react'\nimport { useRelayerData } from 'hooks'\nimport { Loading } from 'components/common'\n\nconst Gas = ({ \n    selectedNetwork, \n    relayerURL, \n    portfolio, \n    selectedAccount, \n    userSorting, \n    setUserSorting, \n    gasTankState, \n    setGasTankState\n }) => {\n    const [cacheBreak, setCacheBreak] = useState(() => Date.now())\n\n    useEffect(() => {\n        if (Date.now() - cacheBreak > 5 * 1000) setCacheBreak(Date.now())\n        const intvl = setTimeout(() => setCacheBreak(Date.now()), 60 * 1000)\n        return () => clearTimeout(intvl)\n    }, [cacheBreak])\n\n    const url = relayerURL ? `${relayerURL}/gasPrice/${selectedNetwork.id}?cacheBreak=${cacheBreak}` : null\n    //TODO: To implement \"isLoading\" and \"errMsg\"\n    const { data, errMsg, isLoading } = useRelayerData({ url })\n    \n    const gasData = data ? data.data : null\n    \n    return (\n        <section id=\"gas\">\n            <div className=\"panel\">\n                <div className=\"heading\">\n                    <div className=\"title\">Current Network Fees</div>\n                </div>\n                <div className=\"description\">\n                    <p>Network fees are determined on a market principle - if more users are trying to use the network, fees are higher. Each network has different fees.</p>\n                    { gasData && !isLoading && <GasDetails gasData={gasData} />  }\n                    { isLoading && <Loading /> }\n                    { !gasData && errMsg && (\n                        <h3 className=\"error\">Gas Information: {errMsg}</h3>\n                    )}\n                </div>\n            </div>\n            \n                <div className=\"panel\">\n                    <div className=\"heading\">\n                        <div className=\"title\">Gas Tank</div>\n                    </div>\n                    <div className=\"description\">\n                    { selectedNetwork.isGasTankAvailable ?\n                        <GasTank\n                            network={selectedNetwork}\n                            relayerURL={relayerURL}\n                            portfolio={portfolio}\n                            account={selectedAccount}\n                            userSorting={userSorting}\n                            setUserSorting={setUserSorting}\n                            gasTankState={gasTankState}\n                            setGasTankState={setGasTankState}\n                        /> : \n                        <h3 className=\"error\">Gas Tank is not available on {selectedNetwork.id.toUpperCase()}</h3>\n                    }\n                    </div>\n                </div>\n            \n        </section>\n    )\n}\n\nexport default Gas\n","import objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export const GAS_SPEEDS: string[] = ['slow', 'medium', 'fast', 'ape']\n","// @ts-nocheck TODO: Fill in all missing types before enabling the TS check again\n// It costs around 19k to send a token, if that token was interacted with before in the same transaction,\n// because of SLOAD costs - they depend on whether a slot has been read\n// however, it costs 30k if the token has not been interacted with\n// we may decrease it a bit and lean on the relayer failsafe values (cfg.gasAddedOnEstimate) later on\nconst ADDED_GAS_TOKEN = 30000\nconst ADDED_GAS_NATIVE = 12000\n\nexport function getAddedGas(token) {\n  return !token?.address || token?.address === '0x0000000000000000000000000000000000000000'\n    ? ADDED_GAS_NATIVE\n    : ADDED_GAS_TOKEN\n}\n\n// can't think of a less funny name for that\nexport function getFeePaymentConsequences(token, estimation, isGasTankEnabled) {\n  // Relayerless mode\n  if (!estimation?.feeInUSD || !token) return { multiplier: 1, addedGas: 0 }\n  // Relayer mode\n  const addedGas = getAddedGas(token)\n  // If Gas Tank enabled\n  if (isGasTankEnabled) return { addedGas: 0, multiplier: 1 }\n\n  return {\n    // otherwise we get very long floating point numbers with trailing .999999\n    multiplier: parseFloat(((estimation.gasLimit + addedGas) / estimation.gasLimit).toFixed(4)),\n    addedGas\n  }\n}\n\n// Returns feeToken data with all multipliers applied\nexport function getFeesData(feeToken, estimation, speed, isGasTankEnabled, network) {\n  const { addedGas, multiplier } = getFeePaymentConsequences(feeToken, estimation, isGasTankEnabled)\n  const savedGas = getAddedGas(feeToken)\n  const discountMultiplier = 1 - (feeToken?.discount || 0)\n  const totalMultiplier = multiplier * discountMultiplier\n  const nativeRate = feeToken?.nativeRate || 1\n  const isCrossChainNativeSelected =\n    isGasTankEnabled &&\n    feeToken.address === '0x0000000000000000000000000000000000000000' &&\n    network.id !== feeToken.network\n  // eslint-disable-next-line no-nested-ternary\n  const feeInNative = estimation.customFee\n    ? (estimation.customFee * discountMultiplier) / nativeRate\n    : !isCrossChainNativeSelected\n    ? estimation.feeInNative[speed] * totalMultiplier\n    : (((estimation.feeInNative[speed] * totalMultiplier) / nativeRate) *\n        estimation.nativeAssetPriceInUSD) /\n      feeToken.price\n  // eslint-disable-next-line no-nested-ternary\n  const feeInUSD = !Number.isNaN(estimation.nativeAssetPriceInUSD)\n    ? !isCrossChainNativeSelected\n      ? feeInNative * estimation.nativeAssetPriceInUSD\n      : feeInNative * feeToken.price\n    : undefined\n  const feeInFeeToken = feeInNative * nativeRate\n\n  return {\n    feeInNative,\n    feeInUSD,\n    feeInFeeToken,\n    addedGas, // use it bundle data\n    savedGas\n  }\n}\nexport function isTokenEligible(token, speed, estimation, isGasTankEnabled, network) {\n  if (estimation?.relayerless && token?.address === '0x0000000000000000000000000000000000000000')\n    return true\n  if (!token) return false\n  const { feeInFeeToken } = getFeesData(token, estimation, speed, isGasTankEnabled, network)\n  const balanceInFeeToken = parseInt(token.balance) / 10 ** token.decimals\n  return balanceInFeeToken > feeInFeeToken\n}\n\nconst contractErrors = [\n  'caller is a contract',\n  'contract not allowed',\n  'contract not supported',\n  'No contractz allowed',\n  /* no */ 'contracts allowed',\n  /* c or C */ 'ontract is not allowed'\n]\n\nexport function mapTxnErrMsg(msg: any) {\n  if (!msg) return\n  if (msg.includes('Router: EXPIRED')) return 'Swap expired'\n  if (msg.includes('Router: INSUFFICIENT_OUTPUT_AMOUNT'))\n    return 'Swap will suffer slippage higher than your requirements'\n  if (msg.includes('INSUFFICIENT_PRIVILEGE')) return 'Your signer address is not authorized.'\n  if (contractErrors.find((contractMsg) => msg.includes(contractMsg)))\n    return 'This dApp does not support smart wallets.'\n  return msg\n}\n\nexport function getErrHint(msg: any) {\n  if (!msg) return\n  if (msg.includes('Router: EXPIRED')) return 'Try performing the swap again'\n  if (msg.includes('Router: INSUFFICIENT_OUTPUT_AMOUNT'))\n    return 'Try performing the swap again or increase your slippage requirements'\n  if (msg.includes('INSUFFICIENT_PRIVILEGE'))\n    return 'If you set a new signer for this account, try re-adding the account.'\n  if (contractErrors.find((contractMsg) => msg.includes(contractMsg)))\n    return 'Contact the dApp developers to tell them to implement smart wallet support by not blocking contract interactions and/or implementing EIP1271.'\n  return 'Sending this transaction batch would have resulted in an error, so we prevented it.'\n}\n\nexport function toHexAmount(amnt: any, decimals: any) {\n  return `0x${Math.round(amnt * 10 ** decimals).toString(16)}`\n}\n\nexport function getDiscountApplied(amnt: any, discount = 0) {\n  if (!discount) return 0\n  if (!amnt) return 0\n  if (discount === 1) return amnt\n  return (amnt / (1 - discount)) * discount\n}\n","// @ts-nocheck TODO: Fill in all missing types before enabling the TS check again\nimport ERC20ABI from 'adex-protocol-eth/abi/ERC20.json'\nimport { BigNumber } from 'ethers'\nimport { Interface } from 'ethers/lib/utils'\n\nimport accountPresets from '../../constants/accountPresets'\n\nconst ERC20AbiInterface = new Interface(ERC20ABI)\nconst TRANSFER_SIGHASH = ERC20AbiInterface.getSighash(\n  ERC20AbiInterface.getFunction('transfer').format()\n)\nconst feeCollector = accountPresets.feeCollector\nconst NATIVE_ADDRESS = '0x0000000000000000000000000000000000000000'\n\nfunction getTxnTransferInfo(txn) {\n  try {\n    const res = ERC20AbiInterface.decodeFunctionData('transfer', txn)\n\n    return {\n      value: BigNumber.from(res._value),\n      ...res\n    }\n  } catch (e) {\n    console.error(e)\n    return {}\n  }\n}\n\nfunction isFeeCollectorTxn(txn) {\n  // is first call is to relayer this is native\n  if (txn[0] === feeCollector) return true\n  // transfer token to relayer\n  if (txn[2].startsWith(TRANSFER_SIGHASH) && getTxnTransferInfo(txn[2])._to === feeCollector)\n    return true\n  return false\n}\n\nconst getGasTankFilledTxns = (transactions) => {\n  const depositTxns: any = []\n  transactions.forEach(({ txId, txns, submittedAt, gasTankFee, identity, ...rest }) => {\n    const filteredTxns = txns\n      .filter((txnCall, i) => isFeeCollectorTxn(txnCall) && (gasTankFee || i < txns.length - 1))\n      .map((fillTxn) => {\n        if (fillTxn[0] === feeCollector) {\n          return {\n            submittedAt,\n            address: NATIVE_ADDRESS,\n            value: BigNumber.from(fillTxn[1]),\n            identity,\n            txId,\n            ...rest\n          }\n        }\n        if (\n          fillTxn[2].startsWith(TRANSFER_SIGHASH) &&\n          ERC20AbiInterface.decodeFunctionData('transfer', fillTxn[2])._to === feeCollector\n        ) {\n          return {\n            submittedAt,\n            address: fillTxn[0],\n            value: BigNumber.from(\n              ERC20AbiInterface.decodeFunctionData('transfer', fillTxn[2])._value\n            ),\n            identity,\n            txId,\n            ...rest\n          }\n        }\n        return null\n      })\n\n    if (filteredTxns.length) depositTxns.push(filteredTxns[0])\n  })\n\n  return depositTxns\n}\n\nexport { getGasTankFilledTxns }\n","import useGasTankData from './useGasTankData'\n\nexport default useGasTankData\n","import { formatUnits } from 'ethers/lib/utils'\nimport { useMemo } from 'react'\n\nimport { getAddedGas } from '../../helpers/sendTxnHelpers'\nimport { getGasTankFilledTxns } from '../../services/isFeeCollectorTxn'\nimport useCacheBreak from '../useCacheBreak'\nimport { UseGasTankDataProps, UseGasTankDataReturnType } from './types'\n\nexport default function useGasTankData({\n  relayerURL,\n  selectedAcc,\n  network,\n  portfolio,\n  useRelayerData\n}: UseGasTankDataProps): UseGasTankDataReturnType {\n  const { cacheBreak } = useCacheBreak()\n  const { tokens } = portfolio\n\n  const urlGetBalance = relayerURL\n    ? `${relayerURL}/gas-tank/${selectedAcc}/getBalance?cacheBreak=${cacheBreak}`\n    : null\n  const urlGetFeeAssets = relayerURL\n    ? `${relayerURL}/gas-tank/assets?cacheBreak=${cacheBreak}`\n    : null\n  const urlGetTransactions = relayerURL\n    ? `${relayerURL}/identity/${selectedAcc}/${network?.id}/transactions`\n    : null\n\n  const { data: balancesRes, isLoading } = useRelayerData({ url: urlGetBalance })\n  const { data: feeAssetsRes } = useRelayerData({ url: urlGetFeeAssets })\n  const { data: executedTxnsRes } = useRelayerData({ url: urlGetTransactions })\n\n  const gasTankBalances = useMemo(\n    () =>\n      balancesRes &&\n      balancesRes.length &&\n      balancesRes.map(({ balanceInUSD }: any) => balanceInUSD).reduce((a: any, b: any) => a + b, 0),\n    [balancesRes]\n  )\n\n  const gasTankTxns = useMemo(\n    () =>\n      executedTxnsRes &&\n      executedTxnsRes.txns.length &&\n      executedTxnsRes.txns.filter((item: any) => !!item.gasTankFee),\n    [executedTxnsRes]\n  )\n\n  const feeAssetsPerNetwork = useMemo(\n    () =>\n      feeAssetsRes &&\n      feeAssetsRes.length &&\n      feeAssetsRes.filter((item: any) => item.network === network?.id),\n    [feeAssetsRes, network?.id]\n  )\n\n  const executedTxns = executedTxnsRes && executedTxnsRes.txns.length && executedTxnsRes.txns\n  const gasTankFilledTxns = useMemo(\n    () => executedTxns && executedTxns.length && getGasTankFilledTxns(executedTxns),\n    [executedTxns]\n  )\n\n  const availableFeeAssets = useMemo(\n    () =>\n      feeAssetsPerNetwork?.map((item: any) => {\n        const isFound = tokens?.find((x) => x.address.toLowerCase() === item.address.toLowerCase())\n        if (isFound)\n          return {\n            ...isFound,\n            tokenImageUrl: item.icon,\n            decimals: item.decimals,\n            symbol: item.symbol,\n            balance: isFound.balance,\n            disableGasTankDeposit: !!item.disableGasTankDeposit,\n            balanceUSD:\n              parseFloat(isFound.balance) *\n              parseFloat(\n                feeAssetsPerNetwork.find(\n                  (x: any) => x.address.toLowerCase() === isFound.address.toLowerCase()\n                ).price || 0\n              )\n          }\n\n        return {\n          ...item,\n          tokenImageUrl: item.icon,\n          balance: 0,\n          balanceUSD: 0,\n          decimals: 0,\n          address: item.address.toLowerCase(),\n          symbol: item.symbol.toUpperCase()\n        }\n      }),\n    [feeAssetsPerNetwork, tokens]\n  )\n\n  const totalSavedResult = useMemo(\n    () =>\n      gasTankTxns &&\n      gasTankTxns.length &&\n      gasTankTxns.map((item: any) => {\n        const feeTokenDetails = feeAssetsRes\n          ? feeAssetsRes.find((i: any) => i.symbol === item.feeToken)\n          : null\n        const savedGas = feeTokenDetails ? getAddedGas(feeTokenDetails) : null\n        return {\n          saved: savedGas ? item.feeInUSDPerGas * savedGas : 0.0,\n          cashback:\n            item.gasTankFee && item.gasTankFee.cashback\n              ? // @ts-ignore FIXME: Figure out why TypeScript complains\n                formatUnits(\n                  item.gasTankFee.cashback.toString(),\n                  feeTokenDetails?.decimals\n                ).toString() * feeTokenDetails?.price\n              : 0.0\n        }\n      }),\n    [feeAssetsRes, gasTankTxns]\n  )\n\n  return {\n    balancesRes,\n    gasTankBalances,\n    isLoading,\n    gasTankTxns,\n    feeAssetsRes,\n    gasTankFilledTxns,\n    totalSavedResult,\n    availableFeeAssets\n  }\n}\n"],"sourceRoot":""}