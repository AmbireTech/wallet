(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[13],{1557:function(e,t,n){},1558:function(e,t,n){},1559:function(e,t,n){},1560:function(e,t,n){},1561:function(e,t,n){},1562:function(e,t,n){},1563:function(e,t,n){},1564:function(e,t,n){},1638:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return H}));var a=n(7),c=(n(1557),n(3)),s=n(30),r=n(77),i=(n(1558),n(34)),o=n(229),l=n(60),d=n(4),u=function(e){var t=e.portfolio,n=e.selectedNetwork,c=e.setNetwork,u=e.hidePrivateValue,b=e.relayerURL,j=e.selectedAccount,m=(e.match,Object(s.useHistory)()),f=function(e){return l.a.find((function(t){return t.id===e}))},h=t.otherBalances.filter((function(e){var t=e.network,a=e.total;return t!==n.id&&a.full>0})),p=Object.entries(t.balancesByNetworksLoading).find((function(e){return e[0]!==n.id&&e[1]})),O=b?"".concat(b,"/gas-tank/").concat(j,"/getBalance"):null,v=Object(i.j)({url:O}),g=v.data,x=v.isLoading,y=g&&g.length&&g.map((function(e){return e.balanceInUSD})).reduce((function(e,t){return e+t}),0),k=y?Number(y.toString()).toFixed(2).split("."):[0,0],w=Object(a.a)(k,2),N=w[0],T={label:"Gas Tank",total:{full:y||0,decimals:w[1],truncated:N}};return Object(d.jsx)("div",{id:"balances",children:t.isCurrNetworkBalanceLoading&&p?Object(d.jsx)(r.m,{}):Object(d.jsxs)(d.Fragment,{children:[t.isCurrNetworkBalanceLoading?Object(d.jsx)(r.m,{}):Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"green-highlight",children:"$"})," ",u(t.balance.total.truncated),Object(d.jsxs)("span",{className:"green-highlight",children:[".",u(t.balance.total.decimals)]})]}),Object(d.jsx)("div",{id:"other-balances",children:p?Object(d.jsx)(r.m,{}):Object(d.jsxs)(d.Fragment,{children:[h.length?Object(d.jsx)("label",{children:"You also have"}):null,h.filter((function(e){var t=e.network;return f(t)})).map((function(e,t){var n=e.network,a=e.total;return Object(d.jsxs)("div",{className:"balance-container",children:[Object(d.jsxs)("div",{className:"other-balance",onClick:function(){return c(n)},children:[Object(d.jsxs)("label",{children:[Object(d.jsx)("span",{className:"purple-highlight",children:"$"})," ",u(a.truncated),Object(d.jsxs)("span",{className:"purple-highlight",children:[".",u(a.decimals)]})]}),"on",Object(d.jsxs)("div",{className:"network",children:[Object(d.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(f(n).icon,")")}}),Object(d.jsx)("div",{className:"name",children:f(n).name})]})]}),h.length-(T.total.full>0?0:1)!==t?Object(d.jsx)("label",{children:"and"}):null]},n)})),T&&T.total.full>0&&!x&&Object(d.jsx)("div",{className:"balance-container",children:Object(d.jsxs)("div",{className:"other-balance",onClick:function(){return m.push("/wallet/gas-tank")},children:[Object(d.jsxs)("label",{children:[Object(d.jsx)("span",{className:"purple-highlight",children:"$"})," ",u(T.total.truncated),Object(d.jsxs)("span",{className:"purple-highlight",children:[".",u(T.total.decimals)]})]}),"on",Object(d.jsxs)("div",{className:"network",children:[Object(d.jsx)("div",{className:"icon-svg",children:Object(d.jsx)(o.a,{size:20})}),Object(d.jsx)("div",{className:"name",children:T.label})]})]})})]})})]})})},b=n(17),j=n(12),m=n(8),f=(n(1559),n(228)),h=n(69),p=(n(1560),n(37)),O=function(e){var t=e.onClickAddToken,n=e.onClickShowToken,a=Object(i.e)({key:"hiddenTokens"}),c=0;return a&&null!==a[0]&&(c=a[0].length),Object(d.jsxs)("div",{id:"protocols-placeholder",children:[Object(d.jsxs)("div",{className:"placeholder-overlay",children:[Object(d.jsx)("label",{children:"Welcome! You don't have any funds on this account."}),Object(d.jsx)(h.c,{to:"/wallet/deposit",children:Object(d.jsx)(r.e,{small:!0,icon:Object(d.jsx)(o.c,{}),children:"Deposit"})}),Object(d.jsxs)("div",{className:"add-token",children:[Object(d.jsx)("label",{children:"You have a token that's not displayed?"}),Object(d.jsx)(r.e,{mini:!0,clear:!0,icon:Object(d.jsx)(p.C,{}),onClick:t,children:"Click here to add it"}),c>0&&Object(d.jsxs)("label",{style:{cursor:"pointer"},onClick:n,children:["There are also ",c," hidden tokens. Click to configure"]})]})]}),Object(d.jsxs)("div",{className:"category",children:[Object(d.jsx)("div",{className:"title",children:"Tokens"}),Object(d.jsx)("div",{className:"list",children:[{icon:"https://storage.googleapis.com/zapper-fi-assets/tokens/ethereum/0xade00c28244d5ce17d72e40330b1c318cd12b7c3.png",symbol:"ADX",balance:170027.26,balanceUSD:138880.64},{icon:"https://storage.googleapis.com/zapper-fi-assets/tokens/ethereum/0x0000000000000000000000000000000000000000.png",symbol:"ETH",balance:61.77,balanceUSD:283170.08},{icon:"https://storage.googleapis.com/zapper-fi-assets/tokens/ethereum/0x2260fac5e5542a773aa44fbcfedf7c193bc2c599.png",symbol:"WBTC",balance:.03,balanceUSD:2227.24}].map((function(e){var t=e.icon,n=e.symbol,a=e.balance,c=e.balanceUSD;return Object(d.jsxs)("div",{className:"token",children:[Object(d.jsx)("div",{className:"icon",children:Object(d.jsx)("img",{src:t,alt:"Token Icon"})}),Object(d.jsx)("div",{className:"name",children:n}),Object(d.jsx)("div",{className:"separator"}),Object(d.jsxs)("div",{className:"balance",children:[Object(d.jsxs)("div",{className:"currency",children:[a," ",Object(d.jsx)("span",{className:"symbol",children:n})]}),Object(d.jsxs)("div",{className:"dollar",children:[Object(d.jsx)("span",{className:"symbol",children:"$"})," ",c]})]})]},n)}))})]})]})},v=n(657),g=n(663),x=n(596),y=n(604),k=function(e){var t,n=e.portfolio,s=e.network,l=e.account,u=e.hidePrivateValue,k=e.userSorting,w=e.setUserSorting,N=Object(i.f)().showModal,T=Object(c.useState)([]),S=Object(a.a)(T,2),C=S[0],A=S[1],M=Object(c.useState)(!1),E=Object(a.a)(M,2),P=E[0],F=E[1],R=n.isCurrNetworkBalanceLoading,I=n.isCurrNetworkProtocolsLoading,B=n.tokens,U=n.protocols,L=(null===(t=k.tokens)||void 0===t?void 0:t.sortType)||"decreasing",D=Object(i.c)(),_=Object(i.d)("address",(function(e){w((function(t){var n;return Object(m.a)(Object(m.a)({},t),{},{tokens:{sortType:"custom",items:Object(m.a)(Object(m.a)({},null===(n=t.tokens)||void 0===n?void 0:n.items),{},Object(j.a)({},"".concat(l,"-").concat(s.chainId),e))}})}))})),W=_.dragStart,H=_.dragEnter,z=_.target,q=_.handle,Y=_.dragTarget,G=_.drop,V=B.sort((function(e,t){var n,a,c;if("custom"===L&&(null===(n=k.tokens)||void 0===n||null===(a=n.items)||void 0===a||null===(c=a["".concat(l,"-").concat(s.chainId)])||void 0===c?void 0:c.length))return k.tokens.items["".concat(l,"-").concat(s.chainId)].indexOf(e.address)-k.tokens.items["".concat(l,"-").concat(s.chainId)].indexOf(t.address);var r=t.balanceUSD-e.balanceUSD;return 0===r?e.symbol.localeCompare(t.symbol):r})),J=U.filter((function(e){return"Tokens"!==e.label})),K=!R&&!B.length&&!I&&!J.length,X=function(e,t,n,a,c,s){var i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7?arguments[7]:void 0,j=arguments.length>8?arguments[8]:void 0,m=arguments.length>9?arguments[9]:void 0,O=arguments.length>10?arguments[10]:void 0,v=C.includes(t)?Object(x.a)(l,s):t;return Object(d.jsxs)("div",{className:"token",draggable:"tokens"===m&&O>1&&"custom"===L&&!D,onDragStart:function(t){q.current===z.current||q.current.contains(z.current)?W(t,e):t.preventDefault()},onMouseDown:function(t){return Y(t,e)},onDragEnter:function(t){return H(t,e)},onDragEnd:function(){return G(V)},onDragOver:function(e){return e.preventDefault()},children:[O>1&&"custom"===L&&!D&&Object(d.jsx)(p.n,{size:20,className:"drag-handle",onClick:function(t){return W(t,e)},id:"".concat(e,"-handle")}),Object(d.jsx)("div",{className:"icon",children:C.includes(v)?Object(d.jsx)(o.d,{size:20}):Object(d.jsx)("img",{src:v,draggable:"false",alt:"Token Icon",onError:function(){return A((function(e){return[].concat(Object(b.a)(e),[v])}))}})}),Object(d.jsx)("div",{className:"name",children:n}),Object(d.jsx)("div",{className:"separator"}),Object(d.jsxs)("div",{className:"balance",children:[Object(d.jsxs)("div",{className:"currency",children:[Object(d.jsx)("span",{className:"value",children:u(Object(y.a)(a,!0,j))}),Object(d.jsx)("span",{className:"symbol",children:n})]}),Object(d.jsxs)("div",{className:"dollar",children:[Object(d.jsx)("span",{className:"symbol",children:"$"})," ",u(c.toFixed(2))]})]}),i?Object(d.jsx)("div",{className:"actions",children:Object(d.jsx)(h.c,{to:"/wallet/transfer/".concat(s),children:Object(d.jsx)(r.e,{small:!0,icon:Object(d.jsx)(f.i,{}),children:"Send"})})}):null]},"token-".concat(s,"-").concat(e))},Z=Object(c.useCallback)((function(){return N(Object(d.jsx)(v.a,{network:s,account:l,portfolio:n}))}),[l,s,n,N]),$=Object(c.useCallback)((function(){return F(!0)}),[]);return Object(c.useEffect)((function(){P&&N(Object(d.jsx)(g.a,{portfolio:n,account:l,userSorting:k,sortType:L,network:s,setIsHideTokenModalOpen:F}))}),[n,P,N,l,s,L,k]),Object(d.jsxs)("div",{id:"protocols-table",children:[K?Object(d.jsx)(O,{onClickAddToken:Z,onClickShowToken:$}):null,Object(d.jsxs)(d.Fragment,{children:[R?Object(d.jsx)(r.m,{}):!K&&V.length?Object(d.jsxs)("div",{className:"category",children:[Object(d.jsxs)("div",{className:"title",children:[Object(d.jsxs)("div",{className:"sort-holder",children:["Tokens",V.length>1&&!D&&Object(d.jsxs)("div",{className:"sort-buttons",children:[Object(d.jsx)(r.y,{label:"Sorted tokens by drag and drop",children:Object(d.jsx)(p.n,{color:"custom"===L?"#80ffdb":"",cursor:"pointer",onClick:function(){return w((function(e){return Object(m.a)(Object(m.a)({},e),{},{tokens:Object(m.a)(Object(m.a)({},e.tokens),{},{sortType:"custom"})})}))}})}),Object(d.jsx)(r.y,{label:"Sorted tokens by DESC balance",children:Object(d.jsx)(p.W,{color:"decreasing"===L?"#80ffdb":"",cursor:"pointer",onClick:function(){return w((function(e){return Object(m.a)(Object(m.a)({},e),{},{tokens:Object(m.a)(Object(m.a)({},e.tokens),{},{sortType:"decreasing"})})}))}})})]})]}),Object(d.jsxs)("div",{className:"wrapper-btns",children:[Object(d.jsx)(r.e,{mini:!0,clear:!0,icon:Object(d.jsx)(p.cb,{}),onClick:function(){return $()},children:"Hide Token"}),Object(d.jsx)(r.e,{mini:!0,clear:!0,icon:Object(d.jsx)(p.C,{}),onClick:function(){return Z()},children:"Add Token"})]})]}),Object(d.jsx)("div",{className:"list",children:V.map((function(e,t){var n=e.address,a=e.symbol,c=e.tokenImageUrl,s=e.balance,r=e.balanceUSD,i=e.network,o=e.decimals;return X(t,c,a,s,r,n,!0,i,o,"tokens",V.length)}))})]},"category-tokens"):null,I?Object(d.jsx)(r.m,{}):J.map((function(e,t){var n=e.label,a=e.assets;return Object(d.jsxs)("div",{className:"category",children:[Object(d.jsx)("div",{className:"title",children:n}),Object(d.jsx)("div",{className:"list",children:a.map((function(e,t){var n=e.category,a=e.symbol,c=e.tokenImageUrl,s=e.balance,r=e.balanceUSD,i=e.address;return X(t,c,a,s,r,i,"claimable"!==n,"protocols")}))})]},"category-".concat(t))}))]})]})},w=(n(1561),n(1562),function(e){var t=e.isPrivateMode,n=e.collectiblesLength;return Object(d.jsxs)("div",{id:"collectibles-placeholder",children:[Object(d.jsx)("div",{className:"placeholder-text",children:t&&n?"You can't see collectibles in private mode":"You don't have any collectibles (NFTs) yet"}),Object(d.jsx)("div",{className:"placeholder-overlay"}),Object(d.jsx)("div",{id:"collectibles",children:Object(d.jsx)("div",{className:"collectibles-wrapper",children:[{collectionName:"Party Bone",collectionImg:"https://lh3.googleusercontent.com/ZNc-hDBHOxgioSltBcDvh5hBfWEj623dETJj2nrEC0cLbjuULbo4Ign7OnLDX9qf2XaALrkXsZCRylRqPPHqQgzJOabJg4TRq3MDhA=s2500",name:"Party Bone #7865",image:"https://lh3.googleusercontent.com/uznp2aNVNPEhVk4MhLG2Zn-JC2sVaF6PsUcpF_CpyQkgekmv4hh4zbyebsoLFLvkY8PSV6D-TR5OaMp15RhG9zQsYd_AvDCo9SEVF4Q",price:32.16},{collectionName:"Pudgy Penguins",collectionImg:"https://lh3.googleusercontent.com/L9PJp0pOXCscKsTpD1_6zoALxdjG5gIKHLykS_Wk5J_yk590drEqRhM1ElTEZCaWeTjFj2isfxFw2tcFKcbCPlu6-Eu5bUuxsL-x=s2500",name:"Pudgy Penguin #8675",image:"https://lh3.googleusercontent.com/J6gQQRnzsMLAOhYiN9qIhogxr2MKn17zfGf6nQFKr3WCZ34thm6H0w9izvnJysxJclsyr8c3yo0hshOaLU73aS-IgTm-CooJb1cw1S0",price:5675},{collectionName:"Art Blocks Factory",collectionImg:"https://lh3.googleusercontent.com/sr7Y19-bJwsQsxX6n8Pj5tIaNKdUEotNlfhBsYw8McKpIsYARglTORaNlGhDZ2PrH-tO1vU6tFbpamiWwIImbidhVSh4aoIh4d310Og=s2500",name:"Transitions #4267",image:"https://lh3.googleusercontent.com/9MzvH_PSYMvlJE8Cfm5d308ltY5fZx-dooEcQizKgtKZ8g05RvJvd_5LAbqVHIzaoZbM-HOBgNSV8RKvEe_1thkLcQtE4NMMx8Kp5g",price:263.46},{collectionName:"Sad Frogs District",collectionImg:"https://lh3.googleusercontent.com/3U8N73XLrQOQPhJBAMNi7IPR1y3GGJ2zxmyUlit4IHCJURmKFPWClgatjbYfyz9drMk6-XSQTjSFqn7tKL0ZNoRbgvUu8OdLVREA=s2500",name:"1882",image:"https://lh3.googleusercontent.com/3uwrfkdhHSfWm171BOjJHp3768tbLP9TeyTh2BnvgF6S1nIRI489SFq6EGjI9AISRUeyXXufEjB34Wj0bif_vl-y5h6GesEoJaaZcJg",price:1563.59},{collectionName:"GLUEWAVE",collectionImg:"https://lh3.googleusercontent.com/LheZMF6AyTLPpfwABwAGZqoC0gTWrDlYloDdT2VX2u_GZRZnP-ZpDC90huElm3RXE-eU1d1YluQi8G1uVdeDdysUNLZWJte4jXk3zeY=s2500",name:"000105040307070704",image:"https://lh3.googleusercontent.com/eP_F_6aa_BXuKfYq1w2aiS6UW3bp4-gByFoeKLMXYuWAkU6Xiyi7mkm31aoewCZ_eG9RAuhas8jxFwXTxAWuxq1E3ZxYg97cLUUE",price:7107.27}].map((function(e){var t=e.collectionName,n=e.collectionImg,a=e.name,c=e.image,s=e.price;return Object(d.jsxs)("div",{className:"collectible",children:[Object(d.jsx)("div",{className:"artwork",style:{backgroundImage:"url(".concat(c,")")}}),Object(d.jsxs)("div",{className:"info",children:[Object(d.jsxs)("div",{className:"collection",children:[Object(d.jsx)("div",{className:"collection-icon",style:{backgroundImage:"url(".concat(n,")")}}),t]}),Object(d.jsxs)("div",{className:"details",children:[Object(d.jsx)("div",{className:"name",children:a}),Object(d.jsxs)("div",{className:"value",children:[Object(d.jsx)("span",{className:"purple-highlight",children:"$"})," ",s]})]})]})]},a)}))})})]})}),N=n(809),T=n(616),S=function(e){var t=e.portfolio,n=e.isPrivateMode,s=Object(N.useParams)(),i=Object(N.useHistory)(),o=Math.ceil(t.collectibles.length/15),l=Object(c.useMemo)((function(){return Math.min(Math.max(Number(s.page),1),o)||1}),[s.page,o]),u=Object(c.useState)(l),b=Object(a.a)(u,2),j=b[0],m=b[1],f=t.collectibles.slice(15*(j-1),15*j),p=Object(d.jsxs)("div",{className:"pagination-controls",children:[Object(d.jsx)("div",{className:"pagination-title",children:"Page"}),Object(d.jsx)(r.e,{clear:!0,mini:!0,onClick:function(){return j>1&&m((function(e){return e-1}))},children:Object(d.jsx)(T.a,{})}),Object(d.jsxs)("div",{className:"pagination-current",children:[j," ",Object(d.jsxs)("span",{children:["/ ",o]})]}),Object(d.jsx)(r.e,{clear:!0,mini:!0,onClick:function(){return j<o&&m((function(e){return e+1}))},children:Object(d.jsx)(T.b,{})})]});Object(c.useEffect)((function(){return i.replace("/wallet/dashboard/collectibles/".concat(j))}),[j,i]),Object(c.useEffect)((function(){return m(l)}),[l]);return t.isCurrNetworkProtocolsLoading?Object(d.jsx)(r.m,{}):!t.collectibles.length||n?Object(d.jsx)(w,{isPrivateMode:n,collectiblesLength:t.collectibles.length}):Object(d.jsxs)("div",{id:"collectibles",children:[Object(d.jsx)("div",{className:"collectibles-wrapper",children:f.map((function(e){var t=e.network,n=e.address,a=e.collectionName,c=e.collectionImg;return(e.assets||[]).map((function(e){var s,r=e.tokenId,i=e.assetName,o=e.assetImg,l=e.balanceUSD;return Object(d.jsx)("div",{className:"collectible",children:Object(d.jsxs)(h.c,{to:"/wallet/nft/".concat(t,"/").concat(n,"/").concat(r),children:[Object(d.jsx)("div",{className:"artwork",style:{backgroundImage:"url(".concat((s=o,s?"data:image"===(s=s.startsWith("data:application/json")?s.replace("data:application/json;utf8,",""):s).split("/")[0]?s:s.startsWith("ipfs://")?s.replace(/ipfs:\/\/ipfs\/|ipfs:\/\//g,"https://ipfs.io/ipfs/"):s.split("/")[2].endsWith("mypinata.cloud")?"https://ipfs.io/ipfs/"+s.split("/").slice(4).join("/"):s:""),")")}}),Object(d.jsxs)("div",{className:"info",children:[Object(d.jsxs)("div",{className:"collection",children:[Object(d.jsx)("div",{className:"collection-icon",style:{backgroundImage:"url(".concat(c,")")}}),Object(d.jsx)("span",{className:"collection-name",children:a})]}),Object(d.jsxs)("div",{className:"details",children:[Object(d.jsx)("div",{className:"name",children:i}),Object(d.jsxs)("div",{className:"value",children:[Object(d.jsx)("span",{className:"purple-highlight",children:"$"})," ",l.toFixed(2)]})]})]})]})},r)}))}))}),p]})},C=n(636),A=(n(1563),n(1564),n(957));function M(e){return e<10?"0".concat(e):"".concat(e)}function E(e){var t=e.endDateTime,n=e.label,s=Object(c.useState)(null),r=Object(a.a)(s,2),i=r[0],o=r[1];return Object(c.useLayoutEffect)((function(){if(t){var e=setInterval((function(){var n=new Date(t).getTime()-(new Date).getTime();o(function(e){return e<0?{days:"00",hours:"00",minutes:"00",seconds:"00"}:{days:M(Math.floor(e/864e5)),hours:M(Math.floor(e/36e5%24)),minutes:M(Math.floor(e/1e3/60%60)),seconds:M(Math.floor(e/1e3%60))}}(n)),n<0&&(clearInterval(e),e=null)}),1e3);return function(){clearInterval(e),e=null}}o(null)}),[t]),i?Object(d.jsxs)("div",{children:[n&&Object(d.jsx)("span",{children:n}),Object(d.jsxs)("div",{className:"final-countdown",children:[Object(d.jsx)(A.b,{className:"timer-icon"}),Object(d.jsxs)("div",{className:"unit-box",children:[Object(d.jsx)("div",{className:"value",children:i.days}),Object(d.jsx)("div",{className:"unit",children:"days"})]}),Object(d.jsx)("div",{className:"value",children:":"}),Object(d.jsxs)("div",{className:"unit-box",children:[Object(d.jsx)("div",{className:"value",children:i.hours}),Object(d.jsx)("div",{className:"unit",children:"hours"})]}),Object(d.jsx)("div",{className:"value",children:":"}),Object(d.jsxs)("div",{className:"unit-box",children:[Object(d.jsx)("div",{className:"value",children:i.minutes}),Object(d.jsx)("div",{className:"unit",children:"minutes"})]}),Object(d.jsx)("div",{className:"value",children:":"}),Object(d.jsxs)("div",{className:"unit-box",children:[Object(d.jsx)("div",{className:"value",children:i.seconds}),Object(d.jsx)("div",{className:"unit",children:"seconds"})]})]})]}):null}var P=n(241),F=["emojies","color","background"];function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.period,c=e.text,s=e.title,r=e.resources,i=void 0===r?{}:r,o=e.togglePromo,l=e.minimized;if(!c)return null;var u=new RegExp(/\${{(\w+)}}/,"gi"),b=c.split(u),j=i.emojies,h=i.color,O=i.background,v=Object(C.a)(i,F),g=Object.entries(v).reduce((function(e,t){var n=Object(a.a)(t,2),c=n[0],s=n[1],r=(s=void 0===s?{}:s).label,i=s.href,o=Object(d.jsx)("a",{className:"link",href:i,target:"_blank",rel:"noreferrer noopener",children:r},c);return e[c]=o,e}),{}),x=Object.entries(Object(m.a)({},j)).reduce((function(e,t){var n=Object(a.a)(t,2),c=n[0],s=n[1],r=(s=void 0===s?{}:s).text,i=s.size,o=Object(d.jsx)("span",{className:"emoji",style:{fontSize:i},children:r},c);return e[c]=o,e}),{});return Object(d.jsxs)("div",{className:"notice ".concat(l?"minimized":""),style:Object(m.a)(Object(m.a)({},O?{backgroundColor:O}:{}),h?{color:h}:{}),children:[!l&&Object(d.jsxs)("div",{children:[s&&Object(d.jsx)("div",{className:"title",children:s}),Object(d.jsx)("div",{children:b.map((function(e){return g[e]||x[e]||e}))}),(null===n||void 0===n?void 0:n.to)&&(null===n||void 0===n?void 0:n.timer)&&Object(d.jsx)("div",{className:"timer",children:Object(d.jsx)(E,{endDateTime:n.to})})]}),t?l?Object(d.jsx)(p.O,{className:"close-btn",onClick:function(){return o(t)}}):Object(d.jsx)("div",{children:Object(d.jsx)(f.h,{className:"close-btn",onClick:function(){return o(t)}})}):null]})}function I(e){var t=e.rewardsData.rewards.promo,n=Object(P.a)({key:"closedPromos",defaultValue:[]}),s=Object(a.a)(n,2),r=s[0],i=s[1],o=Object(c.useCallback)((function(e){var t=Object(b.a)(r),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e),i(t)}),[r,i]);return t?Object(d.jsx)(R,Object(m.a)(Object(m.a)({},t),{},{togglePromo:o,minimized:r.includes(t.id)})):null}var B=n(812),U=n(810),L=n(21);var D=function(e){var t=e.selectedAccount,n=e.selectedNetwork;return Object(d.jsxs)("div",{className:"notification-hollow warning",children:[Object(d.jsx)("h4",{children:"Dashboard balances could appear incomplete or outdated."}),Object(d.jsxs)("p",{children:["We are currently experiencing technical difficulties with our third party services, so what you see on the dashboard may be incomplete or outdated. You can check ",Object(d.jsx)("a",{href:n.explorerUrl+"/address/"+t,target:"_blank",rel:"noreferrer",children:n.explorerUrl.split("/")[2]})," to see your current balances. However, you can use Ambire normally with any connected dApp."]})]})},_=[{value:"Tokens"},{value:"Protocols"}],W=[{value:"tokens"},{value:"collectibles"}];function H(e){var t=e.portfolio,n=e.selectedNetwork,o=e.selectedAccount,l=e.setNetwork,b=e.privateMode,j=e.rewardsData,f=e.userSorting,h=e.setUserSorting,O=e.accounts,v=e.addRequest,g=e.relayerURL,x=e.useStorage,y=e.match,w=e.showSendTxns,N=Object(s.useHistory)(),T=Object(s.useParams)(),C=T.tabId,A=T.page,M=void 0===A?1:A,E=Object(c.useState)([]),P=Object(a.a)(E,2),F=P[0],R=P[1],H=Object(c.useState)([]),z=Object(a.a)(H,2),q=z[0],Y=z[1],G=Object(c.useState)([]),V=Object(a.a)(G,2),J=V[0],K=V[1],X=Object(c.useState)(C||W[0].value),Z=Object(a.a)(X,2),$=Z[0],Q=Z[1],ee=O.find((function(e){return e.id.toLowerCase()===o.toLowerCase()})),te=function(e,t,n){var s=Object(c.useState)((function(){return Date.now()})),r=Object(a.a)(s,2),o=r[0],l=r[1],d=Object(c.useState)(null),u=Object(a.a)(d,2),b=u[0],j=u[1],f=Object(c.useState)(null),h=Object(a.a)(f,2),p=h[0],O=h[1],v=Object(c.useState)(null),g=Object(a.a)(v,2),x=g[0],y=g[1],k=Object(c.useState)(null),w=Object(a.a)(k,2),N=w[0],T=w[1];Object(c.useEffect)((function(){Date.now()-o>3e4&&l(Date.now());var e=setTimeout((function(){return l(Date.now())}),3e4);return function(){return clearTimeout(e)}}),[o,t,n]);var S=e?"".concat(e,"/identity/").concat(t.id,"/").concat(n.id,"/privileges?cacheBreak=").concat(o):null,C=Object(i.j)({url:S}),A=C.data,M=C.errMsg,E=C.isLoading;return Object(c.useEffect)((function(){var e=A?A.privileges:{},a=A&&A.recoveryLock,c=e[t.signer.quickAccManager]&&(a&&a.status&&!E||e&&t.signer.quickAccManager&&t.signer.preRecovery&&function(e){var t=new L.AbiCoder,n=e.timelock,a=e.one,c=e.two;return Object(L.keccak256)(t.encode(["tuple(uint, address, address)"],[[n,a,c]]))}(t.signer)!==e[t.signer.quickAccManager]);j({hasPendingReset:c,errMsg:M,recoveryLock:a}),E?y(!N&&E):p===(null===t||void 0===t?void 0:t.id)+n.id?(T(!0),y(!1)):(O((null===t||void 0===t?void 0:t.id)+n.id),T(!1))}),[A,M,E,t,p,n.id,N]),Object(m.a)({data:A,isPasswordRecoveryCheckLoading:x},b)}(g,ee,n),ne=te.hasPendingReset,ae=te.recoveryLock,ce=te.isPasswordRecoveryCheckLoading,se=!!t.cachedBalancesByNetworks.length&&t.cachedBalancesByNetworks.find((function(e){return e.network===n.id}));return Object(c.useEffect)((function(){if(!$||$===W[0].value)return N.replace("/wallet/dashboard");N.replace("/wallet/dashboard/".concat($).concat($===W[1].value?"/".concat(M):""))}),[$,N,M]),Object(c.useLayoutEffect)((function(){var e=t.tokens.map((function(e){var n=e.label,a=e.symbol,c=e.balanceUSD;return{label:n||a,value:Number((c/t.balance.total.full*100).toFixed(2))}})).filter((function(e){return e.value>0})),n=t.protocols.map((function(e){return e.assets.map((function(e){return e.balanceUSD})).reduce((function(e,t){return e+t}),0)})).reduce((function(e,t){return e+t}),0),a=t.protocols.map((function(e){var t=e.label,a=e.assets;return{label:t,value:Number((a.map((function(e){return e.balanceUSD})).reduce((function(e,t){return e+t}),0)/n*100).toFixed(2))}})).filter((function(e){return e.value>0}));R(e),Y(a)}),[t.balance,t.tokens,t.protocols]),Object(c.useEffect)((function(){return t.requestOtherProtocolsRefresh()}),[t]),Object(d.jsxs)("section",{id:"dashboard",children:[se&&Object(d.jsx)(D,{selectedNetwork:n,selectedAccount:o}),Object(d.jsx)(I,{rewardsData:j}),Object(d.jsx)(B.a,{selectedNetwork:n,selectedAccount:o,accounts:O,addRequest:v,closeable:!0,relayerURL:g,portfolio:t,useStorage:x}),ne&&!ce&&Object(d.jsx)(U.a,{recoveryLock:ae,showSendTxns:w,selectedAccount:ee,selectedNetwork:n}),Object(d.jsxs)("div",{id:"overview",children:[Object(d.jsxs)("div",{id:"balance",className:"panel",children:[Object(d.jsx)("div",{className:"title",children:"Balance"}),Object(d.jsx)("div",{className:"content",children:Object(d.jsx)(u,{portfolio:t,selectedNetwork:n,setNetwork:l,hidePrivateValue:b.hidePrivateValue,relayerURL:g,selectedAccount:o,match:y})})]}),Object(d.jsxs)("div",{id:"chart",className:"panel",children:[Object(d.jsxs)("div",{className:"title",children:["Balance by",Object(d.jsx)(r.s,{small:!0,defaultValue:_[0].value,segments:_,onChange:K})]}),Object(d.jsx)("div",{className:"content",children:J===_[0].value?t.isCurrNetworkBalanceLoading?Object(d.jsx)(r.m,{}):b.hidePrivateContent(Object(d.jsx)(r.f,{data:F,size:200})):t.isCurrNetworkProtocolsLoading?Object(d.jsx)(r.m,{}):b.hidePrivateContent(Object(d.jsx)(r.f,{data:q,size:200}))})]})]}),Object(d.jsxs)("div",{id:"table",className:"panel",children:[Object(d.jsxs)("div",{className:"title",children:["Assets",Object(d.jsx)(r.s,{small:!0,defaultValue:$,segments:W,onChange:Q})]}),Object(d.jsx)("div",{className:"content",children:$===W[0].value?Object(d.jsx)(k,{portfolio:t,network:n,account:o,hidePrivateValue:b.hidePrivateValue,userSorting:f,setUserSorting:h}):Object(d.jsx)(S,{portfolio:t,isPrivateMode:b.isPrivateMode})}),Object(d.jsx)("div",{className:"footer",children:Object(d.jsxs)("div",{id:"missing-token-notice",children:[Object(d.jsx)(p.M,{}),Object(d.jsxs)("span",{children:["If you don't see a specific token that you own, please check the ",Object(d.jsx)("a",{href:"".concat(n.explorerUrl,"/address/").concat(o),target:"_blank",rel:"noreferrer",children:"Block Explorer"})]})]})})]})]})}},186:function(e,t,n){"use strict";n.r(t);t.default=function(e,t){}},605:function(e,t,n){},636:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(108);function c(e,t){if(null==e)return{};var n,c,s=Object(a.a)(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}},809:function(e,t,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var c=n(30),s=a(n(3)),r=n(50);n(49),n(186);var i=a(n(54));function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function l(e,t){e.prototype=Object.create(t.prototype),d(e.prototype.constructor=e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(null==e)return{};var n,a,c={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],0<=t.indexOf(n)||(c[n]=e[n]);return c}var b=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))||this).history=r.createBrowserHistory(t.props),t}return l(t,e),t.prototype.render=function(){return s.createElement(c.Router,{history:this.history,children:this.props.children})},t}(s.Component),j=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))||this).history=r.createHashHistory(t.props),t}return l(t,e),t.prototype.render=function(){return s.createElement(c.Router,{history:this.history,children:this.props.children})},t}(s.Component),m=function(e,t){return"function"==typeof e?e(t):e},f=function(e,t){return"string"==typeof e?r.createLocation(e,null,null,t):e},h=function(e){return e},p=s.forwardRef;void 0===p&&(p=h);var O=p((function(e,t){var n=e.innerRef,a=e.navigate,c=e.onClick,r=u(e,["innerRef","navigate","onClick"]),i=r.target,l=o({},r,{onClick:function(t){try{c&&c(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0!==t.button||i&&"_self"!==i||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(t)||(t.preventDefault(),a())}});return l.ref=h!==p&&t||n,s.createElement("a",l)})),v=p((function(e,t){var n=e.component,a=void 0===n?O:n,l=e.replace,d=e.to,b=e.innerRef,j=u(e,["component","replace","to","innerRef"]);return s.createElement(c.__RouterContext.Consumer,null,(function(e){e||i(!1);var n=e.history,c=f(m(d,e.location),e.location),u=c?n.createHref(c):"",O=o({},j,{href:u,navigate:function(){var t=m(d,e.location),a=r.createPath(e.location)===r.createPath(f(t));(l||a?n.replace:n.push)(t)}});return h!==p?O.ref=t||b:O.innerRef=b,s.createElement(a,O)}))})),g=function(e){return e},x=s.forwardRef;void 0===x&&(x=g);var y=x((function(e,t){var n=e["aria-current"],a=void 0===n?"page":n,r=e.activeClassName,l=void 0===r?"active":r,d=e.activeStyle,b=e.className,j=e.exact,h=e.isActive,p=e.location,O=e.sensitive,y=e.strict,k=e.style,w=e.to,N=e.innerRef,T=u(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return s.createElement(c.__RouterContext.Consumer,null,(function(e){e||i(!1);var n=p||e.location,r=f(m(w,n),n),u=r.pathname,S=u&&u.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),C=S?c.matchPath(n.pathname,{path:S,exact:j,sensitive:O,strict:y}):null,A=!!(h?h(C,n):C),M="function"==typeof b?b(A):b,E="function"==typeof k?k(A):k;A&&(M=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(M,l),E=o({},E,d));var P=o({"aria-current":A&&a||null,className:M,style:E,to:r},T);return g!==x?P.ref=t||N:P.innerRef=N,s.createElement(v,P)}))}));Object.defineProperty(t,"MemoryRouter",{enumerable:!0,get:function(){return c.MemoryRouter}}),Object.defineProperty(t,"Prompt",{enumerable:!0,get:function(){return c.Prompt}}),Object.defineProperty(t,"Redirect",{enumerable:!0,get:function(){return c.Redirect}}),Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return c.Route}}),Object.defineProperty(t,"Router",{enumerable:!0,get:function(){return c.Router}}),Object.defineProperty(t,"StaticRouter",{enumerable:!0,get:function(){return c.StaticRouter}}),Object.defineProperty(t,"Switch",{enumerable:!0,get:function(){return c.Switch}}),Object.defineProperty(t,"generatePath",{enumerable:!0,get:function(){return c.generatePath}}),Object.defineProperty(t,"matchPath",{enumerable:!0,get:function(){return c.matchPath}}),Object.defineProperty(t,"useHistory",{enumerable:!0,get:function(){return c.useHistory}}),Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return c.useLocation}}),Object.defineProperty(t,"useParams",{enumerable:!0,get:function(){return c.useParams}}),Object.defineProperty(t,"useRouteMatch",{enumerable:!0,get:function(){return c.useRouteMatch}}),Object.defineProperty(t,"withRouter",{enumerable:!0,get:function(){return c.withRouter}}),t.BrowserRouter=b,t.HashRouter=j,t.Link=v,t.NavLink=y},810:function(e,t,n){"use strict";var a=n(2),c=n.n(a),s=n(11),r=n(228),i=n(184),o=n(679),l=n(4);t.a=function(e){var t=e.recoveryLock,n=e.showSendTxns,a=e.selectedAccount,d=e.selectedNetwork,u=t&&"requestedButNotInitiated"!==t.status,b=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return");case 2:t=Object(o.a)(a.id,d.id,a.signer.preRecovery,{signer:a.signer,primaryKeyBackup:a.primaryKeyBackup}),n(t,!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=t?t.status:"requestedButNotInitiated",m=function(e){return e>86400?"".concat(Math.ceil(e/86400)," days"):"".concat(Math.ceil(e/1440)," hours")},f=u?"ready"===j?"success":"warning":"warning action";return Object(l.jsxs)("div",{className:"notification-banner notification-hollow ".concat(f),onClick:function(){return b()},children:["ready"===j?Object(l.jsx)(i.b,{}):Object(l.jsx)(r.b,{}),"requestedButNotInitiated"===j?Object(l.jsxs)(l.Fragment,{children:["Password reset requested but not initiated for ",d.name,". Click here to initiate it."]}):"initiationTxnPending"===j?Object(l.jsxs)(l.Fragment,{children:["Initiation transaction is currently pending. Once mined, you will need to wait ",m(t.timelock)," for the reset to be done on ",d.name,"."]}):"waitingTimelock"===j?Object(l.jsxs)(l.Fragment,{children:["Password reset on ",d.name," is currently pending. ",m(t.remaining)," remaining."]}):"ready"===j?Object(l.jsxs)(l.Fragment,{children:["Password reset on ",d.name," is now complete! You can start signing transactions with your new password!"]}):"failed"===j?Object(l.jsx)(l.Fragment,{children:"Something went wrong while resetting your password. Please contact support at help.ambire.com"}):null]})}},812:function(e,t,n){"use strict";var a=n(7),c=(n(605),n(106)),s=n(84),r="0x0000000000000000000000000000000000000000",i=n(60);function o(e){var t,n=e.networkId,a=e.account;return(null===(t=i.a.find((function(e){return e.id===n})))||void 0===t?void 0:t.relayerlessOnly)?Promise.resolve([]):a?Object(s.c)("".concat(c.h,"/protocols/tokens/balances?addresses[]=").concat(a,"&network=").concat(n,"&api_key=").concat(c.j,"&newBalances=true&available_on_coingecko=true")).then((function(e){var t=a.toLowerCase();if(!e[t])return[];if(!e[t].products[0])return[];var i=e[t].products[0].assets.map((function(e){return{address:e.tokens[0].address,symbol:e.tokens[0].symbol,decimals:e.tokens[0].decimals}})),o="".concat(c.h,"/protocols/tokens/balances?addresses[]=").concat(a,"&network=").concat(n,"&api_key=").concat(c.j,"&customTokens=").concat(JSON.stringify(i),"&available_on_coingecko=true");return Object(s.c)(o).then((function(e){var n,a;return(null===(n=e[t])||void 0===n||null===(a=n.products[0])||void 0===a?void 0:a.assets).map((function(e){return{name:e.tokens[0].symbol,icon:e.tokens[0].tokenImageUrl,address:e.tokens[0].address.toLowerCase(),native:e.tokens[0].address===r,decimals:e.tokens[0].decimals,availableBalance:e.tokens[0].balanceRaw,balanceUSD:e.tokens[0].balanceUSD,rate:e.tokens[0].balanceUSD/e.tokens[0].balanceRaw}}))})).catch((function(e){throw Error("Could not get customToken assets from velcro")}))})).catch((function(e){throw Error("Could not get assets from velcro")})):Promise.resolve([])}var l=n(34),d=n(77),u=n(3),b=n(2),j=n.n(b),m=n(11),f=n(8),h=n(17),p=n(667),O=n.n(p),v=n(240),g=n(229),x=n(37),y=n(55),k=n(95),w=n(21),N=[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}],T=[{name:"holder",type:"address"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"expiry",type:"uint256"},{name:"allowed",type:"bool"}],S=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],C=[{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],A=[{name:"name",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],M=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"verifyingContract",type:"address"},{name:"salt",type:"bytes32"}],E={1:[{address:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",name:"USD Coin",version:"2",domainType:S,permitType:N},{address:"0x1f9840a85d5af5bf1d1762f925bdaddc4201f984",name:"Uniswap",domainType:A,permitType:N},{address:"0xde30da39c46104798bb5aa3fe8b9e0e1f348163f",name:"Gitcoin",domainType:A,permitType:N},{address:"0x6b175474e89094c44da98b954eedeac495271d0f",name:"Dai Stablecoin",version:"1",domainType:S,permitType:T},{address:"0x090185f2135308bad17527004364ebcc2d37e5f6",domainType:C,permitType:N},{address:"0x99d8a9c45b2eca8864373a26d1459e3dff1e17f3",domainType:C,permitType:N},{address:"0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9",name:"Aave Token",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"AdEx Loyalty",address:"0xd9a4cb9dc9296e111c66dfacab8be034ee2e1c2c",version:"1",domainType:S,permitType:N},{name:"Aave Token",address:"0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9",version:"1",domainType:S,permitType:N},{name:"Ambire Wallet Staking Token",address:"0x47cd7e91c3cbaaf266369fe8518345fc4fc12935",version:"1",domainType:S,permitType:N},{name:"ConstitutionDAO",address:"0x7a58c0be72be218b41c608b7fe7c5bb630736c71",version:"1",domainType:S,permitType:N},{name:"Aragon Network Token",address:"0xa117000000f279d81a1d3cc75430faa017fa5a2e",version:"1",domainType:S,permitType:N},{name:"AdEx Staking Token",address:"0xb6456b57f03352be48bf101b46c1752a0813491a",version:"1",domainType:S,permitType:N},{name:"dYdX",address:"0x92d6c1e31e14520e676a687f0a93788b716beff5",version:"1",domainType:S,permitType:N},{name:"Ethereum Name Service",address:"0xc18360217d8f7ab5e7c516566761ea12ce7f9d72",version:"1",domainType:S,permitType:N},{name:"Olympus",address:"0x383518188c0c6d7730d91b2c03a03c837814a899",version:"1",domainType:S,permitType:N},{name:"1INCH Token",address:"0x111111111117dc0aa78b770fa6a738034120c302",version:"1",domainType:S,permitType:N},{name:"IceToken",address:"0xf16e81dce15b08f326220742020379b855b87df9",version:"1",domainType:S,permitType:N},{name:"Fei USD",address:"0x956f47f50a910163d8bf957cf5846d573e7f87ca",version:"1",domainType:S,permitType:N},{name:"LUSD Stablecoin",address:"0x5f98805a4e8be255a32880fdec7f6728c6568ba0",version:"1",domainType:S,permitType:N},{name:"Balancer",address:"0xba100000625a3754423978a60c9317c58a424e3d",version:"1",domainType:S,permitType:N},{name:"Aave interest bearing AAVE",address:"0xffc97d72e13e01096502cb8eb52dee56f74dad7b",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniBATWETH",address:"0xa1b0edf4460cc4d8bfaa18ed871bff15e5b57eb4",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniWBTCWETH",address:"0xc58f53a8adff2fb4eb16ed56635772075e2ee123",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniUSDCWETH",address:"0x391e86e2c002c70dee155eaceb88f7a3c38f5976",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing WETH",address:"0x030ba81f1c18d280636f32af80b9aad02cf0854e",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing DAI",address:"0x028171bca77440897b824ca71d1c56cac55b68a3",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniWBTCUSDC",address:"0x2365a4890ed8965e564b7e2d27c38ba67fec4c6f",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniCRVWETH",address:"0x0ea20e7ffb006d4cfe84df2f72d8c7bd89247db0",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniUNIWETH",address:"0x3d26dcd840fcc8e4b2193ace8a092e4a65832f9f",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing GUSD",address:"0xd37ee7e4f452c6638c96536e68090de8cbcdb583",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniMKRWETH",address:"0x370adc71f67f581158dc56f539df5f399128ddf9",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing CRV",address:"0x8dae6cb04688c62d939ed9b68d32bc62e49970b1",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market USDT",address:"0x17a79792fe6fe5c95dfe95fe3fcee3caf4fe4cb7",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market UniSNXWETH",address:"0x38e491a71291cd43e8de63b7253e482622184894",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing YFI",address:"0x5165d24277cd063f5ac44efd447b27025e888f37",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing SNX",address:"0x35f6b052c598d933d69a4eec4d04c73a191fe6c2",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market USDC",address:"0xd24946147829deaa935be2ad85a3291dbf109c80",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market DAI",address:"0x79be75ffc64dd58e66787e4eae470c8a1fd08ba4",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing USDT",address:"0x3ed3b47dd13ec9a98b44e6204a523e766b225811",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing RAI",address:"0xc9bc48c72154ef3e5425641a3c747242112a46af",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing BAL",address:"0x272f97b7a56a387ae942350bbc7df5700f8a4576",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing BAT",address:"0x05ec93c0365baaeabf7aeffb0972ea7ecdd39cf1",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing USDC",address:"0xbcca60bb61934080951369a648fb03df4f96263c",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave AMM Market BptBALWETH",address:"0xd109b2a304587569c84308c55465cd9ff0317bfb",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing KNC",address:"0x39c6b3e42d6a679d7d776778fe880bc9487c2eda",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing MANA",address:"0xa685a61171bb30d4072b338c80cb7b2c865c873e",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing XSUSHI",address:"0xf256cc7847e919fac9b808cc216cac87ccf2f47a",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing TUSD",address:"0x101cc05f4a51c0319f570d5e146a8c625198e636",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"},{name:"Aave interest bearing ENJ",address:"0xac6df26a590f08dcc95d5a4705ae8abbc88509ef",version:"1",domainType:S,permitType:N,nonceFunction:"_nonces"}],137:[{name:"Governance OHM",address:"0xd8ca34fd379d9ca3c6ee3b3905678320f5b45195",version:"1",domainType:S,permitType:N},{name:"Frax",address:"0x45c32fa6df82ead1e2ef74d17b76547eddfaff89",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market WBTC",address:"0x5c2ed810328349100a66b82b78a1791b101c9d61",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market WETH",address:"0x28424507fefb6f7f8e9d3860f56504e4e5f5f390",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market USDC",address:"0x1a13f4ca1d028320a707d99520abfefca3998b7f",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market AAVE",address:"0x1d2a0e5ec8e5bbdca5cb219e649b565d8e5c3360",version:"1",domainType:S,permitType:N},{name:"Synapse",address:"0xf8f9efc0db77d8881500bb06ff5d6abc3070e695",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market WMATIC",address:"0x8df3aad3a84da6b69a4da8aec3ea40d9091b2ac4",version:"1",domainType:S,permitType:N},{name:"Aave Matic Market USDT",address:"0x60d55f02a771d515e077c9c2403a1ef324885cec",version:"1",domainType:S,permitType:N},{name:"Klima DAO",address:"0x4e78011ce80ee02d2c3e649fb657e45898257815",version:"1",domainType:S,permitType:N},{name:"Quickswap",address:"0xb5c064f955d8e7f38fe0460c556a72987494ee17",domainType:A,permitType:N},{name:"Route",address:"0x16eccfdbb4ee1a85a33f3a9b21175cd7ae753db4",domainType:A,permitType:N},{address:"0x8f3cf7ad23cd3cadbd9735aff958023239c6a063",name:"(PoS) Dai Stablecoin",version:"1",salt:"0x0000000000000000000000000000000000000000000000000000000000000089",domainType:M,permitType:T,nonceFunction:"getNonce"},{address:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",name:"USD Coin (PoS)",version:"1",salt:"0x0000000000000000000000000000000000000000000000000000000000000089",domainType:M,permitType:N}],56:[{name:"1INCH Token",address:"0x111111111117dc0aa78b770fa6a738034120c302",version:"1",domainType:S,permitType:N},{name:"Frax",address:"0x90c97f71e18723b0cf0dfa30ee176ab653e89f40",version:"1",domainType:S,permitType:N},{name:"JADE",address:"0x7ad7242a99f21aa543f9650a56d141c57e4f6081",version:"1",domainType:S,permitType:N},{name:"Templar Token",address:"0x19e6bfc1a6e4b042fb20531244d47e252445df01",version:"1",domainType:S,permitType:N}]},P=new w.Interface(["function nonces(address owner) external view returns (uint256)","function _nonces(address owner) external view returns (uint256)","function getNonce(address owner) external view returns (uint256)","function name() external view returns (string)","function symbol() external view returns (string)","function decimals() external view returns (uint)","function balanceOf(address) external view returns (uint)","function permit(address owner, address spender, uint256 value, uint256 deadline, uint8 v, bytes32 r, bytes32 s)","function permit(address holder, address spender, uint256 nonce, uint256 expiry, bool allowed, uint8 v, bytes32 r, bytes32 s)","function transferFrom(address from, address to, uint256 amount) view returns (bool)","function transfer(address to, uint256 amount) view returns (bool)","function approve(address spender, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint)"]),F=n(87),R=n(730),I=n(4),B=function(e){var t=e.signerAccount,n=e.identityAccount,c=e.network,i=e.setIsSelectionConfirmed,l=e.setStep,b=e.portfolio,p=e.relayerURL,w=e.setModalButtons,N=e.hideModal,T=e.setSelectedTokensWithAllowance,S=e.setGasSpeed,C=e.setStepperSteps,A=e.hidden,M=Object(u.useState)([]),E=Object(a.a)(M,2),B=E[0],U=E[1],L=Object(u.useState)([]),D=Object(a.a)(L,2),_=D[0],W=D[1],H=Object(u.useState)(null),z=Object(a.a)(H,2),q=z[0],Y=z[1],G=Object(u.useState)(!0),V=Object(a.a)(G,2),J=V[0],K=V[1],X=Object(u.useState)([]),Z=Object(a.a)(X,2),$=Z[0],Q=Z[1],ee=Object(u.useState)(null),te=Object(a.a)(ee,2),ne=te[0],ae=te[1],ce=Object(u.useState)(null),se=Object(a.a)(ce,2),re=se[0],ie=se[1],oe=Object(u.useState)("fast"),le=Object(a.a)(oe,2),de=le[0],ue=le[1],be=Object(u.useState)([]),je=Object(a.a)(be,2),me=je[0],fe=je[1],he=Object(u.useState)(!1),pe=Object(a.a)(he,2),Oe=pe[0],ve=pe[1],ge=Object(u.useState)(!1),xe=Object(a.a)(ge,2),ye=xe[0],ke=xe[1],we=Object(u.useState)(""),Ne=Object(a.a)(we,2),Te=Ne[0],Se=Ne[1],Ce=Object(u.useState)(""),Ae=Object(a.a)(Ce,2),Me=Ae[0],Ee=Ae[1],Pe=Object(u.useRef)(),Fe=Object(u.useRef)({}),Re=Object(u.useCallback)((function(e,t){var n=_.findIndex((function(t){return t.address===e}));if(-1!==n){var a=t(_[n]);W([].concat(Object(h.a)(_.slice(0,n)),[a],Object(h.a)(_.slice(n+1))))}}),[_]),Ie=Object(u.useCallback)((function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=B.sort((function(e,t){return e.name<t.name?-1:1})).findIndex((function(t){return t.address===e}));null===(t=Fe.current[a])||void 0===t||t.focus(),Re(e,(function(t){var a=Object(f.a)(Object(f.a)({},t),{},{selected:!t.selected});if(n){var c,s=null===(c=_.find((function(t){return t.address===e})))||void 0===c?void 0:c.humanAmount;if(n>s){var r,i=null===(r=B.find((function(t){return t.address===e})))||void 0===r?void 0:r.decimals;a.amount=new O.a(n).multipliedBy(Math.pow(10,i)).toFixed(0),a.humanAmount=n}}return a}))}),[B,Re,_]),Be=Object(u.useCallback)((function(){var e=Object(F.a)(c.id);if(y.ethers.utils.isAddress(Te)){if(B.find((function(e){return e.address.toLowerCase()===Te.toLowerCase()})))return Se(""),void ve(!1);var s=new k.Contract(Te,P,e),r=s.symbol().catch((function(){return Ee("Could not get symbol of token "+Te)})),i=s.decimals().catch((function(){return Ee("Could not get decimals of token "+Te)})),o=s.allowance(t,n).catch((function(){return Ee("Could not get allowance for token "+Te)})),l=s.balanceOf(t).catch((function(){return Ee("Could not get balance for token "+Te)}));ke(!0),Ee(null),Promise.all([r,i,o,l]).then((function(e){var t=Object(a.a)(e,4),n=t[0],c=t[1],s=t[2],r=t[3];ke(!1),n&&c&&null!==s&&null!==r&&(Se(""),ve(!1),U((function(e){return[].concat(Object(h.a)(e),[{address:Te,name:n,decimals:c.toNumber(),icon:null,rate:0,native:!1,availableBalance:r.toString(),balanceUSD:0}])})),W((function(e){return[].concat(Object(h.a)(e),[{address:Te,selectedAmount:0,amount:r.toString(),humanAmount:new O.a(r.toString()).div(Math.pow(10,c.toString())).toFixed(),selected:r.gt(0)}])})),fe((function(e){return[].concat(Object(h.a)(e),[{address:Te,allowance:0}])})))})).catch((function(e){console.log("err getting custom token data",e),ke(!1)}))}else Ee("invalid custom token address")}),[c,Te,t,n,Ee,B]),Ue=Object(u.useCallback)((function(e){var t;if(!re)return!1;var n=(null===(t=_.find((function(e){return e.address===r&&e.selected})))||void 0===t?void 0:t.amount)||0;return new O.a(re.gasFees[e].signerTransactionsCost).plus(n).lte(q.availableBalance||0)}),[_,re,q]),Le=Object(u.useCallback)((function(e){return new O.a(q.availableBalance).minus(re.gasFees[e].signerTransactionsCost)}),[re,q]),De=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.map((function(e){return Object(f.a)(Object(f.a)(Object(f.a)({},e),t.find((function(t){return t.address===e.address}))),n.find((function(t){return t.address===e.address})))}))},_e=Object(u.useCallback)(Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=De(B,_,me).filter((function(e){return e.selected}))).length){e.next=3;break}return e.abrupt("return");case 3:T(t.map((function(e){return Object(f.a)({},e)}))),i(!0),t.find((function(e){return e.address===r}))?l(1):l(2),S(de);case 7:case"end":return e.stop()}}),e)}))),[B,_,me,T,i,l,S,de]);Object(u.useEffect)((function(){Oe&&Pe.current.focus()}),[Oe]),Object(u.useEffect)((function(){Y(B.find((function(e){return e.native})))}),[B]),Object(u.useEffect)((function(){K(!0),U([]),o({networkId:c.id,account:t}).then((function(e){U(e.map((function(e){return Object(f.a)({},e)}))),W(e.map((function(e){return{address:e.address,selectedAmount:0,amount:e.availableBalance,humanAmount:new O.a(e.availableBalance).div(Math.pow(10,e.decimals)).toFixed(),selected:!1}}))),K(!1)})).catch((function(e){console.error(e)}))}),[t,K,U,c]),Object(u.useEffect)((function(){if(ne){var e=De(B,_,me),t=e.filter((function(e){return e.selected&&!e.native})).length,n=e.filter((function(e){return e.selected&&e.native})).length,a=t*(77e3+("arbitrum"===c.id?2e5:0))+25e3*n,s=ne.gasFeeAssets.native/Math.pow(10,18),r={};R.a.forEach((function(e){var t=ne.gasPrice[e]+(ne.gasPrice.maxPriorityFeePerGas?1*ne.gasPrice.maxPriorityFeePerGas[e]:0),n=a*t,c=n*s;r[e]={speed:e,signerTransactionsCost:n,signerTransactionsCostUSD:c,signerTransactionsConsumption:a}})),ie({regularTransfersCount:t,nativeTransfersCount:n,gasFees:r})}}),[B,_,b,ne,de,me,c]),Object(u.useEffect)((function(){Object(s.c)("".concat(p,"/gasPrice/").concat(c.id)).then((function(e){ae(e.data)})).catch((function(e){console.log("fetch error",e)}))}),[p,c]),Object(u.useEffect)((function(){var e=B.map((function(e){var a=Object(F.a)(c.id),s=new k.Contract(e.address,P,a);return e.native?{address:e.address,allowance:0}:s.allowance(t,n).then((function(t){return{address:e.address,allowance:t.toString()}})).catch((function(e){console.log("err getting allowance",e)}))}));Promise.all(e).then((function(e){fe(e)}))}),[n,c,B,t]),Object(u.useEffect)((function(){A||w(Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(d.e,{clear:!0,small:!0,icon:Object(I.jsx)(x.i,{}),onClick:N,children:"Close"}),_.filter((function(e){return e.selected})).length>0&&Ue(de)?Object(I.jsxs)(d.e,{small:!0,icon:Object(I.jsx)(x.R,{}),className:"primary",onClick:function(){return _e()},children:["Move ",_.filter((function(e){return e.selected})).length," assets"]}):Object(I.jsx)(d.e,{small:!0,icon:Object(I.jsx)(x.R,{}),className:"primary disabled",children:"Move assets"})]}))}),[_,de,w,N,_e,A,Ue]);var We=Object(u.useCallback)((function(e,t){return Re(t.address,(function(n){if(""===e)return Object(f.a)(Object(f.a)({},n),{},{humanAmount:0,amount:0});if(e.endsWith(".")&&2===e.split(".").length||2===e.split(".").length&&e.endsWith("0")&&new O.a(e).isEqualTo(n.humanAmount))return Object(f.a)(Object(f.a)({},n),{},{humanAmount:e});if(!isNaN(e)){var a=new O.a(e).toFixed(t.decimals);return 1===new O.a(a).multipliedBy(Math.pow(10,t.decimals)).comparedTo(t.availableBalance)&&(a=new O.a(t.availableBalance).dividedBy(Math.pow(10,t.decimals)).toFixed(t.decimals)),a=a.replace(/\.?0+$/g,""),Object(f.a)(Object(f.a)({},n),{},{humanAmount:a,amount:new O.a(a).multipliedBy(Math.pow(10,t.decimals)).toFixed(0)})}return n}))}),[Re]);return Object(u.useEffect)((function(){setTimeout((function(){var e;null===(e=Fe.current[0])||void 0===e||e.focus()}),250)}),[B]),Object(u.useEffect)((function(){var e=["Selection"],t=_.find((function(e){return e.address.toLowerCase()===r&&e.selected}));if(t&&e.push("Send ".concat(B.find((function(e){return e.address===t.address})).name)),_.find((function(e){return e.address.toLowerCase()!==r&&e.selected}))){var n=[];_.find((function(e){return e.selected&&e.address.toLowerCase()!==r}))&&n.push("Send"),e.push(n.join(" and ")+" tokens")}1===e.length&&e.push("Send tokens"),C(e)}),[B,_,C,c]),A?Object(I.jsx)(I.Fragment,{}):Object(I.jsx)("div",{children:J?Object(I.jsxs)("div",{className:"content-center",children:[Object(I.jsx)("h3",{className:"mb-6",children:"Loading assets..."}),Object(I.jsx)(v.a,{})]}):Object(I.jsx)("div",{children:0===B.length?Object(I.jsx)("div",{children:"No assets to migrate have been found"}):Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"mb-4",children:"Please select the assets you would like to migrate from your signer wallet to your Ambire wallet"}),De(B,_).sort((function(e,t){return e.name<t.name?-1:1})).map((function(e,t){return Object(I.jsxs)("div",{className:"migration-asset-row",children:[Object(I.jsx)("div",{className:"migration-asset-select".concat(e.selected?" checked":""),onClick:function(){return!1},children:Object(I.jsx)(d.g,{id:"check-".concat(e.address),label:Object(I.jsxs)("span",{className:"migration-asset-select-label",children:[Object(I.jsx)("span",{className:"migration-asset-select-icon",children:$.includes(e.icon)||!e.icon?Object(I.jsx)(g.d,{size:18}):Object(I.jsx)("img",{src:e.icon,draggable:"false",alt:"Token Icon",onError:function(t){Q((function(t){return[].concat(Object(h.a)(t),[e.icon])}))}})}),Object(I.jsx)("span",{className:"migration-asset-select-name",children:e.name})]}),checked:e.selected,onChange:function(){return Ie(e.address)}})}),Object(I.jsxs)("div",{className:"migration-asset-usd",children:["$",(e.amount*e.rate).toFixed(2)]}),Object(I.jsx)("div",{className:"migration-asset-amount",children:Object(I.jsx)(d.w,{ref:function(e){return Fe.current[t]=e},className:"migrate-amount-input",value:e.humanAmount,onChange:function(t){return We(t,e)}})})]},t)})),Object(I.jsx)("div",{className:"custom-token-row mt-2",children:Oe?Object(I.jsx)("div",{children:ye?Object(I.jsxs)("div",{className:"custom-token-message-fetching",children:[Object(I.jsx)(d.m,{}),"Fetching custom token data..."]}):Object(I.jsxs)(I.Fragment,{children:[Me&&Object(I.jsx)("div",{className:"error",children:Me}),Object(I.jsx)("div",{children:Object(I.jsx)(d.w,{className:"custom-token-input",placeholder:"Enter custom token address",value:Te,onChange:function(e){Se(e)},ref:Pe})}),Object(I.jsxs)("div",{className:"flex-row mt-2",children:[Object(I.jsx)(d.e,{small:!0,icon:Object(I.jsx)(x.e,{}),className:"buttonHollow danger align-right",onClick:function(){ve(!1),Se(""),Ee(null)},children:"Cancel"}),Object(I.jsx)(d.e,{small:!0,icon:Object(I.jsx)(x.D,{}),className:"primary ms-4",onClick:function(){return Be()},children:"Add"})]})]})}):Object(I.jsx)(d.e,{small:!0,icon:Object(I.jsx)(x.D,{}),className:"clear align-right",onClick:function(){return ve(!0)},children:"Add custom token"})}),!Ue(de)&&_.filter((function(e){return e.selected})).length>0&&Object(I.jsxs)("div",{className:"notification-hollow warning mt-3 mb-3",children:["Your Signer Wallet will not have enough fees to pay for the migration. Please transfer a maximum of ",Object(I.jsxs)("span",{className:"max-native-suggestion",onClick:function(){return We(new O.a(Le(de)).dividedBy(Math.pow(10,q.decimals)).toFixed(6,O.a.ROUND_DOWN),q)},children:[new O.a(Le(de)).dividedBy(Math.pow(10,q.decimals)).toFixed(6,O.a.ROUND_DOWN)," ",c.nativeAssetSymbol]})]}),re&&Object(I.jsxs)("div",{className:"gas-estimation-block mt-4",children:[Object(I.jsx)("div",{className:"gas-estimation-block-title",children:"Estimated gas fee"}),Object(I.jsx)("ul",{className:"gas-estimation-selector",children:Object.values(re.gasFees).map((function(e,t){return Object(I.jsx)("li",{className:e.speed===de?"selected":"",onClick:function(){return ue(e.speed)},children:e.speed},t)}))}),Object(I.jsx)("table",{className:"gas-estimation-details",children:Object(I.jsx)("tbody",{children:Object(I.jsxs)("tr",{children:[Object(I.jsxs)("td",{children:["Signer fee",(!!re.nativeTransfersCount||!!re.regularTransfersCount)&&Object(I.jsx)("span",{className:"migration-actions",children:Object(I.jsxs)("span",{children:[re.nativeTransfersCount+re.regularTransfersCount," transfers"]})})]}),Object(I.jsxs)("td",{className:"gas-estimation-details-amount",children:["$",re.gasFees[de].signerTransactionsCostUSD.toFixed(2)]})]})})})]})]})})})},U=n(614),L=n(184),D=n(239),_=function(e){e.addRequest;var t=e.identityAccount,n=e.signer,c=e.signerExtra,i=e.network,o=e.selectedTokensWithAllowance,l=e.setError,d=e.hideModal,b=e.setStep,p=e.setModalButtons,v=e.relayerURL,k=e.gasSpeed,w=e.hidden,N=Object(u.useState)([]),T=Object(a.a)(N,2),S=T[0],C=T[1],A=Object(u.useState)({}),M=Object(a.a)(A,2),E=M[0],F=M[1],R=Object(u.useState)({}),B=Object(a.a)(R,2),_=B[0],W=B[1],H=Object(u.useState)(!1),z=Object(a.a)(H,2),q=z[0],Y=z[1],G=Object(u.useState)(null),V=Object(a.a)(G,2),J=V[0],K=V[1],X=Object(u.useState)([]),Z=Object(a.a)(X,2),$=Z[0],Q=Z[1],ee=Object(u.useState)(null),te=Object(a.a)(ee,2),ne=te[0],ae=te[1],ce=Object(u.useState)(null),se=Object(a.a)(ce,2),re=se[0],ie=se[1],oe=Object(u.useState)(null),le=Object(a.a)(oe,2),de=le[0],ue=le[1],be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e.filter((function(e){return e.address!==r})).map((function(e){var c=Object(f.a)(Object(f.a)({},e),{},{signing:null,signature:null,sent:!1,pending:!1,allowance:0});return t[e.address]&&(c.signing=t[e.address].signing,c.signature=t[e.address].signature),n[e.address]&&(c.sent=!0),a[e.address]&&(c.pending=!0),c}))},je=Object(u.useCallback)(Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===de||void 0===de?void 0:de.isConnected(n.address,i.chainId).then((function(e){return ae(e),!!e||(l(Object(I.jsxs)(I.Fragment,{children:["Please make sure your signer wallet is unlocked, and connected with ",Object(I.jsx)("b",{children:n.address})," to the correct chain: ",Object(I.jsx)("b",{children:i.id})]})),!1)})).catch((function(e){return l("Could not check signer connection status: "+e.error),!1})));case 1:case"end":return e.stop()}}),e)}))),[i,l,n,de]),me=Object(u.useCallback)((function(){var e=0;return be(o,S,E,[]).forEach((function(t){t.sent&&e++})),e}),[o,S,E]),fe=Object(u.useCallback)(function(){var e=Object(m.a)(j.a.mark((function e(a){var c,s,r,l,d=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=d.length>1&&void 0!==d[1]&&d[1],e.next=3,je();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:if(s=o.find((function(e){return e.address===a}))){e.next=8;break}return e.abrupt("return");case 8:return r=P.encodeFunctionData("transfer",[t,new O.a(s.amount).toFixed(0)]),W((function(e){return e[a]=!0,Object(f.a)({},e)})),K(null),l=de.sendTransaction({from:n.address,to:a,data:r,gasLimit:8e4,gasPrice:re,chainId:i.chainId}).then(function(){var e=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C((function(e){return e[a]=Object(f.a)(Object(f.a)({},e[a]),{},{signing:!0}),Object(f.a)({},e)})),!c){e.next=7;break}return e.next=4,t.wait();case 4:F((function(e){return e[a]=!0,Object(f.a)({},e)})),W((function(e){return e[a]=!1,Object(f.a)({},e)})),C((function(e){return e[a]=Object(f.a)(Object(f.a)({},e[a]),{},{signing:!1}),Object(f.a)({},e)}));case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return W((function(e){return e[a]=!1,Object(f.a)({},e)})),e.message.includes("underpriced")?K("Transaction fee underpriced"):K(e.message),Y(!0),(!S[a]||S[a]&&!1!==S[a].signing)&&C((function(e){return e[a]=Object(f.a)(Object(f.a)({},e[a]),{},{signing:!1}),Object(f.a)({},e)})),!1})),e.abrupt("return",!!l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[de,t,S,o,re,i,n,je]),he=Object(u.useCallback)((function(){l(null),F([]),C([]),Y(!1),b(0)}),[l,C,F,b]),pe=Object(u.useCallback)((function(){he(),d()}),[he,d]);return Object(u.useEffect)((function(){ue(Object(U.a)({signer:n,signerExtra:c,chainId:i.chainId}))}),[i,n,c]),Object(u.useEffect)((function(){je()}),[je]),Object(u.useEffect)((function(){var e="".concat(v,"/gasPrice/").concat(i.id);Object(s.c)(e).then((function(e){var t=e.data.gasPrice[k];e.data.gasPrice.maxPriorityFeePerGas&&(t+=e.data.gasPrice.maxPriorityFeePerGas[k]),ie(t)})).catch((function(t){l(t.message+" "+e)}))}),[i,v,l,k]),Object(u.useEffect)((function(){if(ne&&Object.values(E).length&&re){var e=be(o,S,E,[]).map((function(e){return{address:e.address,signed:e.signing}})).find((function(e){return null===e.signed}));e&&setTimeout((function(){fe(e.address,!0)}),150)}}),[o,fe,S,E,ne,re]),Object(u.useEffect)((function(){if(o.length){var e={};o.forEach((function(t){e[t.address]=!1})),F(e)}}),[o,F]),Object(u.useEffect)((function(){q&&l("Every asset below needs to be sent to complete the migration"+(J?" ("+J+")":""))}),[q,l,J]),Object(u.useEffect)((function(){me()===o.length&&l(null)}),[me,o,l]),Object(u.useEffect)((function(){w||p(Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(D.a,{className:"clear",icon:Object(I.jsx)(x.Q,{}),onClick:function(){return he()},children:"Back"}),me()===be(o).length?Object(I.jsx)(D.a,{className:"primary",icon:Object(I.jsx)(x.R,{}),onClick:function(){return d()},children:"Close"}):Object(I.jsx)(D.a,{className:"primary disabled",icon:Object(I.jsx)(x.R,{}),children:"Complete"})]}))}),[he,pe,me,o,p,w,d]),w?Object(I.jsx)(I.Fragment,{}):Object(I.jsxs)("div",{children:[me()<be(o).length?Object(I.jsx)("div",{className:"small-asset-notification mb-3 warning",children:"".concat(be(o).length-me()," actions left to complete the migration")}):Object(I.jsx)("div",{className:"small-asset-notification mb-3 success",children:"Your tokens were migrated. You can close this window"}),be(o,S,E,_).map((function(e,t){return Object(I.jsxs)("div",{className:"migration-asset-row",children:[Object(I.jsx)("span",{className:"migration-asset-select-icon migration-asset-select-icon-permit",children:!e.icon||$.includes(e.icon)?Object(I.jsx)(g.d,{size:18}):Object(I.jsx)("img",{src:e.icon,draggable:"false",alt:"Token Icon",onError:function(t){Q((function(t){return[].concat(Object(h.a)(t),[e.icon])}))}})}),Object(I.jsx)("div",{className:"migration-asset-name",children:e.name}),Object(I.jsxs)("div",{className:"migration-asset-amount",children:[new O.a(e.amount).div(Math.pow(10,e.decimals)).toFixed()," ",Object(I.jsxs)("span",{className:"migration-asset-amount-usd",children:["($",(e.amount*e.rate).toFixed(2),")"]})]}),Object(I.jsx)("div",{className:"separator"}),Object(I.jsx)("div",{children:e.allowance&&y.ethers.BigNumber.from(e.allowance).gte(e.amount)||e.sent?Object(I.jsxs)("div",{className:"migration-permitted",onClick:function(){return fe(e.address)},children:[Object(I.jsx)(L.b,{})," Sent"]}):Object(I.jsx)(I.Fragment,{children:e.pending||e.signing?Object(I.jsxs)("div",{className:"migration-permitted warning",children:[Object(I.jsx)(L.d,{})," Sending..."]}):Object(I.jsx)(D.a,{className:"button-small secondary",onClick:function(){return fe(e.address)},children:"Send"})})})]},t)}))]})},W=function(e){var t,n=e.identityAccount,c=e.signer,r=e.signerExtra,i=e.network,o=e.nativeTokenData,l=e.setSelectedTokensWithAllowance,b=e.selectedTokensWithAllowance,f=e.setError,p=e.setStep,v=e.hasERC20Tokens,y=e.hideModal,k=e.relayerURL,w=e.setModalButtons,N=e.setBeforeCloseModalHandler,T=e.gasSpeed,S=e.hidden,C=Object(u.useState)([]),A=Object(a.a)(C,2),M=A[0],E=A[1],P=Object(u.useState)(!1),F=Object(a.a)(P,2),R=F[0],B=F[1],L=Object(u.useState)(!1),D=Object(a.a)(L,2),_=D[0],W=D[1],H=Object(u.useState)("0"),z=Object(a.a)(H,2),q=z[0],Y=z[1],G=Object(u.useState)(null),V=Object(a.a)(G,2),J=V[0],K=V[1],X=Object(u.useState)("0"),Z=Object(a.a)(X,2),$=Z[0],Q=Z[1],ee=Object(u.useState)("0"),te=Object(a.a)(ee,2),ne=te[0],ae=te[1],ce=Object(u.useState)(!1),se=Object(a.a)(ce,2),re=se[0],ie=se[1],oe=Object(u.useState)(null),le=Object(a.a)(oe,2),de=le[0],ue=le[1];try{t=Object(U.a)({signer:c,signerExtra:r,chainId:i.chainId})}catch(Oe){f("No Web3 wallet connected. Please connect a Web3 wallet and reload the page")}var be=Object(u.useCallback)((function(){p(0),l([])}),[l,p]),je=Object(u.useCallback)((function(){p(2)}),[p]),me=function(e){return e.filter((function(e){return e.selected&&!e.permittable&&!e.native})).length},fe=Object(u.useCallback)(Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return f(null),W(!0),v||N(null),e.next=7,t.isConnected(c.address,i.chainId).catch((function(e){f("Could not check signer connection status: "+e.error)}));case 7:e.sent?t.sendTransaction({from:c.address,to:n,gasLimit:25e3+("arbitrum"===i.id?2e5:0),gasPrice:de,value:"0x"+new O.a(q).toString(16),chainId:i.chainId}).then(function(){var e=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.wait();case 2:return B(!0),W(!1),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return B(!1),W(!1),e&&e.message.includes("must provide an Ethereum address")?f("Make sure your wallet is unlocked and connected with ".concat(c.address,".")):f("Native asset migration failed: "+e.message),!1})):(f(Object(I.jsxs)(I.Fragment,{children:["Please make sure your signer wallet is unlocked, and connected with ",Object(I.jsx)("b",{children:c.address})," to the correct chain: ",Object(I.jsx)("b",{children:i.id})]})),W(!1));case 9:case"end":return e.stop()}}),e)}))),[t,f,v,i,N,c,n,q,de]),he=Object(u.useCallback)((function(e){var t=new O.a(e).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals).replace(/\.?0+$/g,"");ae(t),Y(e),ie(!0)}),[o]);Object(u.useEffect)((function(){var e="".concat(k,"/gasPrice/").concat(i.id);Object(s.c)(e).then((function(e){var t=e.data.gasPrice[T];e.data.gasPrice.maxPriorityFeePerGas&&(t+=e.data.gasPrice.maxPriorityFeePerGas[T]);var n=25e3*t,a=me(b)*t*77e3;Q(new O.a((n+a).toFixed(0)).toFixed(0));var c=new O.a(o.availableBalance).minus(n+a);K(c.gte(0)?c.toFixed(0):0),ue(t)})).catch((function(t){f(t.message+" "+e)}))}),[Q,K,o,i,k,f,T,b]);var pe=Object(u.useCallback)((function(e){if(ie(!0),""===e)return ae(0),void Y(0);if(e.endsWith(".")&&2===e.split(".").length||2===e.split(".").length&&e.endsWith("0"))ae(e);else if(!isNaN(e)){var t=new O.a(e).toFixed(o.decimals);1===new O.a(t).multipliedBy(Math.pow(10,o.decimals)).comparedTo(o.availableBalance)&&(t=new O.a(o.availableBalance).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals)),t=t.replace(/\.?0+$/g,""),ae(t),Y(new O.a(t).multipliedBy(Math.pow(10,o.decimals)).toFixed(0))}}),[o]);return Object(u.useEffect)((function(){var e=new O.a(o.amount).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals).replace(/\.?0+$/g,"");ae(e),Y(o.amount)}),[o]),Object(u.useEffect)((function(){if(!S){w(function(){var e=[];return R?v?e.push(Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.R,{}),className:"primary full",onClick:function(){return je()},children:"Next"})):e.push(Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.i,{}),className:"primary full",onClick:function(){return y()},children:"Close"})):t?(e.push(Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.Q,{}),className:"clear",onClick:function(){return be()},children:"Back"},"0")),_?e.push(Object(I.jsxs)(d.e,{icon:Object(I.jsx)(d.m,{}),className:"primary disabled",children:["Moving ",o.name,"..."]},"1")):e.push(Object(I.jsxs)(d.e,{icon:Object(I.jsx)(x.R,{}),className:"primary",onClick:function(){return fe()},children:["Move ",o.name]},"1"))):e.push(Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.i,{}),className:"clear full",onClick:function(){return y()},children:"Close"})),e}())}}),[R,v,w,y,_,be,fe,je,t,o,S]),S?Object(I.jsx)(I.Fragment,{}):Object(I.jsx)("div",{children:t&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"migration-native-title mb-4",children:[Object(I.jsx)("div",{className:"migration-native-asset-icon",children:M.includes(o.icon)?Object(I.jsx)(g.d,{size:64}):Object(I.jsx)("img",{src:o.icon,draggable:"false",alt:"Token Icon",onError:function(e){E((function(e){return[].concat(Object(h.a)(e),[o.icon])}))}})}),Object(I.jsxs)("div",{className:"migration-native-title-asset-name",children:["Migrate native asset ",Object(I.jsx)("b",{children:o.name})]})]}),R?Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)("div",{className:"small-asset-notification success",children:["Migration of your ",o.name," was successful"]})}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"migration-native-row",children:[Object(I.jsx)("span",{className:"migration-native-row-key",children:"Current balance"}),Object(I.jsxs)("span",{className:"migration-native-selection",onClick:function(){return he(o.availableBalance)},children:[new O.a(o.availableBalance).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name]})]}),Object(I.jsxs)("div",{className:"migration-native-row",children:[Object(I.jsx)("span",{className:"migration-native-row-key",children:"Amount to migrate"}),re||null!==J&&q>J?Object(I.jsx)(d.w,{className:"migrate-amount-input",value:ne,onChange:pe}):Object(I.jsx)("div",{children:ne})]}),null!==J&&new O.a(q).gt(J)&&Object(I.jsxs)("div",{className:"notification-hollow warning mt-4",children:[Object(I.jsxs)("div",{children:[me(b)?"Signer transactions cost":"Current Transaction cost",": ~",new O.a($).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name,Object(I.jsxs)("span",{className:"migration-native-usd",children:[" ($",new O.a($).multipliedBy(o.rate).toFixed(2),")"]})]}),Object(I.jsx)("div",{className:"mt-3 mb-3",children:J>0?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("span",{children:"You should migrate up to "}),Object(I.jsxs)("span",{className:"migration-native-selection",onClick:function(){return he(J)},children:[new O.a(J).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name]}),Object(I.jsx)("span",{children:" because will you need funds to pay the transaction costs."})]}):Object(I.jsx)("span",{children:"You do not have enough funds to pay the transaction fee."})})]}),_&&v&&Object(I.jsx)("div",{className:"notification-hollow info mt-4",children:"Waiting for the transaction to be mined before continuing migration..."}),_&&!v&&Object(I.jsxs)("div",{className:"notification-hollow info mt-4",children:["The amount of ",o.name," will be updated in your wallet, once the transaction has been confirmed and mined. If you confirmed your transaction, you can already close this window"]})]})]})})},H=function(e){var t=e.addRequest,n=e.selectedAccount,c=e.accounts,s=e.network,r=e.hideModal,i=e.relayerURL,o=e.portfolio,l=e.setModalButtons,b=e.setModalSteps,j=e.setBeforeCloseModalHandler,m=Object(u.useState)([]),f=Object(a.a)(m,2),h=f[0],p=f[1],O=Object(u.useState)(null),v=Object(a.a)(O,2),g=v[0],y=v[1],k=Object(u.useState)(!1),w=Object(a.a)(k,2),N=w[0],T=w[1],S=Object(u.useState)(!1),C=Object(a.a)(S,2),A=C[0],M=C[1],P=Object(u.useState)(0),F=Object(a.a)(P,2),R=F[0],U=F[1],L=Object(u.useState)([]),D=Object(a.a)(L,2),H=D[0],z=D[1],q=Object(u.useState)(null),Y=Object(a.a)(q,2),G=Y[0],V=Y[1],J=Object(u.useState)(!1),K=Object(a.a)(J,2),X=K[0],Z=K[1],$=Object(u.useState)(null),Q=Object(a.a)($,2),ee=Q[0],te=Q[1],ne=c.find((function(e){return e.id===n}));return Object(u.useEffect)((function(){0===R&&(V(null),p([]),y(null),T(!1),te(null),j(null))}),[s,n,R,j]),Object(u.useEffect)((function(){A&&(M(!1),y(h.find((function(e){return e.native}))),T(!!h.find((function(e){return!e.native}))))}),[A,ne,h,s,n]),Object(u.useEffect)((function(){var e=R;R>0&&!g&&(e-=1),b({steps:H.map((function(e){return{name:e}})),stepIndex:e})}),[g,b,R,H]),Object(u.useEffect)((function(){var e=function(){Z(!0),l([Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.Q,{}),className:"clear",onClick:function(){return Z(!1)},children:"Back"},"0"),Object(I.jsx)(d.e,{icon:Object(I.jsx)(x.i,{}),className:"danger",onClick:function(){return r()},children:"Close"},"1")])};R>0&&j((function(){return e}))}),[R,j,l,r,X]),Object(I.jsxs)("div",{children:[G&&Object(I.jsx)("div",{className:"mt-3 error",children:G}),Object(I.jsxs)("div",{id:"assets-migration",children:[X&&Object(I.jsx)("div",{className:"notification-hollow warning mt-4",children:"By closing this window, your progress will be lost. Are you sure you want to close this window?"}),0===R&&Object(I.jsx)(B,{hidden:X,signerAccount:ne.signer.address,identityAccount:n,network:s,PERMITTABLE_COINS:E,setIsSelectionConfirmed:M,setStep:U,portfolio:o,relayerURL:i,setModalButtons:l,hideModal:r,setError:V,setSelectedTokensWithAllowance:p,setStepperSteps:z,setGasSpeed:te}),1===R&&g&&Object(I.jsx)(W,{hidden:X,signer:ne.signer,identityAccount:n,network:s,addRequest:t,signerExtra:ne.signerExtra,setError:V,nativeTokenData:g,hideModal:r,setStep:U,relayerURL:i,hasERC20Tokens:N,setModalButtons:l,setSelectedTokensWithAllowance:p,selectedTokensWithAllowance:h,setBeforeCloseModalHandler:j,gasSpeed:ee}),2===R&&Object(I.jsx)(_,{hidden:X,signer:ne.signer,identityAccount:n,network:s,addRequest:t,PERMITTABLE_COINS:E,signerExtra:ne.signerExtra,setError:V,selectedTokensWithAllowance:h,hideModal:r,setStep:U,setModalButtons:l,gasSpeed:ee,relayerURL:i})]})]})},z=function(e){var t=e.addRequest,n=e.selectedAccount,c=e.selectedNetwork,s=e.accounts,r=e.relayerURL,i=e.portfolio,o=Object(l.f)(),b=o.hideModal,j=o.setBeforeCloseModalHandler,m=Object(u.useState)(null),f=Object(a.a)(m,2),h=f[0],p=f[1],O=Object(u.useState)({steps:[],stepIndex:0}),v=Object(a.a)(O,2),g=v[0],x=v[1];return Object(I.jsx)(d.n,{id:"asset-migration-modal",title:Object(I.jsxs)("div",{children:[Object(I.jsx)("span",{children:"Migrate Assets"}),Object(I.jsx)(d.v,{steps:g.steps,currentStep:g.stepIndex,noLabels:!1})]}),buttons:h,children:Object(I.jsx)(H,{addRequest:t,selectedAccount:n,network:c,accounts:s,hideModal:b,relayerURL:r,portfolio:i,setModalButtons:p,setModalSteps:x,setBeforeCloseModalHandler:j})})};t.a=function(e){var t,n,c=e.addRequest,s=e.selectedAccount,r=e.accounts,i=e.selectedNetwork,d=e.relayerURL,b=e.portfolio,j=e.closeable,m=void 0!==j&&j,f=e.linkMargin,h=void 0!==f&&f,p=e.useStorage,O=Object(u.useState)(!1),v=Object(a.a)(O,2),g=v[0],x=v[1],y=Object(u.useState)(!1),k=Object(a.a)(y,2),w=k[0],N=k[1],T=Object(l.f)().showModal,S=p({key:"migrationSeen",defaultValue:{}}),C=Object(a.a)(S,2),A=C[0],M=C[1],E=r.find((function(e){return e.id===s}));try{n=Object(U.a)({signer:E.signer,signerExtra:E.signerExtra,chainId:i.chainId})}catch(F){}var P=Object(u.useCallback)((function(){N(!0),M((function(e){return e[s+i.id]=!0,e}))}),[s,i,M]);Object(u.useEffect)((function(){var e=!1;x(!1);return function(t){var n=t.networkId,a=t.identityAccount,c=t.accounts.find((function(e){return e.id===a}));c.signer&&o({networkId:n,account:c.signer.address}).then((function(t){if(!e){var n=t.filter((function(e){return e.balanceUSD>.001}));x(!!n.length)}})).catch((function(e){console.error(e)}))}({identityAccount:s,networkId:i.id,accounts:r}),function(){return e=!0}}),[s,i,r]),Object(u.useEffect)((function(){N(m&&!!A[s+i.id])}),[m,s,i,A]);return(null===(t=n)||void 0===t?void 0:t.provider)||E.signerExtra&&["ledger","trezor","Lattice"].includes(E.signerExtra.type)?g&&!w&&Object(I.jsxs)("div",{className:"migration-banner",children:[Object(I.jsxs)("div",{className:"migration-banner-message",children:[Object(I.jsx)("div",{children:"We detected that your signer account has tokens that can be transferred to your Ambire account. We recommend doing this in order to maximize your $WALLET rewards."}),Object(I.jsx)("span",{className:"link"+(h?" link-margin":""),onClick:function(){T(Object(I.jsx)(z,{addRequest:c,selectedNetwork:i,selectedAccount:s,accounts:r,relayerURL:d,portfolio:b}))},children:"Click here to migrate those tokens"})]}),m&&Object(I.jsx)("div",{className:"migration-banner-close",children:Object(I.jsx)(L.i,{onClick:function(){return P()}})})]}):Object(I.jsx)(I.Fragment,{})}}}]);
//# sourceMappingURL=13.fb9deefc.chunk.js.map