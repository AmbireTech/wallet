(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[27],{1606:function(e,s,t){},1639:function(e,s,t){"use strict";t.r(s);var r=t(7),n=t(3),c=t.n(n),a=t(12),o=t(9),i=(t(1606),t(34)),d=t(62),u=t(20),l=t(2),b=t(209),j=t(534),m=t(212),f=t(46),h=t(85),p=["function name() view returns (string memory)","function tokenURI(uint256 _tokenId) view returns (string memory)","function uri(uint256 _tokenId) view returns (string memory)","function ownerOf(uint256 tokenId) view returns (address)","function transferFrom(address from, address to, uint256 tokenId)"],O=t(57),w=t(620),x=t(97),g=t(110),v=t(93),k=t(217),N=t(218),y=t(4),I=new u.Interface(p),S=function(e){return(e=e.startsWith("data:application/json")?e.replace("data:application/json;utf8,",""):e).startsWith("ipfs://")?e.replace(/ipfs:\/\/ipfs\/|ipfs:\/\//g,"https://ipfs.io/ipfs/"):e.split("/")[2].endsWith("mypinata.cloud")?"https://ipfs.io/ipfs/"+e.split("/").slice(4).join("/"):e};s.default=function(e){var s=e.selectedAcc,t=e.selectedNetwork,n=e.addRequest,u=e.addressBook,T=u.addresses,U=u.addAddress,A=u.removeAddress,C=u.isKnownAddress,E=Object(f.a)().addToast,R=Object(i.useParams)(),L=R.network,_=R.collectionAddr,D=R.tokenId,Y=Object(l.useState)(!0),W=Object(o.a)(Y,2),F=W[0],B=W[1],J=Object(l.useState)({owner:{address:"",icon:""},name:"",description:"",image:"",collection:"",explorerUrl:""}),z=Object(o.a)(J,2),K=z[0],P=z[1],V=Object(l.useState)(""),q=Object(o.a)(V,2),G=q[0],H=q[1],M=Object(l.useState)(""),Q=Object(o.a)(M,2),X=Q[0],Z=Q[1],$=Object(l.useState)(""),ee=Object(o.a)($,2),se=ee[0],te=ee[1],re=Object(l.useState)(!0),ne=Object(o.a)(re,2),ce=ne[0],ae=ne[1],oe=Object(l.useState)(!1),ie=Object(o.a)(oe,2),de=ie[0],ue=ie[1],le=Object(l.useState)(null),be=Object(o.a)(le,2),je=be[0],me=be[1],fe=Object(l.useState)({success:!1,message:""}),he=Object(o.a)(fe,2),pe=he[0],Oe=he[1],we=Object(l.useRef)(null);Object(l.useEffect)((function(){if(G.startsWith("0x")&&-1===G.indexOf(".")){var e=Object(w.b)(G,s,de,C,K,t,L);ae(!e.success),Oe({success:e.success,message:e.message?e.message:""})}else{we.current&&clearTimeout(we.current);var r=function(){var e=Object(a.a)(c.a.mark((function e(){var r,n,a,o,i,d,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(G,null,t.unstoppableDomainsChain);case 2:return r=e.sent,n=Object(N.a)(null),e.next=6,Object(N.b)(G,n);case 6:a=e.sent,we.current=null,o=!!r,d="",d=(i=!!a)?a:o?r:G,u=Object(w.b)(d,s,de,C,K,t,L,o,i),Z(r),te(a),ae(!u.success),Oe({success:u.success,message:u.message?u.message:""});case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();we.current=setTimeout(Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r().catch(console.error));case 1:case"end":return e.stop()}}),e)}))),300)}return function(){return clearTimeout(we.current)}}),[G,K,t,s,L,de,C]);var xe=Object(l.useCallback)(Object(a.a)(c.a.mark((function e(){var s,t,n,a,i,u,l,b,j,f,h,w,k,N,y,I,T,U,A,C,R,Y,W,F,J;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B(!0),P({}),e.prev=2,s=O.a.find((function(e){return e.id===L}))){e.next=6;break}throw new Error("This network is not supported");case 6:return t=s.explorerUrl,n=Object(x.a)(s.id),a=new d.ethers.Contract(_,p,n),e.next=11,Promise.all([a.name(),a.ownerOf(D),a.tokenURI(D).then((function(e){return{uri:e}})).catch((function(e){return{err:e}})),a.uri(D).then((function(e){return{uri:e}})).catch((function(e){return{err:e}}))]);case 11:if(i=e.sent,u=Object(o.a)(i,4),l=u[0],b=u[1],j=u[2],f=u[3],h=j.uri||f.uri){e.next=20;break}throw j.err||f.err;case 20:if(w={},!h.startsWith("data:application/json")){e.next=25;break}w=JSON.parse(h.replace("data:application/json;utf8,","")),e.next=32;break;case 25:return k=S(h),e.next=28,fetch(k);case 28:return N=e.sent,e.next=31,N.json();case 31:w=e.sent;case 32:y=w?S(w.image):null,P((function(e){return Object(r.a)(Object(r.a)(Object(r.a)({},e),w),{},{image:y})})),P((function(e){return Object(r.a)(Object(r.a)({},e),{},{collection:l,owner:{address:b,icon:m.create({seed:b}).toDataURL()},explorerUrl:t})})),B(!1),e.next=65;break;case 38:return e.prev=38,e.t0=e.catch(2),e.prev=40,e.next=43,Object(v.c)("".concat(g.h,"/nftmeta/").concat(_,"/").concat(D,"?network=").concat(L));case 43:if(I=e.sent,T=I.success,U=I.collection,A=I.description,C=I.image,R=I.name,Y=I.owner,W=I.message,T){e.next=53;break}throw new Error(W);case 53:if(F=O.a.find((function(e){return e.id===L}))){e.next=56;break}throw new Error("This network is not supported");case 56:J=F.explorerUrl,P((function(e){return Object(r.a)(Object(r.a)({},e),{},{collection:U,description:A,image:C,name:R,owner:{address:Y,icon:m.create({seed:Y}).toDataURL()},explorerUrl:J})})),B(!1),e.next=65;break;case 61:e.prev=61,e.t1=e.catch(40),console.error(e.t1),E("Collectible error: ".concat(e.t1.message||e.t1),{error:!0});case 65:case"end":return e.stop()}}),e,null,[[2,38],[40,61]])}))),[E,D,_,L]);return Object(l.useEffect)((function(){return xe()}),[xe]),Object(y.jsxs)("div",{id:"collectible",children:[Object(y.jsxs)(h.s,{className:"panel",children:[Object(y.jsxs)("div",{className:"heading",children:[Object(y.jsxs)("div",{className:"title",children:[K.collection," #",D]}),Object(y.jsxs)("div",{className:"contract",children:["Contract address: ",Object(y.jsx)("a",{className:"address",href:"".concat(K.explorerUrl,"/address/").concat(_),target:"_blank",rel:"noreferrer",children:_})]})]}),F?Object(y.jsx)(h.n,{}):Object(y.jsxs)("div",{className:"metadata",children:[Object(y.jsx)("div",{className:"image",style:{backgroundImage:"url(".concat(S(K.image),")")},children:K.image?null:Object(y.jsx)(j.i,{})}),Object(y.jsxs)("div",{className:"info",children:[Object(y.jsx)("div",{className:"name",children:K.name}),Object(y.jsx)("div",{className:"description",children:K.description})]}),Object(y.jsxs)("div",{className:"owner",children:["Owner:",Object(y.jsxs)("a",{className:"address",href:"".concat(K.explorerUrl,"/address/").concat(K.owner.address),target:"_blank",rel:"noreferrer",children:[Object(y.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(K.owner.icon,")")}}),K.owner.address===s?Object(y.jsxs)("span",{children:["You (",K.owner.address,")"]}):K.owner.address]})]})]})]}),Object(y.jsx)(h.s,{title:"Transfer",className:"panel",children:Object(y.jsxs)("div",{className:"content",children:[Object(y.jsxs)("div",{id:"recipient-address",children:[Object(y.jsx)(h.z,{className:"recipient-input",placeholder:"Recipient Address",value:G,onInput:function(e){return H(e)}}),Object(y.jsx)(h.B,{label:se?"Valid Ethereum Name Services\u24c7 domain":"You can use Ethereum Name Service\u24c7",children:Object(y.jsx)("div",{id:"ens-logo",className:se?"ens-logo-active ":""})}),Object(y.jsx)(h.B,{label:X?"Valid Unstoppable domains\u24c7 domain":"You can use Unstoppable domains\u24c7",children:Object(y.jsx)("div",{id:"udomains-logo",className:X?"ud-logo-active ":""})}),Object(y.jsx)(h.a,{addresses:T.filter((function(e){return e.address!==s})),addAddress:U,removeAddress:A,newAddress:je,onClose:function(){return me(null)},onSelectAddress:function(e){return H(e)},selectedNetwork:t,className:"address-book"})]}),pe.message&&Object(y.jsxs)("div",{className:"validation-error",children:[Object(y.jsx)(j.k,{size:12}),"\xa0",pe.message]}),Object(y.jsx)("div",{className:"separator"}),Object(y.jsx)(h.b,{address:X||(se||G),onAddNewAddress:function(){return me(X||(se||G))},onChange:function(e){return ue(e)},isKnownAddress:C}),Object(y.jsx)(h.e,{icon:Object(y.jsx)(b.h,{}),disabled:ce,onClick:function(){var e=X||(se||G);try{var r={id:"transfer_nft_".concat(Date.now()),type:"eth_sendTransaction",chainId:t.chainId,account:s,txn:{to:_,value:"0",data:I.encodeFunctionData("transferFrom",[K.owner.address,e,D])},meta:null};X?r.meta={addressLabel:{addressLabel:G,address:X}}:se&&(r.meta={addressLabel:{addressLabel:G,address:se}}),n(r)}catch(c){console.error(c),E("Error: ".concat(c.message||c),{error:!0})}},children:"Send"})]})})]})}},620:function(e,s,t){"use strict";t.d(s,"a",(function(){return o})),t.d(s,"b",(function(){return u})),t.d(s,"c",(function(){return i})),t.d(s,"d",(function(){return d}));var r=t(20),n=t(100),c=t(146),a=function(e){return e&&e.length?e&&Object(n.b)(e)?{success:!0}:{success:!1,message:"Invalid address."}:{success:!1,message:""}},o=function(e,s){var t=a(e);return t.success?e&&s&&e===s?{success:!1,message:"The entered address should be different than the your own account address."}:{success:!0}:t},i=function(e,s,t,r,o,i){var d=a(e);return d.success?e&&e===c.a.feeCollector?{success:!0}:e&&s&&e===s?{success:!1,message:"The entered address should be different than the your own account address."}:e&&Object(n.a)(e)?{success:!1,message:"You are trying to send tokens to a smart contract. Doing so would burn them."}:!e||r(e)||t||o||i?!e||r(e)||t||!o&&!i?{success:!0}:{success:!1,message:"You're trying to send to an ".concat(o?"Unstoppable domain":"Ethereum Name Service",". If you really trust to the person who gave you, confirm using the checkbox below.")}:{success:!1,message:"You're trying to send to an unknown address. If you're really sure, confirm using the checkbox below."}:d},d=function(e,s){if(!e||!e.length)return{success:!1,message:""};if(!(e&&e>0))return{success:!1,message:"The amount must be greater than 0."};try{if(e&&s&&s.decimals){var t=e.slice(0,e.indexOf(".")+s.decimals+1),n=Object(r.parseUnits)(t,s.decimals);if(n&&s.balanceRaw&&n.gt(s.balanceRaw))return{success:!1,message:"The amount is greater than the asset's balance: ".concat(null===s||void 0===s?void 0:s.balance," ").concat(null===s||void 0===s?void 0:s.symbol,".")}}}catch(c){console.error(c)}return{success:!0}},u=function(e,s,t,r,n,c,a,o,d){var u,l=i(e,s,t,r,o,d);return l.success?n&&s&&(null===(u=n.owner)||void 0===u?void 0:u.address.toLowerCase())!==s.toLowerCase()?{success:!1,message:"The NFT you're trying to send is not owned by you!"}:c&&a&&c.id!==a?{success:!1,message:"The selected network is not the correct one."}:{success:!0}:l}}}]);
//# sourceMappingURL=27.3a3d9fc3.chunk.js.map