(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[20],{1580:function(e,n,t){},1581:function(e,n,t){},1584:function(e,n,t){},1603:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return W}));var a=t(8),i=(t(1580),t(3)),r=t(36),c=t(794),s=t.n(c),o=t(248),d=(t(1581),t.p+"static/media/ramp.26a99e26.svg"),l=t.p+"static/media/paytrie.338f7c3b.svg",u=t.p+"static/media/transak.e01c0265.svg",m=t.p+"static/media/kriptomat.4c8e4fc1.svg",f=t.p+"static/media/guardarian.5b666fba.svg",b=t(79),j=t(2),p=t.n(j),v=t(7),h=t(17),O=t(11),g=t(1582),x=t(1583),y=t.n(x),w=function(e){var n=e.url,t=e.title,a=e.w,i=e.h,r=void 0!==window.screenLeft?window.screenLeft:window.screenX,c=void 0!==window.screenTop?window.screenTop:window.screenY,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,d=s/window.screen.availWidth,l=(s-a)/2/d+r,u=(o-i)/2/d+c,m=window.open(n,t,"\n\t\ttoolbar=no,scrollbars=no,resizable=no\n\t\twidth=".concat(a/d,", \n\t\theight=").concat(i/d,", \n\t\ttop=").concat(u,", \n\t\tleft=").concat(l,",\n\t\t"));window.focus&&m.focus()},k=t(85),T=t(44),C=t(37),S=(t(1584),[{label:"EUR",value:"EUR",icon:"https://changenow.io/images/sprite/currencies/eur.svg"},{label:"GBP",value:"GBP",icon:"https://changenow.io/images/sprite/currencies/gbp.svg"},{label:"USD",value:"USD",icon:"https://changenow.io/images/sprite/currencies/usd.svg"}]),N={ethereum:"ETH","binance-smart-chain":"BSC",polygon:"MATIC",fantom:"FTM",avalanche:"AVAX"},A={ethereum:"ETH","binance-smart-chain":"BNB",polygon:"MATIC",fantom:"FTM",avalanche:"AVAX"},E="0x"+"0".repeat(40),M=function(e){var n=e.relayerURL,t=e.selectedNetwork,r=e.initMode,c=e.tokens,s=e.walletAddress,o="".concat(n,"/guardarian/currencies/fiat"),d="".concat(n,"/guardarian/currencies/crypto"),l=S,u=Object(T.a)().addToast,m=Object(i.useState)(t),f=Object(a.a)(m,2),b=f[0],j=f[1],p=Object(i.useState)(""),v=Object(a.a)(p,2),h=v[0],O=v[1],g=Object(i.useState)(""),x=Object(a.a)(g,2),y=x[0],w=x[1],C=Object(i.useState)(r),M=Object(a.a)(C,2),F=M[0],L=M[1],U=Object(i.useState)("50"),I=Object(a.a)(U,2),R=I[0],B=I[1],D=Object(i.useState)({data:[]}),_=Object(a.a)(D,2),P=_[0],W=_[1],G=Object(i.useState)({data:[]}),H=Object(a.a)(G,2),Y=H[0],q=H[1],V=Object(i.useState)(null),K=Object(a.a)(V,2),$=K[0],X=K[1],z=Object(i.useState)({data:null,isLoading:!1}),J=Object(a.a)(z,2),Q=J[0],Z=J[1],ee=Object(i.useMemo)((function(){var e,n;return"buy"===F?{data:(null===P||void 0===P||null===(e=P.data)||void 0===e?void 0:e.filter((function(e){return e.networks.find((function(e){return e.network===N[b]&&e.payment_methods.some((function(e){return e.withdrawal_enabled}))}))})).map((function(e){return{label:e.ticker,value:e.ticker,icon:e.logo_url}})).filter((function(e){return e.value})))||[],isLoading:null===P||void 0===P?void 0:P.isLoading}:"sell"===F?{data:(null===P||void 0===P||null===(n=P.data)||void 0===n?void 0:n.filter((function(e){return e.networks.find((function(e){return e.network===N[b]&&e.payment_methods.some((function(e){return e.deposit_enabled}))&&c.find((function(n){var t,a;return(null===n||void 0===n||null===(t=n.address)||void 0===t?void 0:t.toLowerCase())===(null===e||void 0===e||null===(a=e.token_contract)||void 0===a?void 0:a.toLowerCase())||(null===n||void 0===n?void 0:n.address)===E&&null===(null===e||void 0===e?void 0:e.token_contract)}))}))})).map((function(e){return{label:e.ticker,value:e.ticker,icon:e.logo_url}})).filter((function(e){return e.value})))||[],isLoading:P.isLoading}:void 0}),[F,P,b,c]),ne=Object(i.useMemo)((function(){var e;return"buy"===F?{data:(null===Y||void 0===Y||null===(e=Y.data)||void 0===e?void 0:e.map((function(e){var n;return{label:e.ticker,value:e.ticker,icon:e.logo_url||"https://changenow.io/images/sprite/currencies/".concat(null===e||void 0===e||null===(n=e.ticker)||void 0===n?void 0:n.toLowerCase(),".svg")}})))||[],isLoading:null===Y||void 0===Y?void 0:Y.isLoading}:"sell"===F?{data:l,isLoading:!1}:void 0}),[F,Y,l]);Object(i.useEffect)((function(){"buy"===F?(B("50"),O(ne.data&&ne.data[0]?ne.data[0].value:null),w(A[b])):"sell"===F&&(B(""),O(ee.data&&ee.data[0]?ee.data[0].value:null),w(ne.data&&ne.data[0]?ne.data[0].value:null))}),[F,ne,ee,b]),Object(i.useEffect)((function(){q({data:null,isLoading:!0}),Object(k.c)(o).then((function(e){return q({data:e,isLoading:!1,error:{},message:""})})).catch((function(e){q({data:null,isLoading:!1,error:e,message:"Error while fetching fiat list"}),u("Error while fetching fiat list",{error:!0})}))}),[o,u]),Object(i.useEffect)((function(){W({data:null,isLoading:!0}),Object(k.c)(d).then((function(e){W({data:e,isLoading:!1,error:{},message:""})})).catch((function(e){W({data:null,isLoading:!1,error:e,message:"Error while fetching crypto list"}),u("Error while fetching crypto list",{error:!0})}))}),[b,d,u]);var te=Object(i.useCallback)((function(){var e="buy"===F?"".concat(h,"_").concat(y,"-").concat(N[b]):"sell"===F?"".concat(h,"-").concat(N[b],"_").concat(y):null;return e?"".concat(n,"/guardarian/market-info/").concat(e):null}),[F,h,y,b,n]);Object(i.useEffect)((function(){if(!b||!h||!y||!F)return X({data:null,isLoading:!1});X({data:null,isLoading:!0});var e=te(),n=!1;return Object(k.c)(e).then((function(e){var t=e.data;return!n&&X({data:t,isLoading:!1})})).catch((function(e){return!n&&(X({data:null,isLoading:!1,error:e,message:"Error while fetching market info"}),u("Error while fetching market info",{error:!0}))})),function(){n=!0}}),[b,F,h,y,u,te]);var ae=Object(i.useCallback)((function(){return"buy"===F?"".concat(n,"/guardarian/estimate/").concat(h,"/").concat(b,"/").concat(R,"/").concat(y,"/","true"):"".concat(n,"/guardarian/estimate/").concat(h,"/").concat(b,"/").concat(R,"/").concat(y,"/","false")}),[F,n,h,b,R,y]);return Object(i.useEffect)((function(){if(!b||!h||!y||!F||!R)return Z({data:null,isLoading:!1});Z({data:null,isLoading:!0});var e=ae(),n=!1;return Object(k.c)(e).then((function(e){var t=e.data;return!n&&Z({data:t,isLoading:!1})})).catch((function(e){return!n&&(Z({data:null,isLoading:!1,error:e,message:"Error while fetching estimate info"}),u("Error while fetching estimate info",{error:!0}))})),function(){n=!0}}),[b,F,h,y,R,u,ae]),{marketInfo:$,estimateInfo:Q,cryptoList:ee,fiatList:ne,network:b,from:h,to:y,mode:F,amount:R,cryptoCurrencies:P,setNetwork:j,setFrom:O,setTo:w,setMode:L,setAmount:B,genTxnUrl:function(){return"buy"===F?"".concat(n,"/guardarian/transaction/").concat(h,"/null/").concat(R,"/").concat(y,"/").concat(t,"/").concat(s):"".concat(n,"/guardarian/transaction/").concat(h,"/").concat(t,"/").concat(R,"/").concat(y,"/null/null")},NETWORK_MAPPING:N,NATIVE_ADDRESS:E,DEFAULT_CRYPTO:A}},F=t(217),L=t.n(F),U=t(4),I=function(e){var n,t,c,s,o,d,l,u,m,f,j,p,v,h,O,g,x,y,S,N=e.relayerURL,A=e.walletAddress,E=e.selectedNetwork,F=e.portfolio,I=Object(C.f)().hideModal,R=Object(T.a)().addToast,B=M({relayerURL:N,selectedNetwork:E,initMode:"buy",tokens:F.tokens,walletAddress:A,addToast:R}),D=Object(i.useState)(!1),_=Object(a.a)(D,2),P=_[0],W=_[1],G=Object(i.useCallback)((function(){var e;if(F.tokens&&(null===B||void 0===B||null===(e=B.cryptoCurrencies)||void 0===e?void 0:e.data)&&"sell"===B.mode){var n,t,a,i=null===B||void 0===B||null===(n=B.cryptoCurrencies)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.find((function(e){return e.ticker===B.from}));return null===F||void 0===F||null===(a=F.tokens)||void 0===a?void 0:a.find((function(e){var n;return null===i||void 0===i||null===(n=i.networks)||void 0===n?void 0:n.find((function(n){var t,a;return(null===n||void 0===n||null===(t=n.token_contract)||void 0===t?void 0:t.toLowerCase())===(null===e||void 0===e||null===(a=e.address)||void 0===a?void 0:a.toLowerCase())||(null===n||void 0===n?void 0:n.network)===B.NETWORK_MAPPING[B.network]&&(null===e||void 0===e?void 0:e.address.toLowerCase())===B.NATIVE_ADDRESS&&null===(null===n||void 0===n?void 0:n.token_contract)}))}))}return{}}),[B,F.tokens]),H=Object(i.useMemo)((function(){var e,n,t,a=null===B||void 0===B||null===(e=B.marketInfo)||void 0===e?void 0:e.data;if((null===B||void 0===B||null===(n=B.marketInfo)||void 0===n?void 0:n.error)||(null===B||void 0===B||null===(t=B.estimateInfo)||void 0===t?void 0:t.error))return"Sorry! We couldn't estimate your order! Please try again later!";if(!a)return"";var i=parseFloat(B.amount),r=parseFloat(a.min),c=parseFloat(a.max);if("buy"===B.mode){if(i<r)return"Minimum amount is ".concat(a.min," ").concat(a.from);if(i>c)return"Maximum amount is ".concat(a.max," ").concat(a.from)}else if("sell"===B.mode){var s=G();if(i<r)return"Minimum amount is ".concat(a.min," ").concat(a.from);if(i>c)return"Maximum amount is ".concat(a.max," ").concat(a.from);if(s&&(null===B||void 0===B?void 0:B.from)&&i>s.balance)return"You do not have enough funds"}return""}),[B,G]),Y=function(){B.setMode((function(e){return"buy"===e?"sell":"buy"})),B.setAmount(""),B.setFrom(""),B.setTo("buy"===B.mode?B.DEFAULT_CRYPTO[B.NETWORK_MAPPING[B.network]]:"")};var q=Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(b.e,{clear:!0,icon:Object(U.jsx)(r.I,{}),onClick:function(){return I()},children:"Close"}),Object(U.jsx)(b.e,{disabled:""!==H||(null===B||void 0===B||null===(n=B.marketInfo)||void 0===n?void 0:n.isLoading)||(null===B||void 0===B||null===(t=B.estimateInfo)||void 0===t?void 0:t.isLoading)||(null===B||void 0===B||null===(c=B.txn)||void 0===c?void 0:c.isLoading)||""===(null===B||void 0===B?void 0:B.amount)||P,onClick:function(){W(!0),Object(k.c)(B.genTxnUrl()).then((function(e){var n=e.data;W(!1),(null===n||void 0===n?void 0:n.redirect_url)&&w({url:L.a.format(null===n||void 0===n?void 0:n.redirect_url),title:"Guardarian Deposit",w:560,h:710})})).catch((function(e){R("Error while trying to send transaction",{error:!0}),W(!1)}))},children:"buy"===B.mode?"Buy":"Sell"})]});return Object(U.jsxs)(b.n,{id:"guardarian-modal",title:"Guardarian",buttons:q,children:[Object(U.jsxs)("div",{className:"buy-sell-btns-wrapper",children:[Object(U.jsx)("div",{className:"buy"===B.mode?"button active":"button",onClick:Y,children:"Buy"}),Object(U.jsx)("div",{className:"sell"===B.mode?"button active":"button",onClick:Y,children:"Sell"})]}),Object(U.jsxs)("div",{className:"input-currencies-wrapper",children:[Object(U.jsx)("div",{className:"amount",children:Object(U.jsx)(b.w,{value:B.amount,label:"You send",placeholder:"Input amount",onInput:function(e){B.setAmount(e)}})}),Object(U.jsx)("div",{className:"currency",children:"buy"===B.mode&&!(null===B||void 0===B||null===(s=B.fiatList)||void 0===s?void 0:s.isLoading)||"sell"===(null===B||void 0===B?void 0:B.mode)&&!(null===B||void 0===B||null===(o=B.cryptoList)||void 0===o?void 0:o.isLoading)?Object(U.jsx)(b.t,{searchable:!0,defaultValue:B.from,items:"buy"===B.mode?B.fiatList.data:B.cryptoList.data,onChange:function(e){return function(e){B.setFrom(e)}(e.value)}}):Object(U.jsxs)("div",{className:"loading-wrapper",children:[Object(U.jsx)(b.m,{})," "]})})]}),""!==H&&Object(U.jsx)("p",{style:{color:"red"},children:H}),Object(U.jsxs)("div",{className:"estimation-info-wrapper",children:[Object(U.jsx)("div",{className:"extra-fees",children:Object(U.jsx)(b.y,{label:"All the exchange fees are added into the rate. There are no extra costs.",children:"No extra fees"})}),Object(U.jsx)("div",{className:"estimation-rate",children:Object(U.jsxs)(b.y,{label:"This is expected rate. Guardarian guarantees to pick up the best possible rate on the moment of the exchange",children:["Estimation rate: "," ",!B.estimateInfo.isLoading&&(null===B||void 0===B||null===(d=B.estimateInfo)||void 0===d?void 0:d.data)&&""===H?Object(U.jsxs)(U.Fragment,{children:[1+(null===B||void 0===B||null===(l=B.estimateInfo)||void 0===l||null===(u=l.data)||void 0===u?void 0:u.from_currency)," \u2248 ",null===B||void 0===B||null===(m=B.estimateInfo)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.estimated_exchange_rate," ",null===B||void 0===B||null===(j=B.estimateInfo)||void 0===j||null===(p=j.data)||void 0===p?void 0:p.to_currency]}):Object(U.jsx)(U.Fragment,{})]})})]}),Object(U.jsxs)("div",{className:"input-currencies-wrapper",children:[Object(U.jsx)("div",{className:"amount",children:B.estimateInfo.isLoading?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("label",{children:"You get"}),Object(U.jsxs)("div",{className:"loading-wrapper",children:[Object(U.jsx)(b.m,{})," "]})]}):Object(U.jsx)(b.w,{value:(null===B||void 0===B||null===(v=B.estimateInfo)||void 0===v?void 0:v.data)?null===B||void 0===B||null===(h=B.estimateInfo)||void 0===h||null===(O=h.data)||void 0===O?void 0:O.value:"",disabled:!0,label:"You get"})}),Object(U.jsx)("div",{className:"currency",children:"buy"===(null===B||void 0===B?void 0:B.mode)&&!(null===B||void 0===B||null===(g=B.cryptoList)||void 0===g?void 0:g.isLoading)||"sell"===(null===B||void 0===B?void 0:B.mode)&&!(null===B||void 0===B||null===(x=B.fiatList)||void 0===x?void 0:x.isLoading)?Object(U.jsx)(b.t,{searchable:!0,defaultValue:null===B||void 0===B?void 0:B.to,items:"sell"===(null===B||void 0===B?void 0:B.mode)?null===B||void 0===B||null===(y=B.fiatList)||void 0===y?void 0:y.data:null===B||void 0===B||null===(S=B.cryptoList)||void 0===S?void 0:S.data,onChange:function(e){return function(e){B.setTo(e)}(e.value)}}):Object(U.jsxs)("div",{className:"loading-wrapper",children:[Object(U.jsx)(b.m,{})," "]})})]})]})},R=t(106),B=function(e){var n=e.walletAddress,t=e.selectedNetwork,r=e.relayerURL,c=e.portfolio,s=Object(i.useState)([]),o=Object(a.a)(s,2),d=o[0],l=o[1],u=Object(T.a)().addToast,m=Object(C.f)().showModal,f=function(){var e=Object(O.a)(p.a.mark((function e(){var a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l((function(e){return["PayTrie"].concat(Object(h.a)(e))})),a={ethereum:"USDC",polygon:"USDC-P","binance-smart-chain":"USDT-B"},(i=L.a.parse(R.b,!0)).search=null,i.query=Object(v.a)(Object(v.a)({},i.query),{},{addr:n,rightSideLabel:a[t]}),w({url:L.a.format(i),title:"Paytrie Deposit",w:450,h:700}),l((function(e){return e.filter((function(e){return"PayTrie"!==e}))}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(O.a)(p.a.mark((function e(){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l((function(e){return["Kriptomat"].concat(Object(h.a)(e))})),e.next=3,Object(k.c)("".concat(r,"/kriptomat/").concat(n,"/").concat(t));case 3:(a=e.sent).success&&a.data&&a.data.url?w({url:L.a.format(a.data.url),title:"Kriptomat Deposit",w:515,h:600}):u("Error: ".concat(a.data?a.data:"unexpected error"),{error:!0}),l((function(e){return e.filter((function(e){return"Kriptomat"!==e}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{openRampNetwork:function(){new g.a({hostAppName:"Ambire",hostLogoUrl:"https://www.ambire.com/ambire-logo.png",variant:"auto",swapAsset:{ethereum:"ERC20_*,ETH_*",polygon:"MATIC_ERC20_*,MATIC_*",avalanche:"AVAX_*","binance-smart-chain":"BSC_*,BSC_ERC20_*",gnosis:"XDAI_*"}[t],userAddress:n,hostApiKey:R.c}).show()},openPayTrie:f,openTransak:function(){var e=new y.a({apiKey:R.f,environment:R.g,networks:{avalanche:"avaxcchain","binance-smart-chain":"bsc",moonbeam:"mainnet"}[t]||t,defaultCryptoCurrency:{ethereum:"USDC",polygon:"USDC",arbitrum:"ETH",avalanche:"AVAX","binance-smart-chain":"BNB",moonriver:"MOVR",moonbeam:"GLMR",optimism:"USDC"}[t],disableWalletAddressForm:!0,walletAddress:n,themeColor:"282b33",email:"",redirectURL:"",hostURL:window.location.origin,widgetHeight:"calc(100% - 60px)",widgetWidth:"100%"});e.init(),e.on(e.ALL_EVENTS,(function(e){console.log(e)})),e.on(e.EVENTS.TRANSAK_ORDER_SUCCESSFUL,(function(n){console.log(n),e.close()}))},openKriptomat:b,openGuardarian:function(){l((function(e){return["Guardarian"].concat(Object(h.a)(e))})),m(Object(U.jsx)(I,{relayerURL:r,walletAddress:n,selectedNetwork:t,portfolio:c})),l((function(e){return e.filter((function(e){return"Guardarian"!==e}))}))},isLoading:d}};function D(e){var n=e.walletAddress,t=e.networkDetails,a=e.relayerURL,i=e.portfolio,r=B({walletAddress:n,selectedNetwork:t.id,relayerURL:a,portfolio:i}),c=r.openRampNetwork,s=r.openPayTrie,o=r.openTransak,j=r.openKriptomat,p=r.openGuardarian,v=r.isLoading,h=[{logo:f,name:"Guardarian",type:"Buy with Bank Transfer, Credit/Debit Card, Sell Crypto",fees:"from 2%",limits:"up to 15k EUR/monthly on and off ramp",currencies:"GBP, EUR, USD and many more",networks:["ethereum","polygon","binance-smart-chain","fantom"],onClick:function(){return p()}},{logo:m,name:"Kriptomat",type:"Credit Card",fees:"2.45%",limits:"up to 5000 EUR/day",currencies:"USD, EUR, GBP",networks:["ethereum","polygon","avalanche","binance-smart-chain"],onClick:function(){return j()}},{logo:d,name:"Ramp",type:"Bank Transfer, Credit/Debit Card, Apple Pay",fees:"0.49%-2.9%",limits:"10,000EUR/m",currencies:"USD, EUR, GBP",networks:["ethereum","polygon","avalanche","binance-smart-chain","gnosis"],onClick:function(){return c()}},{logo:l,name:"PayTrie",type:"Bank Transfer",fees:"1% (min. $2 CAD)",limits:"$2,000CAD/day",currencies:"CAD",networks:["ethereum","polygon","binance-smart-chain"],onClick:function(){return s()}},{logo:u,name:"Transak",type:"Credit/Debit card and Bank Transfer (methods availability depends on location)",fees:"from 0.5%",limits:"up to 15,000 EUR/day",currencies:"GBP, EUR, USD and many more",networks:["ethereum","polygon","avalanche","arbitrum","binance-smart-chain","moonriver","moonbeam","optimism"],onClick:function(){return o()}}],O=function(e){return e.includes(t.id)?null:"disabled"};return Object(U.jsxs)("div",{id:"providers",children:[h.map((function(e){var n=e.logo,t=e.name,a=e.type,i=e.fees,r=e.limits,c=e.currencies,s=e.networks,o=e.onClick;return Object(U.jsxs)("div",{className:"provider ".concat(O(s)),onClick:o,children:[Object(U.jsx)("div",{className:"logo",children:Object(U.jsx)("img",{src:n,alt:t})}),v.includes(t)?Object(U.jsxs)("div",{children:[" ",Object(U.jsx)(b.m,{})," "]}):Object(U.jsxs)("div",{className:"details",children:[Object(U.jsx)("div",{className:"type",children:a}),Object(U.jsxs)("div",{className:"fees",children:["Fees: ",i]}),Object(U.jsxs)("div",{className:"limits",children:["Limits: ",r]}),Object(U.jsxs)("div",{className:"currencies",children:["Currencies: ",c]})]})]},t)})),"ethereum"!==t.id?Object(U.jsxs)("div",{id:"network-warning",children:[Object(U.jsx)("b",{children:"NOTE:"})," Some deposit methods are unavailable on ",Object(U.jsx)("b",{children:t.name}),". Switch to Ethereum for the widest support."]}):null]})}var _=t(60),P=t(816);function W(e){var n=e.selectedAcc,t=e.selectedNetwork,c=e.accounts,d=e.addRequest,l=e.relayerURL,u=e.portfolio,m=e.useStorage,f=_.a.find((function(e){return e.id===t.id})),b=Object(i.useState)(""),j=Object(a.a)(b,2),p=j[0],v=j[1],h=Object(i.useCallback)((function(){s.a.toDataURL(n,{quality:1,margin:1},(function(e,n){if(e)return console.error(e);v(n)}))}),[n]);return Object(i.useEffect)((function(){return h()}),[h]),Object(U.jsxs)("section",{id:"deposit",children:[Object(U.jsxs)("div",{className:"panel",children:[Object(U.jsxs)("div",{className:"heading",children:[Object(U.jsxs)("div",{className:"title",children:[Object(U.jsx)(r.b,{size:35}),"Deposit Tokens"]}),Object(U.jsx)("div",{className:"subtitle",children:"Direct Deposit"})]}),Object(U.jsxs)("div",{className:"description",children:[Object(U.jsx)(o.a,{className:"depositAddress",label:"Send ".concat(f.nativeAssetSymbol,", tokens or collectibles (NFTs) to this address:"),value:n,copy:!0}),Object(U.jsx)("img",{id:"qr-code",alt:"QR Code",src:p})]}),Object(U.jsxs)("div",{id:"networks",children:["Following networks supported on this address:",Object(U.jsx)("div",{className:"list",children:_.a.filter((function(e){return!e.hide})).map((function(e){var n=e.id,t=e.icon,a=e.name;return Object(U.jsxs)("div",{className:"network",children:[Object(U.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(t,")")}}),Object(U.jsx)("div",{className:"name",children:a})]},n)}))})]}),Object(U.jsx)(P.a,{selectedNetwork:t,selectedAccount:n,accounts:c,addRequest:d,linkMargin:!0,relayerURL:l,portfolio:u,useStorage:m})]}),Object(U.jsxs)("div",{className:"panel",children:[Object(U.jsxs)("div",{className:"heading",children:[Object(U.jsxs)("div",{className:"title",children:[Object(U.jsx)(r.a,{size:35}),"Fiat Currency"]}),Object(U.jsx)("div",{className:"subtitle",children:"Credit Card & Bank Transfer"})]}),Object(U.jsx)("div",{className:"description",children:"Deposit with credit card to your account directly using one of our partners"}),Object(U.jsx)(D,{walletAddress:n,networkDetails:f,relayerURL:l,portfolio:u})]})]})}},611:function(e,n,t){},816:function(e,n,t){"use strict";var a=t(8),i=(t(611),t(106)),r=t(85),c="0x0000000000000000000000000000000000000000";function s(e){var n=e.networkId,t=e.account;return t?Object(r.c)("".concat(i.h,"/protocols/tokens/balances?addresses[]=").concat(t,"&network=").concat(n,"&api_key=").concat(i.j,"&newBalances=true&available_on_coingecko=true")).then((function(e){var a=t.toLowerCase();if(!e[a])return[];if(!e[a].products[0])return[];var s=e[a].products[0].assets.map((function(e){return{address:e.tokens[0].address,symbol:e.tokens[0].symbol,decimals:e.tokens[0].decimals}})),o="".concat(i.h,"/protocols/tokens/balances?addresses[]=").concat(t,"&network=").concat(n,"&api_key=").concat(i.j,"&customTokens=").concat(JSON.stringify(s),"&available_on_coingecko=true");return Object(r.c)(o).then((function(e){var n,t;return(null===(n=e[a])||void 0===n||null===(t=n.products[0])||void 0===t?void 0:t.assets).map((function(e){return{name:e.tokens[0].symbol,icon:e.tokens[0].tokenImageUrl,address:e.tokens[0].address.toLowerCase(),native:e.tokens[0].address===c,decimals:e.tokens[0].decimals,availableBalance:e.tokens[0].balanceRaw,balanceUSD:e.tokens[0].balanceUSD,rate:e.tokens[0].balanceUSD/e.tokens[0].balanceRaw}}))})).catch((function(e){throw Error("Could not get customToken assets from velcro")}))})).catch((function(e){throw Error("Could not get assets from velcro")})):Promise.resolve([])}var o=t(37),d=t(79),l=t(3),u=t(2),m=t.n(u),f=t(11),b=t(7),j=t(17),p=t(648),v=t.n(p),h=t(21),O=[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}],g=[{name:"holder",type:"address"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"expiry",type:"uint256"},{name:"allowed",type:"bool"}],x=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],y=[{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],w=[{name:"name",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],k=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"verifyingContract",type:"address"},{name:"salt",type:"bytes32"}],T={1:[{address:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",name:"USD Coin",version:"2",domainType:x,permitType:O},{address:"0x1f9840a85d5af5bf1d1762f925bdaddc4201f984",name:"Uniswap",domainType:w,permitType:O},{address:"0xde30da39c46104798bb5aa3fe8b9e0e1f348163f",name:"Gitcoin",domainType:w,permitType:O},{address:"0x6b175474e89094c44da98b954eedeac495271d0f",name:"Dai Stablecoin",version:"1",domainType:x,permitType:g},{address:"0x090185f2135308bad17527004364ebcc2d37e5f6",domainType:y,permitType:O},{address:"0x99d8a9c45b2eca8864373a26d1459e3dff1e17f3",domainType:y,permitType:O},{address:"0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9",name:"Aave Token",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"AdEx Loyalty",address:"0xd9a4cb9dc9296e111c66dfacab8be034ee2e1c2c",version:"1",domainType:x,permitType:O},{name:"Aave Token",address:"0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9",version:"1",domainType:x,permitType:O},{name:"Ambire Wallet Staking Token",address:"0x47cd7e91c3cbaaf266369fe8518345fc4fc12935",version:"1",domainType:x,permitType:O},{name:"ConstitutionDAO",address:"0x7a58c0be72be218b41c608b7fe7c5bb630736c71",version:"1",domainType:x,permitType:O},{name:"Aragon Network Token",address:"0xa117000000f279d81a1d3cc75430faa017fa5a2e",version:"1",domainType:x,permitType:O},{name:"AdEx Staking Token",address:"0xb6456b57f03352be48bf101b46c1752a0813491a",version:"1",domainType:x,permitType:O},{name:"dYdX",address:"0x92d6c1e31e14520e676a687f0a93788b716beff5",version:"1",domainType:x,permitType:O},{name:"Ethereum Name Service",address:"0xc18360217d8f7ab5e7c516566761ea12ce7f9d72",version:"1",domainType:x,permitType:O},{name:"Olympus",address:"0x383518188c0c6d7730d91b2c03a03c837814a899",version:"1",domainType:x,permitType:O},{name:"1INCH Token",address:"0x111111111117dc0aa78b770fa6a738034120c302",version:"1",domainType:x,permitType:O},{name:"IceToken",address:"0xf16e81dce15b08f326220742020379b855b87df9",version:"1",domainType:x,permitType:O},{name:"Fei USD",address:"0x956f47f50a910163d8bf957cf5846d573e7f87ca",version:"1",domainType:x,permitType:O},{name:"LUSD Stablecoin",address:"0x5f98805a4e8be255a32880fdec7f6728c6568ba0",version:"1",domainType:x,permitType:O},{name:"Balancer",address:"0xba100000625a3754423978a60c9317c58a424e3d",version:"1",domainType:x,permitType:O},{name:"Aave interest bearing AAVE",address:"0xffc97d72e13e01096502cb8eb52dee56f74dad7b",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniBATWETH",address:"0xa1b0edf4460cc4d8bfaa18ed871bff15e5b57eb4",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniWBTCWETH",address:"0xc58f53a8adff2fb4eb16ed56635772075e2ee123",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniUSDCWETH",address:"0x391e86e2c002c70dee155eaceb88f7a3c38f5976",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing WETH",address:"0x030ba81f1c18d280636f32af80b9aad02cf0854e",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing DAI",address:"0x028171bca77440897b824ca71d1c56cac55b68a3",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniWBTCUSDC",address:"0x2365a4890ed8965e564b7e2d27c38ba67fec4c6f",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniCRVWETH",address:"0x0ea20e7ffb006d4cfe84df2f72d8c7bd89247db0",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniUNIWETH",address:"0x3d26dcd840fcc8e4b2193ace8a092e4a65832f9f",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing GUSD",address:"0xd37ee7e4f452c6638c96536e68090de8cbcdb583",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniMKRWETH",address:"0x370adc71f67f581158dc56f539df5f399128ddf9",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing CRV",address:"0x8dae6cb04688c62d939ed9b68d32bc62e49970b1",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market USDT",address:"0x17a79792fe6fe5c95dfe95fe3fcee3caf4fe4cb7",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market UniSNXWETH",address:"0x38e491a71291cd43e8de63b7253e482622184894",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing YFI",address:"0x5165d24277cd063f5ac44efd447b27025e888f37",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing SNX",address:"0x35f6b052c598d933d69a4eec4d04c73a191fe6c2",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market USDC",address:"0xd24946147829deaa935be2ad85a3291dbf109c80",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market DAI",address:"0x79be75ffc64dd58e66787e4eae470c8a1fd08ba4",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing USDT",address:"0x3ed3b47dd13ec9a98b44e6204a523e766b225811",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing RAI",address:"0xc9bc48c72154ef3e5425641a3c747242112a46af",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing BAL",address:"0x272f97b7a56a387ae942350bbc7df5700f8a4576",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing BAT",address:"0x05ec93c0365baaeabf7aeffb0972ea7ecdd39cf1",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing USDC",address:"0xbcca60bb61934080951369a648fb03df4f96263c",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave AMM Market BptBALWETH",address:"0xd109b2a304587569c84308c55465cd9ff0317bfb",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing KNC",address:"0x39c6b3e42d6a679d7d776778fe880bc9487c2eda",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing MANA",address:"0xa685a61171bb30d4072b338c80cb7b2c865c873e",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing XSUSHI",address:"0xf256cc7847e919fac9b808cc216cac87ccf2f47a",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing TUSD",address:"0x101cc05f4a51c0319f570d5e146a8c625198e636",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"},{name:"Aave interest bearing ENJ",address:"0xac6df26a590f08dcc95d5a4705ae8abbc88509ef",version:"1",domainType:x,permitType:O,nonceFunction:"_nonces"}],137:[{name:"Governance OHM",address:"0xd8ca34fd379d9ca3c6ee3b3905678320f5b45195",version:"1",domainType:x,permitType:O},{name:"Frax",address:"0x45c32fa6df82ead1e2ef74d17b76547eddfaff89",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market WBTC",address:"0x5c2ed810328349100a66b82b78a1791b101c9d61",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market WETH",address:"0x28424507fefb6f7f8e9d3860f56504e4e5f5f390",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market USDC",address:"0x1a13f4ca1d028320a707d99520abfefca3998b7f",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market AAVE",address:"0x1d2a0e5ec8e5bbdca5cb219e649b565d8e5c3360",version:"1",domainType:x,permitType:O},{name:"Synapse",address:"0xf8f9efc0db77d8881500bb06ff5d6abc3070e695",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market WMATIC",address:"0x8df3aad3a84da6b69a4da8aec3ea40d9091b2ac4",version:"1",domainType:x,permitType:O},{name:"Aave Matic Market USDT",address:"0x60d55f02a771d515e077c9c2403a1ef324885cec",version:"1",domainType:x,permitType:O},{name:"Klima DAO",address:"0x4e78011ce80ee02d2c3e649fb657e45898257815",version:"1",domainType:x,permitType:O},{name:"Quickswap",address:"0xb5c064f955d8e7f38fe0460c556a72987494ee17",domainType:w,permitType:O},{name:"Route",address:"0x16eccfdbb4ee1a85a33f3a9b21175cd7ae753db4",domainType:w,permitType:O},{address:"0x8f3cf7ad23cd3cadbd9735aff958023239c6a063",name:"(PoS) Dai Stablecoin",version:"1",salt:"0x0000000000000000000000000000000000000000000000000000000000000089",domainType:k,permitType:g,nonceFunction:"getNonce"},{address:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",name:"USD Coin (PoS)",version:"1",salt:"0x0000000000000000000000000000000000000000000000000000000000000089",domainType:k,permitType:O}],56:[{name:"1INCH Token",address:"0x111111111117dc0aa78b770fa6a738034120c302",version:"1",domainType:x,permitType:O},{name:"Frax",address:"0x90c97f71e18723b0cf0dfa30ee176ab653e89f40",version:"1",domainType:x,permitType:O},{name:"JADE",address:"0x7ad7242a99f21aa543f9650a56d141c57e4f6081",version:"1",domainType:x,permitType:O},{name:"Templar Token",address:"0x19e6bfc1a6e4b042fb20531244d47e252445df01",version:"1",domainType:x,permitType:O}]},C=new h.Interface(["function nonces(address owner) external view returns (uint256)","function _nonces(address owner) external view returns (uint256)","function getNonce(address owner) external view returns (uint256)","function name() external view returns (string)","function symbol() external view returns (string)","function decimals() external view returns (uint)","function balanceOf(address) external view returns (uint)","function permit(address owner, address spender, uint256 value, uint256 deadline, uint8 v, bytes32 r, bytes32 s)","function permit(address holder, address spender, uint256 nonce, uint256 expiry, bool allowed, uint8 v, bytes32 r, bytes32 s)","function transferFrom(address from, address to, uint256 amount) view returns (bool)","function transfer(address to, uint256 amount) view returns (bool)","function approve(address spender, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint)"]),S=t(241),N=t(229),A=t(36),E=t(52),M=t(95),F=t(70),L=t(695),U=t(4),I=function(e){var n=e.signerAccount,t=e.identityAccount,i=e.network,o=e.setIsSelectionConfirmed,u=e.setStep,p=e.portfolio,h=e.relayerURL,O=e.setModalButtons,g=e.hideModal,x=e.setSelectedTokensWithAllowance,y=e.setGasSpeed,w=e.setStepperSteps,k=e.hidden,I=Object(l.useState)([]),R=Object(a.a)(I,2),B=R[0],D=R[1],_=Object(l.useState)([]),P=Object(a.a)(_,2),W=P[0],G=P[1],H=Object(l.useState)(!0),Y=Object(a.a)(H,2),q=Y[0],V=Y[1],K=Object(l.useState)([]),$=Object(a.a)(K,2),X=$[0],z=$[1],J=Object(l.useState)(null),Q=Object(a.a)(J,2),Z=Q[0],ee=Q[1],ne=Object(l.useState)([]),te=Object(a.a)(ne,2),ae=te[0],ie=te[1],re=Object(l.useState)(null),ce=Object(a.a)(re,2),se=ce[0],oe=ce[1],de=Object(l.useState)("fast"),le=Object(a.a)(de,2),ue=le[0],me=le[1],fe=Object(l.useState)([]),be=Object(a.a)(fe,2),je=be[0],pe=be[1],ve=Object(l.useState)(!1),he=Object(a.a)(ve,2),Oe=he[0],ge=he[1],xe=Object(l.useState)(!1),ye=Object(a.a)(xe,2),we=ye[0],ke=ye[1],Te=Object(l.useState)(""),Ce=Object(a.a)(Te,2),Se=Ce[0],Ne=Ce[1],Ae=Object(l.useState)(""),Ee=Object(a.a)(Ae,2),Me=Ee[0],Fe=Ee[1],Le=Object(l.useRef)(),Ue=function(e,n){var t;return!!(null===(t=T[e])||void 0===t?void 0:t.find((function(e){return e.address.toLowerCase()===n.toLowerCase()})))};Object(l.useEffect)((function(){Oe&&Le.current.focus()}),[Oe]);var Ie=Object(l.useCallback)((function(e,n){var t=W.findIndex((function(n){return n.address===e}));if(-1!==t){var a=n(W[t]);G([].concat(Object(j.a)(W.slice(0,t)),[a],Object(j.a)(W.slice(t+1))))}}),[W]),Re=Object(l.useCallback)((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Ie(e,(function(t){var a=Object(b.a)(Object(b.a)({},t),{},{selected:!t.selected});if(n){var i,r=null===(i=W.find((function(n){return n.address===e})))||void 0===i?void 0:i.humanAmount;if(n>r){var c,s=null===(c=B.find((function(n){return n.address===e})))||void 0===c?void 0:c.decimals;a.amount=new v.a(n).multipliedBy(Math.pow(10,s)).toFixed(0),a.humanAmount=n}}return a}))}),[B,Ie,W]),Be=Object(l.useCallback)((function(){var e=Object(F.a)(i.id);if(E.ethers.utils.isAddress(Se)){if(B.find((function(e){return e.address.toLowerCase()===Se.toLowerCase()})))return Ne(""),void ge(!1);var r=new M.Contract(Se,C,e),c=r.symbol().catch((function(){return Fe("Could not get symbol of token "+Se)})),s=r.decimals().catch((function(){return Fe("Could not get decimals of token "+Se)})),o=r.allowance(n,t).catch((function(){return Fe("Could not get allowance for token "+Se)})),d=r.balanceOf(n).catch((function(){return Fe("Could not get balance for token "+Se)}));ke(!0),Fe(null),Promise.all([c,s,o,d]).then((function(e){var n=Object(a.a)(e,4),t=n[0],i=n[1],r=n[2],c=n[3];ke(!1),t&&i&&null!==r&&null!==c&&(Ne(""),ge(!1),D((function(e){return[].concat(Object(j.a)(e),[{address:Se,name:t,decimals:i.toNumber(),icon:null,rate:0,native:!1,availableBalance:c.toString(),balanceUSD:0}])})),G((function(e){return[].concat(Object(j.a)(e),[{address:Se,selectedAmount:0,amount:c.toString(),humanAmount:new v.a(c.toString()).div(Math.pow(10,i.toString())).toFixed(),selected:c.gt(0)}])})),pe((function(e){return[].concat(Object(j.a)(e),[{address:Se,allowance:0,permittable:!1}])})))})).catch((function(e){console.log("err getting custom token data",e),ke(!1)}))}else Fe("invalid custom token address")}),[i,Se,n,t,Fe,B]),De=function(e,n){return!!e.filter((function(e){return e.selected&&e.isEnoughToCoverFees[n].ifSelected||e.isEnoughToCoverFees[n].ifNotSelected})).length},_e=function(e,n){return e.filter((function(e){return e.isEnoughToCoverFees[n].ifSelected})).map((function(e){return Object(b.a)(Object(b.a)({},e),{},{minimumSelectionAmount:e.isEnoughToCoverFees[n].minimumSelectionAmount})}))},Pe=function(e){return L.a.filter((function(n){return!!e.filter((function(e){return e.selected&&e.isEnoughToCoverFees[n].ifSelected||e.isEnoughToCoverFees[n].ifNotSelected})).length}))},We=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.map((function(e){return Object(b.a)(Object(b.a)(Object(b.a)({},e),n.find((function(n){return n.address===e.address}))),t.find((function(n){return n.address===e.address})))}))},Ge=Object(l.useCallback)(Object(f.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=We(B,W,je).filter((function(e){return e.selected}))).length){e.next=3;break}return e.abrupt("return");case 3:x(n.map((function(e){return Object(b.a)({},e)}))),o(!0),n.find((function(e){return e.address===c}))?u(1):u(2),y(ue);case 7:case"end":return e.stop()}}),e)}))),[B,W,je,x,o,u,y,ue]);Object(l.useEffect)((function(){V(!0),D([]),s({networkId:i.id,account:n}).then((function(e){D(e.map((function(e){return Object(b.a)({},e)}))),G(e.map((function(e){return{address:e.address,selectedAmount:0,amount:e.availableBalance,humanAmount:new v.a(e.availableBalance).div(Math.pow(10,e.decimals)).toFixed(),selected:!1}}))),V(!1)})).catch((function(e){console.error(e)}))}),[n,V,D,i]),Object(l.useEffect)((function(){if(Z){var e=We(B,W,je),n=e.filter((function(e){return e.selected&&e.permittable&&new v.a(e.allowance).isLessThan(e.amount)})).length,t=e.filter((function(e){return e.selected&&!e.native&&e.permittable})).length,a=e.filter((function(e){return e.selected&&!e.permittable&&!e.native})).length,r=e.filter((function(e){return e.selected&&e.native})).length,s="arbitrum"===i.id?2e5:0,o=n+t>0?25e3+7e4*n+52e3*t:0,d=a*(77e3+s)+25e3*r,l=Z.gasFeeAssets.native/Math.pow(10,18),u={};L.a.forEach((function(e){var n=Z.gasPrice[e]+(Z.gasPrice.maxPriorityFeePerGas?1*Z.gasPrice.maxPriorityFeePerGas[e]:0),t=o*n,a=t*l,i=d*n,r=i*l;u[e]={speed:e,migrationTransactionsCost:t,migrationTransactionsCostUSD:a,signerTransactionsCost:i,signerTransactionsCostUSD:r,migrationTransactionsConsumption:o,signerTransactionsConsumption:d}})),oe({permitsCount:n,permittableTransfersCount:t,regularTransfersCount:a,nativeTransfersCount:r,gasFees:u});var m=[c].concat(Object(j.a)(Z.gasFeeAssets.feeTokens.map((function(e){return e.address})))),f=e.filter((function(e){return m.find((function(n){return n.toLowerCase()===e.address.toLowerCase()}))}));p.tokens.forEach((function(e){m.find((function(n){return n.toLowerCase()===e.address.toLowerCase()}))&&!f.find((function(n){return n.address.toLowerCase()===e.address.toLowerCase()}))&&f.push(Object(b.a)(Object(b.a)({},e),{},{fromPortfolio:!0}))}));var h=f.map((function(e){var n=0,t=0;if(e.fromPortfolio)n=e.balanceUSD;else{var a=null===p||void 0===p?void 0:p.tokens;if(a){var i=a.find((function(n){return n.address.toLowerCase()===e.address.toLowerCase()}));n=(null===i||void 0===i?void 0:i.balanceUSD)||0}else console.warn("no identity assets!");t=new v.a(e.amount).multipliedBy(e.rate).toNumber()}var r={},c=!e.fromPortfolio&&e.selected||!1;return L.a.forEach((function(a){r[a]={ifNotSelected:new v.a(n).isGreaterThan(u[a].migrationTransactionsCostUSD),ifSelected:new v.a(n+t).isGreaterThan(u[a].migrationTransactionsCostUSD),minimumSelectionAmount:e.rate>0?new v.a(u[a].migrationTransactionsCostUSD).minus(n).dividedBy(e.rate).dividedBy(Math.pow(10,e.decimals)).multipliedBy(1.0001).toNumber():0}})),{address:e.address,name:e.name,selected:c,identityBalanceUSD:n,selectedAmountUSD:t,isEnoughToCoverFees:r}}));ie(h)}}),[B,W,p,Z,ue,je,i]),Object(l.useEffect)((function(){Object(r.c)("".concat(h,"/gasPrice/").concat(i.id)).then((function(e){ee(e.data)})).catch((function(e){console.log("fetch error",e)}))}),[h,i]),Object(l.useEffect)((function(){var e=B.map((function(e){var a=Object(F.a)(i.id),r=new M.Contract(e.address,C,a);return e.native?{address:e.address,allowance:0,permittable:!1}:r.allowance(n,t).then((function(n){var t=!1;return T[i.chainId]&&(t=T[i.chainId].find((function(n){return n.address.toLowerCase()===e.address.toLowerCase()}))||!1),{address:e.address,allowance:n.toString(),permittable:t}})).catch((function(e){console.log("err getting allowance",e)}))}));Promise.all(e).then((function(e){pe(e)}))}),[t,i,B,n]),Object(l.useEffect)((function(){k||O(Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(d.e,{clear:!0,small:!0,icon:Object(U.jsx)(A.i,{}),onClick:g,children:"Close"}),W.filter((function(e){return e.selected})).length>0&&De(ae,ue)?Object(U.jsxs)(d.e,{small:!0,icon:Object(U.jsx)(A.R,{}),className:"primary",onClick:function(){return Ge()},children:["Move ",W.filter((function(e){return e.selected})).length," assets"]}):Object(U.jsx)(d.e,{small:!0,icon:Object(U.jsx)(A.R,{}),className:"primary disabled",children:"Move assets"})]}))}),[W,ae,ue,O,g,Ge,k]);var He=Object(l.useCallback)((function(e,n){return Ie(n.address,(function(t){if(""===e)return Object(b.a)(Object(b.a)({},t),{},{humanAmount:0,amount:0});if(e.endsWith(".")&&2===e.split(".").length||2===e.split(".").length&&e.endsWith("0"))return Object(b.a)(Object(b.a)({},t),{},{humanAmount:e});if(!isNaN(e)){var a=new v.a(e).toFixed(n.decimals);return 1===new v.a(a).multipliedBy(Math.pow(10,n.decimals)).comparedTo(n.availableBalance)&&(a=new v.a(n.availableBalance).dividedBy(Math.pow(10,n.decimals)).toFixed(n.decimals)),a=a.replace(/\.?0+$/g,""),Object(b.a)(Object(b.a)({},t),{},{humanAmount:a,amount:new v.a(a).multipliedBy(Math.pow(10,n.decimals)).toFixed(0)})}return t}))}),[Ie]);return Object(l.useEffect)((function(){var e=["Selection"],n=W.find((function(e){return e.address.toLowerCase()===c&&e.selected}));if(n&&e.push("Send ".concat(B.find((function(e){return e.address===n.address})).name)),W.find((function(e){return e.address.toLowerCase()!==c&&e.selected}))){var t=[];W.find((function(e){return e.selected&&Ue(i.chainId,e.address)}))&&t.push("Permit"),W.find((function(e){return e.selected&&e.address.toLowerCase()!==c&&!Ue(i.chainId,e.address)}))&&t.push("Send"),e.push(t.join(" and ")+" tokens"),W.find((function(e){return e.selected&&Ue(i.chainId,e.address)}))&&e.push("Transfer tokens")}1===e.length&&e.push("Send tokens"),w(e)}),[B,W,w,i]),k?Object(U.jsx)(U.Fragment,{}):Object(U.jsx)("div",{children:q?Object(U.jsxs)("div",{className:"content-center",children:[Object(U.jsx)("h3",{className:"mb-6",children:"Loading assets..."}),Object(U.jsx)(S.a,{})]}):Object(U.jsx)("div",{children:0===B.length?Object(U.jsx)("div",{children:"No assets to migrate have been found"}):Object(U.jsxs)("div",{children:[Object(U.jsx)("div",{className:"mb-4",children:"Please select the assets you would like to migrate from your signer wallet to your Ambire wallet"}),We(B,W).sort((function(e,n){return e.name<n.name?-1:1})).map((function(e,n){return Object(U.jsxs)("div",{className:"migration-asset-row",children:[Object(U.jsx)("div",{className:"migration-asset-select".concat(e.selected?" checked":""),onClick:function(){return!1},children:Object(U.jsx)(d.g,{id:"check-".concat(e.address),label:Object(U.jsxs)("span",{className:"migration-asset-select-label",children:[Object(U.jsx)("span",{className:"migration-asset-select-icon",children:X.includes(e.icon)||!e.icon?Object(U.jsx)(N.d,{size:18}):Object(U.jsx)("img",{src:e.icon,draggable:"false",alt:"Token Icon",onError:function(n){z((function(n){return[].concat(Object(j.a)(n),[e.icon])}))}})}),Object(U.jsx)("span",{className:"migration-asset-select-name",children:e.name})]}),checked:e.selected,onChange:function(){return Re(e.address)}})}),Object(U.jsxs)("div",{className:"migration-asset-usd",children:["$",(e.amount*e.rate).toFixed(2)]}),Object(U.jsx)("div",{className:"migration-asset-amount",children:Object(U.jsx)(d.w,{className:"migrate-amount-input",value:e.humanAmount,onChange:function(n){return He(n,e)}})})]},n)})),Object(U.jsx)("div",{className:"custom-token-row mt-2",children:Oe?Object(U.jsx)("div",{children:we?Object(U.jsxs)("div",{className:"custom-token-message-fetching",children:[Object(U.jsx)(d.m,{}),"Fetching custom token data..."]}):Object(U.jsxs)(U.Fragment,{children:[Me&&Object(U.jsx)("div",{className:"error",children:Me}),Object(U.jsx)("div",{children:Object(U.jsx)(d.w,{className:"custom-token-input",placeholder:"Enter custom token address",value:Se,onChange:function(e){Ne(e)},ref:Le})}),Object(U.jsxs)("div",{className:"flex-row mt-2",children:[Object(U.jsx)(d.e,{small:!0,icon:Object(U.jsx)(A.e,{}),className:"buttonHollow danger align-right",onClick:function(){ge(!1),Ne(""),Fe(null)},children:"Cancel"}),Object(U.jsx)(d.e,{small:!0,icon:Object(U.jsx)(A.D,{}),className:"primary ms-4",onClick:function(){return Be()},children:"Add"})]})]})}):Object(U.jsx)(d.e,{small:!0,icon:Object(U.jsx)(A.D,{}),className:"clear align-right",onClick:function(){return ge(!0)},children:"Add custom token"})}),!De(ae,ue)&&W.filter((function(e){return e.selected})).length>0&&Object(U.jsxs)("div",{className:"notification-hollow warning mt-3 mb-3",children:["Your Ambire Wallet will not have enough fees to pay for the migration transaction.",!!_e(ae,ue).length&&Object(U.jsxs)("div",{className:"mt-3",children:["You should remove ERC20 tokens from the selection or add one of the following gas tokens :",Object(U.jsx)("ul",{className:"notification-gas-tokens",children:_e(ae,ue).map((function(e,n){return Object(U.jsx)("li",{children:Object(U.jsxs)("span",{className:"gas-token-suggestion",onClick:function(){return Re(e.address,e.minimumSelectionAmount)},children:[e.name,Object(U.jsxs)("span",{className:"gas-token-amount",children:[" (min ",e.minimumSelectionAmount.toFixed(6),")"]})]})},n)}))})]}),!!Pe(ae).length&&Object(U.jsxs)("div",{children:[_e(ae,ue).length?"You can also":"Please"," select a slower gas speed (",Pe(ae).join(", "),")."]})]}),se&&Object(U.jsxs)("div",{className:"gas-estimation-block mt-4",children:[Object(U.jsx)("div",{className:"gas-estimation-block-title",children:"Estimated gas fee"}),Object(U.jsx)("ul",{className:"gas-estimation-selector",children:Object.values(se.gasFees).map((function(e,n){return Object(U.jsx)("li",{className:e.speed===ue?"selected":"",onClick:function(){return me(e.speed)},children:e.speed},n)}))}),Object(U.jsx)("table",{className:"gas-estimation-details",children:Object(U.jsxs)("tbody",{children:[Object(U.jsxs)("tr",{children:[Object(U.jsxs)("td",{children:["Migration fee",(!!se.permittableTransfersCount||!!se.permitsCount)&&Object(U.jsxs)("span",{className:"migration-actions",children:["(",!!se.permittableTransfersCount&&Object(U.jsxs)("span",{children:[se.permittableTransfersCount," transfer",se.permittableTransfersCount>1&&"s",!!se.permitsCount&&", "]}),!!se.permitsCount&&Object(U.jsxs)("span",{children:[se.permitsCount," permit",se.permitsCount>1&&"s"]}),")"]})]}),Object(U.jsxs)("td",{className:"gas-estimation-details-amount",children:["$",se.gasFees[ue].migrationTransactionsCostUSD.toFixed(2)]})]}),Object(U.jsxs)("tr",{children:[Object(U.jsxs)("td",{children:["Signer fee",(!!se.nativeTransfersCount||!!se.regularTransfersCount)&&Object(U.jsx)("span",{className:"migration-actions",children:Object(U.jsxs)("span",{children:[se.nativeTransfersCount+se.regularTransfersCount," transfers"]})})]}),Object(U.jsxs)("td",{className:"gas-estimation-details-amount",children:["$",se.gasFees[ue].signerTransactionsCostUSD.toFixed(2)]})]})]})})]})]})})})},R=t(615),B=t(186),D=t(240),_=function(e){var n=e.addRequest,t=e.identityAccount,i=e.signer,s=e.signerExtra,o=e.network,d=e.selectedTokensWithAllowance,u=e.setError,p=e.hideModal,h=e.setStep,O=e.setModalButtons,x=e.relayerURL,y=e.gasSpeed,w=e.hidden,S=Object(l.useState)([]),L=Object(a.a)(S,2),I=L[0],_=L[1],P=Object(l.useState)({}),W=Object(a.a)(P,2),G=W[0],H=W[1],Y=Object(l.useState)({}),q=Object(a.a)(Y,2),V=q[0],K=q[1],$=Object(l.useState)(!1),X=Object(a.a)($,2),z=X[0],J=X[1],Q=Object(l.useState)(null),Z=Object(a.a)(Q,2),ee=Z[0],ne=Z[1],te=Object(l.useState)([]),ae=Object(a.a)(te,2),ie=ae[0],re=ae[1],ce=Object(l.useState)(null),se=Object(a.a)(ce,2),oe=se[0],de=se[1],le=Object(l.useState)(null),ue=Object(a.a)(le,2),me=ue[0],fe=ue[1],be=Object(l.useState)(null),je=Object(a.a)(be,2),pe=je[0],ve=je[1],he=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e.filter((function(e){return e.address!==c})).map((function(e){var i=Object(b.a)(Object(b.a)({},e),{},{signing:null,signature:null,sent:!1,pending:!1,allowance:0});return n[e.address]&&(i.signing=n[e.address].signing,i.signature=n[e.address].signature),t[e.address]&&(i.sent=!0),a[e.address]&&(i.pending=!0),i}))},Oe=Object(l.useCallback)(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===pe||void 0===pe?void 0:pe.isConnected(i.address,o.chainId).then((function(e){return de(e),!!e||(u(Object(U.jsxs)(U.Fragment,{children:["Please make sure your signer wallet is unlocked, and connected with ",Object(U.jsx)("b",{children:i.address})," to the correct chain: ",Object(U.jsx)("b",{children:o.id})]})),!1)})).catch((function(e){return u("Could not check signer connection status: "+e.error),!1})));case 1:case"end":return e.stop()}}),e)}))),[o,u,i,pe]),ge=Object(l.useCallback)((function(){var e=0;return he(d,I,G,[]).forEach((function(n){(n.permittable&&n.signature||n.sent)&&e++})),e}),[d,I,G]),xe=Object(l.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(n){var a,r,c,s,l,f,j,p,v,h,O,x,y;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=T[o.chainId].find((function(e){return e.address.toLowerCase()===n.toLowerCase()})))){e.next=32;break}if(-1===(r=d.findIndex((function(e){return e.address===n})))){e.next=32;break}return c=d[r],s=Object(F.a)(o.id),l=new M.Contract(n,C,s),e.next=9,a.nonceFunction?l[a.nonceFunction](i.address):l.nonces(i.address);case 9:return f=e.sent.toString(),e.next=12,l.name();case 12:return j=e.sent,p=c.amount,v={owner:i.address,spender:t,value:p,nonce:f,deadline:"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"},a.permitType===g&&(v.allowed=!0,delete v.value,v.holder=v.owner,delete v.owner,v.expiry=v.deadline,delete v.deadline),h={chainId:o.chainId,verifyingContract:n},a.name&&(h.name=j),a.version&&(h.version=a.version),a.salt&&(h.salt=a.salt),a.domainType===k&&delete h.chainId,K((function(e){return e[n]=!0,Object(b.a)({},e)})),e.next=24,pe._signTypedData(h,{Permit:a.permitType},v).catch((function(e){4001===(null===e||void 0===e?void 0:e.code)?(_((function(e){return e[n]=Object(b.a)(Object(b.a)({},e[n]),{},{signing:!1,signature:null}),Object(b.a)({},e)})),J(!0)):-32603===(null===e||void 0===e?void 0:e.code)?e.message.includes("Not supported on this device")?u("Your signer wallet does not support 712 signatures"):e.message.includes("must match the active chainId")?u("Please connect your signser wallet to the correct network: "+o.id):u(e.message):u(e.message),K((function(e){return e[n]=!1,Object(b.a)({},e)}))}));case 24:if(O=e.sent){e.next=27;break}return e.abrupt("return",!1);case 27:return x={r:O.slice(0,66),s:"0x"+O.slice(66,130),v:parseInt(O.slice(130,132),16)},y=a.permitType===g?C.encodeFunctionData("permit(address holder, address spender, uint256 nonce, uint256 expiry, bool allowed, uint8 v, bytes32 r, bytes32 s)",[v.holder,v.spender,f,v.expiry,v.allowed,x.v,x.r,x.s]):C.encodeFunctionData("permit(address owner, address spender, uint256 value, uint256 deadline, uint8 v, bytes32 r, bytes32 s)",[v.owner,v.spender,p,v.deadline,x.v,x.r,x.s]),_((function(e){return e[n]=Object(b.a)(Object(b.a)({},e[n]),{},{signing:!0,signature:y}),Object(b.a)({},e)})),K((function(e){return e[n]=!1,Object(b.a)({},e)})),e.abrupt("return",!0);case 32:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[o,d,i,t,u,pe]),ye=Object(l.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(n){var a,r,c,s,l=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]&&l[1],e.next=3,Oe();case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:if(r=d.find((function(e){return e.address===n}))){e.next=8;break}return e.abrupt("return");case 8:return c=C.encodeFunctionData("transfer",[t,new v.a(r.amount).toFixed(0)]),K((function(e){return e[n]=!0,Object(b.a)({},e)})),ne(null),s=pe.sendTransaction({from:i.address,to:n,data:c,gasLimit:8e4,gasPrice:me,chainId:o.chainId}).then(function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_((function(e){return e[n]=Object(b.a)(Object(b.a)({},e[n]),{},{signing:!0}),Object(b.a)({},e)})),!a){e.next=7;break}return e.next=4,t.wait();case 4:H((function(e){return e[n]=!0,Object(b.a)({},e)})),K((function(e){return e[n]=!1,Object(b.a)({},e)})),_((function(e){return e[n]=Object(b.a)(Object(b.a)({},e[n]),{},{signing:!1}),Object(b.a)({},e)}));case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return K((function(e){return e[n]=!1,Object(b.a)({},e)})),e.message.includes("underpriced")?ne("Transaction fee underpriced"):ne(e.message),J(!0),(!I[n]||I[n]&&!1!==I[n].signing)&&_((function(e){return e[n]=Object(b.a)(Object(b.a)({},e[n]),{},{signing:!1}),Object(b.a)({},e)})),!1})),e.abrupt("return",!!s);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[pe,t,I,d,me,o,i,Oe]),we=Object(l.useCallback)((function(){u(null),H([]),_([]),J(!1),h(0)}),[u,_,H,h]),ke=Object(l.useCallback)((function(){he(d,I,G,V).forEach((function(e){if(e.permittable){e.allowance&&E.ethers.BigNumber.from(e.allowance).gte(e.amount)||n({id:"req-"+Math.random(),chainId:o.chainId,account:t,type:"eth_sendTransaction",txn:{to:e.address,value:"0x0",data:e.signature}});var a=C.encodeFunctionData("transferFrom",[i.address,t,e.amount]);n({id:"req-"+Math.random(),chainId:o.chainId,account:t,type:"eth_sendTransaction",txn:{to:e.address,value:"0x0",data:a}})}})),we(),p()}),[n,we,p,t,o,d,i,G,V,I]);return Object(l.useEffect)((function(){ve(Object(R.a)({signer:i,signerExtra:s,chainId:o.chainId}))}),[o,i,s]),Object(l.useEffect)((function(){Oe()}),[Oe]),Object(l.useEffect)((function(){var e="".concat(x,"/gasPrice/").concat(o.id);Object(r.c)(e).then((function(e){var n=e.data.gasPrice[y];e.data.gasPrice.maxPriorityFeePerGas&&(n+=e.data.gasPrice.maxPriorityFeePerGas[y]),fe(n)})).catch((function(n){u(n.message+" "+e)}))}),[o,x,u,y]),Object(l.useEffect)((function(){if(oe&&Object.values(G).length&&me){var e=he(d,I,G,[]).map((function(e){return{address:e.address,signed:e.signing,permittable:e.permittable}})).find((function(e){return null===e.signed}));e&&(e.permittable?xe(e.address):setTimeout((function(){ye(e.address,!0)}),150))}}),[d,xe,ye,I,G,oe,me]),Object(l.useEffect)((function(){if(d.length){var e={};d.forEach((function(n){e[n.address]=!1})),H(e)}}),[d,H]),Object(l.useEffect)((function(){z&&u("Every asset below needs to be sent or permitted to complete the migration"+(ee?" ("+ee+")":""))}),[z,u,ee]),Object(l.useEffect)((function(){ge()===d.length&&u(null)}),[ge,d,u]),Object(l.useEffect)((function(){w||O(Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(D.a,{className:"clear",icon:Object(U.jsx)(A.Q,{}),onClick:function(){return we()},children:"Back"}),d.find((function(e){return e.permittable}))?ge()===he(d).length?Object(U.jsx)(D.a,{className:"primary",icon:Object(U.jsx)(A.R,{}),onClick:function(){return ke()},children:"Move tokens"}):Object(U.jsx)(D.a,{className:"primary disabled",icon:Object(U.jsx)(A.R,{}),children:"Move tokens"}):ge()===he(d).length?Object(U.jsx)(D.a,{className:"primary",icon:Object(U.jsx)(A.R,{}),onClick:function(){return p()},children:"Close"}):Object(U.jsx)(D.a,{className:"primary disabled",icon:Object(U.jsx)(A.R,{}),children:"Complete"})]}))}),[we,ke,ge,d,O,w,p]),w?Object(U.jsx)(U.Fragment,{}):Object(U.jsxs)("div",{children:[ge()<he(d).length?Object(U.jsx)("div",{className:"small-asset-notification mb-3 warning",children:"".concat(he(d).length-ge()," actions left to complete the migration")}):Object(U.jsx)("div",{className:"small-asset-notification mb-3 success",children:d.find((function(e){return e.permittable}))?"Your tokens are ready to be migrated":"Your tokens were migrated. You can close this window"}),he(d,I,G,V).map((function(e,n){return Object(U.jsxs)("div",{className:"migration-asset-row",children:[Object(U.jsx)("span",{className:"migration-asset-select-icon migration-asset-select-icon-permit",children:!e.icon||ie.includes(e.icon)?Object(U.jsx)(N.d,{size:18}):Object(U.jsx)("img",{src:e.icon,draggable:"false",alt:"Token Icon",onError:function(n){re((function(n){return[].concat(Object(j.a)(n),[e.icon])}))}})}),Object(U.jsx)("div",{className:"migration-asset-name",children:e.name}),Object(U.jsxs)("div",{className:"migration-asset-amount",children:[new v.a(e.amount).div(Math.pow(10,e.decimals)).toFixed()," ",Object(U.jsxs)("span",{className:"migration-asset-amount-usd",children:["($",(e.amount*e.rate).toFixed(2),")"]})]}),Object(U.jsx)("div",{className:"separator"}),Object(U.jsx)("div",{children:e.allowance&&E.ethers.BigNumber.from(e.allowance).gte(e.amount)||e.sent?Object(U.jsxs)("div",{className:"migration-permitted",onClick:function(){return ye(e.address)},children:[Object(U.jsx)(B.b,{})," Sent"]}):Object(U.jsx)(U.Fragment,{children:e.permittable?Object(U.jsxs)(U.Fragment,{children:[!e.signature&&!e.pending&&Object(U.jsx)("button",{className:"buttonComponent button-small secondary",onClick:function(){return xe(e.address)},children:"Permit"}),!e.signature&&e.pending&&Object(U.jsxs)("div",{className:"migration-permitted warning",children:[Object(U.jsx)(B.d,{})," Permitting..."]}),e.signature&&Object(U.jsxs)("div",{className:"migration-permitted",children:[Object(U.jsx)(B.b,{})," Permitted"]})]}):Object(U.jsx)(U.Fragment,{children:e.pending||e.signing?Object(U.jsxs)("div",{className:"migration-permitted warning",children:[Object(U.jsx)(B.d,{})," Sending..."]}):Object(U.jsx)(D.a,{className:"button-small secondary",onClick:function(){return ye(e.address)},children:"Send"})})})})]},n)}))]})},P=function(e){var n,t=e.identityAccount,i=e.signer,c=e.signerExtra,s=e.network,o=e.nativeTokenData,u=e.setSelectedTokensWithAllowance,b=e.selectedTokensWithAllowance,p=e.setError,h=e.setStep,O=e.hasERC20Tokens,g=e.hideModal,x=e.relayerURL,y=e.setModalButtons,w=e.setBeforeCloseModalHandler,k=e.gasSpeed,T=e.hidden,C=Object(l.useState)([]),S=Object(a.a)(C,2),E=S[0],M=S[1],F=Object(l.useState)(!1),L=Object(a.a)(F,2),I=L[0],B=L[1],D=Object(l.useState)(!1),_=Object(a.a)(D,2),P=_[0],W=_[1],G=Object(l.useState)("0"),H=Object(a.a)(G,2),Y=H[0],q=H[1],V=Object(l.useState)(null),K=Object(a.a)(V,2),$=K[0],X=K[1],z=Object(l.useState)("0"),J=Object(a.a)(z,2),Q=J[0],Z=J[1],ee=Object(l.useState)("0"),ne=Object(a.a)(ee,2),te=ne[0],ae=ne[1],ie=Object(l.useState)(!1),re=Object(a.a)(ie,2),ce=re[0],se=re[1],oe=Object(l.useState)(null),de=Object(a.a)(oe,2),le=de[0],ue=de[1];try{n=Object(R.a)({signer:i,signerExtra:c,chainId:s.chainId})}catch(he){p("No Web3 wallet connected. Please connect a Web3 wallet and reload the page")}var me=Object(l.useCallback)((function(){h(0),u([])}),[u,h]),fe=Object(l.useCallback)((function(){h(2)}),[h]),be=function(e){return e.filter((function(e){return e.selected&&!e.permittable&&!e.native})).length},je=Object(l.useCallback)(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return p(null),W(!0),O||w(null),e.next=7,n.isConnected(i.address,s.chainId).catch((function(e){p("Could not check signer connection status: "+e.error)}));case 7:e.sent?n.sendTransaction({from:i.address,to:t,gasLimit:25e3+("arbitrum"===s.id?2e5:0),gasPrice:le,value:"0x"+new v.a(Y).toString(16),chainId:s.chainId}).then(function(){var e=Object(f.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.wait();case 2:return B(!0),W(!1),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return B(!1),W(!1),e&&e.message.includes("must provide an Ethereum address")?p("Make sure your wallet is unlocked and connected with ".concat(i.address,".")):p("Native asset migration failed: "+e.message),!1})):(p(Object(U.jsxs)(U.Fragment,{children:["Please make sure your signer wallet is unlocked, and connected with ",Object(U.jsx)("b",{children:i.address})," to the correct chain: ",Object(U.jsx)("b",{children:s.id})]})),W(!1));case 9:case"end":return e.stop()}}),e)}))),[n,p,O,s,w,i,t,Y,le]),pe=Object(l.useCallback)((function(e){var n=new v.a(e).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals).replace(/\.?0+$/g,"");ae(n),q(e),se(!0)}),[o]);Object(l.useEffect)((function(){var e="".concat(x,"/gasPrice/").concat(s.id);Object(r.c)(e).then((function(e){var n=e.data.gasPrice[k];e.data.gasPrice.maxPriorityFeePerGas&&(n+=e.data.gasPrice.maxPriorityFeePerGas[k]);var t=25e3*n,a=be(b)*n*77e3;Z(new v.a((t+a).toFixed(0)).toFixed(0));var i=new v.a(o.availableBalance).minus(t+a);X(i.gte(0)?i.toFixed(0):0),ue(n)})).catch((function(n){p(n.message+" "+e)}))}),[Z,X,o,s,x,p,k,b]);var ve=Object(l.useCallback)((function(e){if(se(!0),""===e)return ae(0),void q(0);if(e.endsWith(".")&&2===e.split(".").length||2===e.split(".").length&&e.endsWith("0"))ae(e);else if(!isNaN(e)){var n=new v.a(e).toFixed(o.decimals);1===new v.a(n).multipliedBy(Math.pow(10,o.decimals)).comparedTo(o.availableBalance)&&(n=new v.a(o.availableBalance).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals)),n=n.replace(/\.?0+$/g,""),ae(n),q(new v.a(n).multipliedBy(Math.pow(10,o.decimals)).toFixed(0))}}),[o]);return Object(l.useEffect)((function(){var e=new v.a(o.amount).dividedBy(Math.pow(10,o.decimals)).toFixed(o.decimals).replace(/\.?0+$/g,"");ae(e),q(o.amount)}),[o]),Object(l.useEffect)((function(){if(!T){y(function(){var e=[];return I?O?e.push(Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.R,{}),className:"primary full",onClick:function(){return fe()},children:"Next"})):e.push(Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.i,{}),className:"primary full",onClick:function(){return g()},children:"Close"})):n?(e.push(Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.Q,{}),className:"clear",onClick:function(){return me()},children:"Back"},"0")),P?e.push(Object(U.jsxs)(d.e,{icon:Object(U.jsx)(d.m,{}),className:"primary disabled",children:["Moving ",o.name,"..."]},"1")):e.push(Object(U.jsxs)(d.e,{icon:Object(U.jsx)(A.R,{}),className:"primary",onClick:function(){return je()},children:["Move ",o.name]},"1"))):e.push(Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.i,{}),className:"clear full",onClick:function(){return g()},children:"Close"})),e}())}}),[I,O,y,g,P,me,je,fe,n,o,T]),T?Object(U.jsx)(U.Fragment,{}):Object(U.jsx)("div",{children:n&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"migration-native-title mb-4",children:[Object(U.jsx)("div",{className:"migration-native-asset-icon",children:E.includes(o.icon)?Object(U.jsx)(N.d,{size:64}):Object(U.jsx)("img",{src:o.icon,draggable:"false",alt:"Token Icon",onError:function(e){M((function(e){return[].concat(Object(j.a)(e),[o.icon])}))}})}),Object(U.jsxs)("div",{className:"migration-native-title-asset-name",children:["Migrate native asset ",Object(U.jsx)("b",{children:o.name})]})]}),I?Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)("div",{className:"small-asset-notification success",children:["Migration of your ",o.name," was successful"]})}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"migration-native-row",children:[Object(U.jsx)("span",{className:"migration-native-row-key",children:"Current balance"}),Object(U.jsxs)("span",{className:"migration-native-selection",onClick:function(){return pe(o.availableBalance)},children:[new v.a(o.availableBalance).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name]})]}),Object(U.jsxs)("div",{className:"migration-native-row",children:[Object(U.jsx)("span",{className:"migration-native-row-key",children:"Amount to migrate"}),ce||null!==$&&Y>$?Object(U.jsx)(d.w,{className:"migrate-amount-input",value:te,onChange:ve}):Object(U.jsx)("div",{children:te})]}),null!==$&&Y>$&&Object(U.jsxs)("div",{className:"notification-hollow warning mt-4",children:[Object(U.jsxs)("div",{children:[be(b)?"Signer transactions cost":"Current Transaction cost",": ~",new v.a(Q).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name,Object(U.jsxs)("span",{className:"migration-native-usd",children:[" ($",new v.a(Q).multipliedBy(o.rate).toFixed(2),")"]})]}),Object(U.jsx)("div",{className:"mt-3 mb-3",children:$>0?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("span",{children:"You should migrate up to "}),Object(U.jsxs)("span",{className:"migration-native-selection",onClick:function(){return pe($)},children:[new v.a($).dividedBy(Math.pow(10,o.decimals)).toFixed(6)," ",o.name]}),Object(U.jsx)("span",{children:" because will you need funds to pay the transaction costs."})]}):Object(U.jsx)("span",{children:"You do not have enough funds to pay the transaction fee."})})]}),P&&O&&Object(U.jsx)("div",{className:"notification-hollow info mt-4",children:"Waiting for the transaction to be mined before continuing migration..."}),P&&!O&&Object(U.jsxs)("div",{className:"notification-hollow info mt-4",children:["The amount of ",o.name," will be updated in your wallet, once the transaction has been confirmed and mined. If you confirmed your transaction, you can already close this window"]})]})]})})},W=function(e){var n=e.addRequest,t=e.selectedAccount,i=e.accounts,r=e.network,c=e.hideModal,s=e.relayerURL,o=e.portfolio,u=e.setModalButtons,m=e.setModalSteps,f=e.setBeforeCloseModalHandler,b=Object(l.useState)([]),j=Object(a.a)(b,2),p=j[0],v=j[1],h=Object(l.useState)(null),O=Object(a.a)(h,2),g=O[0],x=O[1],y=Object(l.useState)(!1),w=Object(a.a)(y,2),k=w[0],C=w[1],S=Object(l.useState)(!1),N=Object(a.a)(S,2),E=N[0],M=N[1],F=Object(l.useState)(0),L=Object(a.a)(F,2),R=L[0],B=L[1],D=Object(l.useState)([]),W=Object(a.a)(D,2),G=W[0],H=W[1],Y=Object(l.useState)(null),q=Object(a.a)(Y,2),V=q[0],K=q[1],$=Object(l.useState)(!1),X=Object(a.a)($,2),z=X[0],J=X[1],Q=Object(l.useState)(null),Z=Object(a.a)(Q,2),ee=Z[0],ne=Z[1],te=i.find((function(e){return e.id===t}));return Object(l.useEffect)((function(){0===R&&(K(null),v([]),x(null),C(!1),ne(null),f(null))}),[r,t,R,f]),Object(l.useEffect)((function(){E&&(M(!1),x(p.find((function(e){return e.native}))),C(!!p.find((function(e){return!e.native}))))}),[E,te,p,r,t]),Object(l.useEffect)((function(){var e=R;R>0&&!g&&(e-=1),m({steps:G.map((function(e){return{name:e}})),stepIndex:e})}),[g,m,R,G]),Object(l.useEffect)((function(){var e=function(){J(!0),u([Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.Q,{}),className:"clear",onClick:function(){return J(!1)},children:"Back"},"0"),Object(U.jsx)(d.e,{icon:Object(U.jsx)(A.i,{}),className:"danger",onClick:function(){return c()},children:"Close"},"1")])};R>0&&f((function(){return e}))}),[R,f,u,c,z]),Object(U.jsxs)("div",{children:[V&&Object(U.jsx)("div",{className:"mt-3 error",children:V}),Object(U.jsxs)("div",{id:"assets-migration",children:[z&&Object(U.jsx)("div",{className:"notification-hollow warning mt-4",children:"By closing this window, your progress will be lost. Are you sure you want to close this window?"}),0===R&&Object(U.jsx)(I,{hidden:z,signerAccount:te.signer.address,identityAccount:t,network:r,PERMITTABLE_COINS:T,setIsSelectionConfirmed:M,setStep:B,portfolio:o,relayerURL:s,setModalButtons:u,hideModal:c,setError:K,setSelectedTokensWithAllowance:v,setStepperSteps:H,setGasSpeed:ne}),1===R&&g&&Object(U.jsx)(P,{hidden:z,signer:te.signer,identityAccount:t,network:r,addRequest:n,signerExtra:te.signerExtra,setError:K,nativeTokenData:g,hideModal:c,setStep:B,relayerURL:s,hasERC20Tokens:k,setModalButtons:u,setSelectedTokensWithAllowance:v,selectedTokensWithAllowance:p,setBeforeCloseModalHandler:f,gasSpeed:ee}),2===R&&Object(U.jsx)(_,{hidden:z,signer:te.signer,identityAccount:t,network:r,addRequest:n,PERMITTABLE_COINS:T,signerExtra:te.signerExtra,setError:K,selectedTokensWithAllowance:p,hideModal:c,setStep:B,setModalButtons:u,gasSpeed:ee,relayerURL:s})]})]})},G=function(e){var n=e.addRequest,t=e.selectedAccount,i=e.selectedNetwork,r=e.accounts,c=e.relayerURL,s=e.portfolio,u=Object(o.f)(),m=u.hideModal,f=u.setBeforeCloseModalHandler,b=Object(l.useState)(null),j=Object(a.a)(b,2),p=j[0],v=j[1],h=Object(l.useState)({steps:[],stepIndex:0}),O=Object(a.a)(h,2),g=O[0],x=O[1];return Object(U.jsx)(d.n,{id:"asset-migration-modal",title:Object(U.jsxs)("div",{children:[Object(U.jsx)("span",{children:"Migrate Assets"}),Object(U.jsx)(d.v,{steps:g.steps,currentStep:g.stepIndex,noLabels:!1})]}),buttons:p,children:Object(U.jsx)(W,{addRequest:n,selectedAccount:t,network:i,accounts:r,hideModal:m,relayerURL:c,portfolio:s,setModalButtons:v,setModalSteps:x,setBeforeCloseModalHandler:f})})};n.a=function(e){var n,t,i=e.addRequest,r=e.selectedAccount,c=e.accounts,d=e.selectedNetwork,u=e.relayerURL,m=e.portfolio,f=e.closeable,b=void 0!==f&&f,j=e.linkMargin,p=void 0!==j&&j,v=e.useStorage,h=Object(l.useState)(!1),O=Object(a.a)(h,2),g=O[0],x=O[1],y=Object(l.useState)(!1),w=Object(a.a)(y,2),k=w[0],T=w[1],C=Object(o.f)().showModal,S=v({key:"migrationSeen",defaultValue:{}}),N=Object(a.a)(S,2),A=N[0],E=N[1],M=c.find((function(e){return e.id===r}));try{t=Object(R.a)({signer:M.signer,signerExtra:M.signerExtra,chainId:d.chainId})}catch(L){}var F=Object(l.useCallback)((function(){T(!0),E((function(e){return e[r+d.id]=!0,e}))}),[r,d,E]);Object(l.useEffect)((function(){var e=!1;x(!1);return function(n){var t=n.networkId,a=n.identityAccount,i=n.accounts.find((function(e){return e.id===a}));i.signer&&s({networkId:t,account:i.signer.address}).then((function(n){if(!e){var t=n.filter((function(e){return e.balanceUSD>.001}));x(!!t.length)}})).catch((function(e){console.error(e)}))}({identityAccount:r,networkId:d.id,accounts:c}),function(){return e=!0}}),[r,d,c]),Object(l.useEffect)((function(){T(b&&!!A[r+d.id])}),[b,r,d,A]);return(null===(n=t)||void 0===n?void 0:n.provider)||M.signerExtra&&["ledger","trezor","Lattice"].includes(M.signerExtra.type)?g&&!k&&Object(U.jsxs)("div",{className:"migration-banner",children:[Object(U.jsxs)("div",{className:"migration-banner-message",children:[Object(U.jsx)("div",{children:"We detected that your signer account has tokens that can be transferred to your Ambire account. We recommend doing this in order to maximize your $WALLET rewards."}),Object(U.jsx)("span",{className:"link"+(p?" link-margin":""),onClick:function(){C(Object(U.jsx)(G,{addRequest:i,selectedNetwork:d,selectedAccount:r,accounts:c,relayerURL:u,portfolio:m}))},children:"Click here to migrate those tokens"})]}),b&&Object(U.jsx)("div",{className:"migration-banner-close",children:Object(U.jsx)(B.g,{onClick:function(){return F()}})})]}):Object(U.jsx)(U.Fragment,{})}}}]);
//# sourceMappingURL=20.c4970539.chunk.js.map