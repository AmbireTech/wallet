(this["webpackJsonpambire-wallet"]=this["webpackJsonpambire-wallet"]||[]).push([[5],{592:function(e,t,n){(function(t){var r=n(608).BN;function a(e){if("string"!==typeof e||42!==e.length||!e.startsWith("0x"))throw new Error("invalid address: must start with a 0x and be 42 characters long");return e}function s(e){if("string"===typeof e&&e.startsWith("0x")&&66===e.length)return t.from(e.slice(2),"hex");if(32!==e.length||!t.isBuffer(e))throw new Error("32 byte Buffer expected");return e}e.exports={Uint256:function(e){var t=new r(e,10);if(t.isNeg())throw new Error("uint256 expected, negative number given");return t},Bytes32:s,Address:a,Bytes:function(e){if("string"===typeof e&&e.startsWith("0x"))return t.from(e.slice(2),"hex");if(!t.isBuffer(e))throw new Error("Buffer expected");return e},Bytes32Array:function(e,t){return(-1===t||void 0===t||e.length===t)&&e.map((function(e){return s(e)}))},Channel:function(e){return a(e.leader),a(e.follower),a(e.guardian),a(e.tokenAddr),s(e.nonce),e}}}).call(this,n(25).Buffer)},628:function(e,t,n){var r=n(358),a=n(2),s=n(185),i=n(52).utils,u=i.AbiCoder,c=i.hexlify,o=i.arrayify,p=i.keccak256,y=i.Interface,d=n(52),l=d.Contract,m=d.BigNumber,f=n(592),h=n(360),b=n(647),g=new y(h);function T(e){return this.identity=f.Address(e.identity),this.network=e.network,this.signer=e.signer,this.txns=e.txns,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.signature=e.signature,this.minFeeInUSDPerGas=e.minFeeInUSDPerGas,this.recoveryMode=e.recoveryMode,this.meta=e.meta,this.gasTankFee=e.gasTankFee,this}T.prototype.getNonce=function(){var e=s(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t,this);case 2:return this.nonce=e.sent,e.abrupt("return",this.nonce);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),T.prototype.estimate=function(){var e=s(a.mark((function e(t){var n,s,i,u,c,o,p;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fetch,s=t.relayerURL,i=t.replacing,u=t.getNextNonce,c=t.gasTank,o=Object.fromEntries(Object.entries({getNextNonce:u,gasTank:c}).filter((function(e){var t=r(e,2);t[0];return t[1]}))),e.next=4,R(n,"".concat(s,"/identity/").concat(this.identity,"/").concat(this.network,"/estimate?").concat(new URLSearchParams(o).toString()),{txns:this.txns,signer:this.signer,replacing:i,minFeeInUSDPerGas:this.minFeeInUSDPerGas});case 4:return p=e.sent,this.gasLimit=p.gasLimit,e.abrupt("return",p);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),T.prototype.sign=function(){var e=s(a.mark((function e(t,n){var r,s,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!isNaN(this.nonce)){e.next=2;break}throw new Error("nonce is not set");case 2:if(!isNaN(this.gasLimit)){e.next=4;break}throw new Error("gasLimit is not set");case 4:return r=v(this,n),s=o(p(r)),e.next=8,L(t,s);case 8:return i=e.sent,this.signature=i,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),T.prototype.submit=function(){var e=s(a.mark((function e(t){var n,r,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fetch,r=t.relayerURL,e.next=3,R(n,"".concat(r,"/identity/").concat(this.identity,"/").concat(this.network,"/submit"),{nonce:this.nonce,signer:this.signer,txns:this.txns,gasLimit:this.gasLimit,signature:this.signature,signatureTwo:this.signatureTwo,meta:this.meta,gasTankFee:this.gasTankFee});case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),T.prototype.cancel=function(){var e=s(a.mark((function e(t){var n,r,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fetch,r=t.relayerURL,e.next=3,R(n,"".concat(r,"/identity/").concat(this.identity,"/").concat(this.network,"/cancel"),{nonce:this.nonce,signer:this.signer});case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();var x=/gas required exceeds allowance|always failing transaction|execution reverted/;function w(){return(w=s(a.mark((function e(t,n,r,s,i){var c,o,p,y;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.address){e.next=2;break}return e.abrupt("return",L(t,s,!0));case 2:if(!r.quickAccManager){e.next=10;break}return e.next=5,L(t,s,!0);case 5:return c=e.sent,o=new u,p=o.encode(["uint","bytes","bytes"],[r.timelock,c,i]),y="".concat(p+o.encode(["address"],[r.quickAccManager]).slice(2),"02"),e.abrupt("return",y);case 10:throw new Error("invalid signer object");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=s(a.mark((function e(t,n,r,s,i,c,o){var p,y,d,l;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.address){e.next=2;break}return e.abrupt("return",N(t,s,i,c));case 2:if(!r.quickAccManager){e.next=10;break}return e.next=5,N(t,s,i,c);case 5:return p=e.sent,y=new u,d=y.encode(["uint","bytes","bytes"],[r.timelock,p,o]),l="".concat(d+y.encode(["address"],[r.quickAccManager]).slice(2),"02"),e.abrupt("return",l);case 10:throw new Error("invalid signer object");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){var n=new u,r=e.signer;if(r.address)return n.encode(["address","uint","uint","tuple(address, uint, bytes)[]"],[e.identity,A(e.network),e.nonce,e.txns]);if(r.quickAccManager){var a=p(n.encode(["tuple(uint, address, address)"],[[e.signer.timelock,e.signer.one,e.signer.two]]));return n.encode(["address","uint","address","bytes32","uint","tuple(address, uint, bytes)[]","bool"],[r.quickAccManager,A(e.network),e.identity,a,e.nonce,e.txns,!t])}throw new Error("invalid signer object")}function A(e){if("ethereum"===e)return 1;if("polygon"===e)return 137;if("binance-smart-chain"===e)return 56;if("bsc"===e)return 56;if("fantom"===e)return 250;if("avalanche"===e)return 43114;if("arbitrum"===e)return 42161;if("moonbeam"===e)return 1284;if("moonriver"===e)return 1285;if("gnosis"===e)return 100;if("kucoin"===e)return 321;if("andromeda"===e)return 1088;if("cronos"===e)return 25;if("aurora"===e)return 1313161554;if("rinkeby"===e)return 4;if("optimism"===e)return 10;throw new Error("unsupported network ".concat(e))}function M(e){var t=o(e);return t[64]<27&&(t[64]+=27),c(t)}function L(e,t){return I.apply(this,arguments)}function I(){return I=s(a.mark((function e(t,n){var r,s=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],e.t0="",e.t1=M,e.next=5,t.signMessage(n);case 5:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.abrupt("return",e.t0.concat.call(e.t0,e.t3).concat(r?"00":"01"));case 8:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function N(e,t,n,r){return E.apply(this,arguments)}function E(){return(E=s(a.mark((function e(t,n,r,s){var i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._signTypedData(n,r,s);case 2:return i=e.sent,e.abrupt("return","".concat(M(i),"00"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return B.apply(this,arguments)}function B(){return(B=s(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n.signer.quickAccManager){e.next=7;break}return e.next=4,new l(n.signer.quickAccManager,b,t).nonces(n.identity);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,new l(n.identity,h,t).nonce();case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0.toNumber());case 13:if(e.prev=13,e.t1=e.catch(0),e.t2="CALL_EXCEPTION"===e.t1.code,!e.t2){e.next=21;break}return e.next=19,t.getCode(n.identity);case 19:e.t3=e.sent,e.t2="0x"===e.t3;case 21:if(!e.t2){e.next=23;break}return e.abrupt("return",0);case 23:throw e.t1;case 24:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function R(e,t,n){return D.apply(this,arguments)}function D(){return(D=s(a.mark((function e(t,n,r){var s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n,{headers:{"content-type":"application/json"},method:"POST",body:JSON.stringify(r)});case 2:return s=e.sent,e.abrupt("return",s.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}T.prototype.estimateNoRelayer=function(){var e=s(a.mark((function e(t){var n,r,s,i,u,c,o,p,y,d,l;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.provider,r=t.replacing,s={from:this.signer.quickAccManager||this.signer.address,to:this.identity,data:g.encodeFunctionData("executeBySender",[this.txns])},i=r?"latest":"pending",e.next=5,C(n,i,s);case 5:if(u=e.sent,c=u.error,o=u.gasLimit,!c||!c.message.startsWith("execution reverted: ")){e.next=11;break}return p=c.message.slice(20),e.abrupt("return",{success:!1,message:p});case 11:if(!c){e.next=18;break}if("UNPREDICTABLE_GAS_LIMIT"===c.code||c.message.match(x)){e.next=14;break}throw c;case 14:return e.next=16,Q(n,s,i);case 16:return e.t0=e.sent,e.abrupt("return",{success:!1,message:e.t0});case 18:return this.gasLimit=o.toNumber(),e.next=21,n.getFeeData();case 21:return y=e.sent,d=y.gasPrice.toNumber(),l=d*o/1e18,e.abrupt("return",{success:!0,gasLimit:this.gasLimit,gasPrice:d,feeInNative:{slow:.9*l,medium:1*l,fast:1.15*l,ape:1.4*l}});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();var P="0x08c379a0";function Q(e,t,n){return U.apply(this,arguments)}function U(){return(U=s(a.mark((function e(t,n,r){var s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.call(n,r);case 3:return s=e.sent,e.abrupt("return",s.startsWith(P)?(new u).decode(["string"],"0x".concat(s.slice(10)))[0]:s);case 7:if(e.prev=7,e.t0=e.catch(0),"UNPREDICTABLE_GAS_LIMIT"!==e.t0.code||!e.t0.error){e.next=11;break}return e.abrupt("return",e.t0.error.message.slice(20));case 11:if("CALL_EXCEPTION"!==e.t0.code){e.next=13;break}return e.abrupt("return","no error string, possibly insufficient amount");case 13:if("INVALID_ARGUMENT"!==e.t0.code){e.next=15;break}return e.abrupt("return","unable to deserialize: ".concat(c(e.t0.value)));case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function C(e,t,n){return _.apply(this,arguments)}function _(){return(_=s(a.mark((function e(t,n,r){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.send("eth_estimateGas",[r,n]).then((function(e){return{gasLimit:m.from(e)}})).catch((function(e){return"SERVER_ERROR"===e.code?{error:e.error}:{error:e}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports={Bundle:T,signMessage:function(e,t,n,r,a){return w.apply(this,arguments)},signMessage712:function(e,t,n,r,a,s,i){return k.apply(this,arguments)},getSignable:v,signMsg:L,signMsg712:N}},647:function(e){e.exports=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"txnHash","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"accHash","type":"bytes32"},{"indexed":true,"internalType":"address","name":"signer","type":"address"},{"indexed":false,"internalType":"uint256","name":"time","type":"uint256"}],"name":"LogCancelled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"txnHash","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"accHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"time","type":"uint256"}],"name":"LogExecScheduled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"txnHash","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"accHash","type":"bytes32"},{"indexed":true,"internalType":"address","name":"signer","type":"address"},{"indexed":false,"internalType":"uint256","name":"nonce","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"time","type":"uint256"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"indexed":false,"internalType":"struct Identity.Transaction[]","name":"txns","type":"tuple[]"}],"name":"LogScheduled","type":"event"},{"inputs":[],"name":"DOMAIN_SEPARATOR","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract Identity","name":"identity","type":"address"},{"components":[{"internalType":"uint256","name":"timelock","type":"uint256"},{"internalType":"address","name":"one","type":"address"},{"internalType":"address","name":"two","type":"address"}],"internalType":"struct QuickAccManager.QuickAccount","name":"acc","type":"tuple"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"bytes","name":"sig","type":"bytes"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"internalType":"struct Identity.Transaction[]","name":"txns","type":"tuple[]"}],"name":"cancel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract Identity","name":"identity","type":"address"},{"internalType":"bytes32","name":"accHash","type":"bytes32"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"internalType":"struct Identity.Transaction[]","name":"txns","type":"tuple[]"}],"name":"execScheduled","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"hash","type":"bytes32"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"isValidSignature","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"nonces","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"scheduled","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract Identity","name":"identity","type":"address"},{"components":[{"internalType":"uint256","name":"timelock","type":"uint256"},{"internalType":"address","name":"one","type":"address"},{"internalType":"address","name":"two","type":"address"}],"internalType":"struct QuickAccManager.QuickAccount","name":"acc","type":"tuple"},{"components":[{"internalType":"bool","name":"isBothSigned","type":"bool"},{"internalType":"bytes","name":"one","type":"bytes"},{"internalType":"bytes","name":"two","type":"bytes"}],"internalType":"struct QuickAccManager.DualSig","name":"sigs","type":"tuple"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"internalType":"struct Identity.Transaction[]","name":"txns","type":"tuple[]"}],"name":"send","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract Identity","name":"identity","type":"address"},{"components":[{"internalType":"uint256","name":"timelock","type":"uint256"},{"internalType":"address","name":"one","type":"address"},{"internalType":"address","name":"two","type":"address"}],"internalType":"struct QuickAccManager.QuickAccount","name":"acc","type":"tuple"},{"components":[{"internalType":"bytes","name":"one","type":"bytes"},{"internalType":"bytes","name":"two","type":"bytes"}],"internalType":"struct QuickAccManager.DualSigAlwaysBoth","name":"sigs","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"fee","type":"uint256"}],"internalType":"struct QuickAccManager.Transfer","name":"t","type":"tuple"}],"name":"sendTransfer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract Identity","name":"identity","type":"address"},{"components":[{"internalType":"uint256","name":"timelock","type":"uint256"},{"internalType":"address","name":"one","type":"address"},{"internalType":"address","name":"two","type":"address"}],"internalType":"struct QuickAccManager.QuickAccount","name":"acc","type":"tuple"},{"components":[{"internalType":"bytes","name":"one","type":"bytes"},{"internalType":"bytes","name":"two","type":"bytes"}],"internalType":"struct QuickAccManager.DualSigAlwaysBoth","name":"sigs","type":"tuple"},{"components":[{"internalType":"string","name":"description","type":"string"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"internalType":"struct QuickAccManager.Txn[]","name":"txns","type":"tuple[]"}],"name":"sendTxns","outputs":[],"stateMutability":"nonpayable","type":"function"}]')}}]);
//# sourceMappingURL=5.0d1e2c36.chunk.js.map