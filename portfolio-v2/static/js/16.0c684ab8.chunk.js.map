{"version":3,"sources":["components/Wallet/Transactions/Transactions.js","../node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/adex-protocol-eth/js/ensureTypes.js","../node_modules/ethjs-util/lib/index.js","lib/icons.js","../node_modules/@babel/runtime/helpers/defineProperty.js","lib/formatters.js","../node_modules/@babel/runtime/helpers/objectSpread2.js","../node_modules/adex-protocol-eth/js/Bundle.js","../node_modules/adex-protocol-eth/js/index.js","../node_modules/adex-protocol-eth/js/Channel.js","../node_modules/adex-protocol-eth/js/Withdraw.js","../node_modules/adex-protocol-eth/js/MerkleTree.js","../node_modules/adex-protocol-eth/js/splitSig.js","../node_modules/adex-protocol-eth/js/UnbondCommitment.js","../node_modules/adex-protocol-eth/js/Permit.js","../node_modules/is-hex-prefixed/src/index.js","components/SendTransaction/helpers.js","../node_modules/strip-hex-prefix/src/index.js","components/common/TxnPreview/TxnPreview.js","../../modules/BrowserRouter.js","../../modules/HashRouter.js","../../modules/utils/locationUtils.js","../../modules/Link.js","../../modules/NavLink.js"],"names":["BundlePreview","React","memo","bundle","mined","feeAssets","useConstants","constants","tokenList","humanizerInfo","network","networks","find","x","id","Array","isArray","txns","className","date","lastTxn","length","lastTxnSummary","getTransactionSummary","identity","hasFeeMatch","match","RegExp","gasTankFee","slice","feeTokenDetails","i","symbol","feeToken","savedGas","getAddedGas","splittedLastTxnSummary","split","fee","cashback","formatUnits","toString","decimals","price","totalSaved","feeInUSDPerGas","map","txn","account","addressLabel","meta","formatFloatTokenAmount","join","executed","success","errorMsg","label","gasLimit","submittedAt","Date","toLocaleDateString","toLocaleTimeString","style","color","replacesTxId","txId","href","explorerUrl","target","rel","_id","Transactions","relayerURL","selectedAcc","selectedNetwork","showSendTxns","addRequest","eligibleRequests","setSendTxnState","addToast","useToasts","history","useHistory","params","useParams","useState","now","cacheBreak","setCacheBreak","useEffect","intvl","setTimeout","clearTimeout","url","useRelayerData","data","errMsg","isLoading","urlGetFeeAssets","showSendTxnsForReplacement","useCallback","forEach","index","dateAdded","valueOf","chainId","type","to","toLowerCase","value","showing","replaceByDefault","mustReplaceNonce","nonce","executedTransactions","filter","maxPages","Math","ceil","defaultPage","useMemo","min","max","Number","page","setPage","bundlesList","replace","removeFeeTxnFromBundleIfGasTankDisabled","allPending","replaced","firstPending","mapToBundle","relayerBundle","extra","Bundle","num","minFeeInUSDPerGas","cancelByReplacing","replacementBundle","paginationControls","clear","mini","onClick","size","req","disableExpand","toBundleTxn","small","icon","cancel","fetch","then","message","includes","catch","e","console","error","warning","condition","BN","require","Address","startsWith","Error","Bytes32","b","Buffer","from","isBuffer","module","exports","Uint256","bn","isNeg","Bytes","Bytes32Array","bytes32Array","undefined","Channel","channel","leader","follower","guardian","tokenAddr","isHexPrefixed","stripHexPrefix","padToEven","a","intToHex","arrayContainsArray","superset","subset","some","Boolean","indexOf","intToBuffer","hex","getBinarySize","str","byteLength","fromAscii","stringValue","n","charCodeAt","fromUtf8","toAscii","l","substring","code","parseInt","substr","String","fromCharCode","toUtf8","getKeys","key","allowEmpty","result","push","isHexString","customIcons","zapperStorageTokenIcons","getTokenIcon","networkId","address","addr","net","obj","Object","defineProperty","enumerable","configurable","writable","amount","useGrouping","maximumFractionDigits","isNaN","parseFloat","minimumFractionDigits","toLocaleString","err","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","apply","arguments","source","getOwnPropertyDescriptors","defineProperties","utils","AbiCoder","hexlify","arrayify","keccak256","Interface","Contract","BigNumber","ensure","IdentityABI","QuickAccManagerABI","IdentityInterface","args","this","signer","signature","recoveryMode","prototype","getNonce","provider","estimate","replacing","getNextNonce","gasTank","queryParams","fromEntries","entries","fetchPost","URLSearchParams","res","sign","wallet","isSingleSigMode","encoded","getSignable","hash","signMsg","submit","signatureTwo","UNPREDICTABLE_GAS_REGEX","quickAccManager","signatureOne","abiCoder","sigInner","encode","timelock","sig","domain","types","signMsg712","userTxnBundle","getChainID","accHash","one","two","mapSignatureV","sigRaw","useFinalDigestSigMode","signMessage","_signTypedData","typedDataSign","nonces","toNumber","getCode","body","headers","method","JSON","stringify","r","json","estimateNoRelayer","txParams","encodeFunctionData","blockTag","estimateGasWithCatch","getErrMsg","getFeeData","feeData","gasPrice","baseFee","feeInNative","slow","medium","fast","ape","ERROR_SIG","call","returnData","decode","tx","send","signMessage712","channelLib","withdrawalLib","MerkleTree","splitSig","unbondCommitmentlLib","Permit","bundleLib","abi","freeze","arrayBuffer","rawEncode","hashHex","toSolidityTuple","hashToSign","contractAddr","balanceRoot","getSignableStateRoot","hashToSignHex","stateRoot","getResumeSignableMessage","challengeExpires","solidityPack","getResumeSignableMessageHex","channelId","getBalanceLeaf","acc","amnt","getSpenderBalanceLeaf","ChannelState","Challenged","Active","Withdraw","balanceTreeAmount","sigLeader","sigFollower","proof","combinedHash","first","second","sorted","concat","sort","compare","getLayers","elements","layers","getNextLayer","reduce","layer","element","arr","_elements","every","buffers","buffer","findIndex","equals","assign","root","getRoot","pair","pairIndex","getPair","floor","inputSig","s","v","UnbondCommitment","owner","shares","unlocksAt","buf","defaultAbiCoder","toUtf8Bytes","PERMIT_TYPEHASH","getDomainSeparator","name","tokenAddress","getApprovalDigest","token","approve","deadline","DOMAIN_SEPARATOR","spender","isTokenEligible","speed","estimation","isGasTankEnabled","relayerless","feeInFeeToken","getFeesData","balance","pow","contractErrors","mapTxnErrMsg","msg","contractMsg","getErrHint","checkIfDAppIncompatible","toHexAmount","round","getDiscountApplied","discount","feeInUSD","multiplier","addedGas","toFixed","getFeePaymentConsequences","discountMultiplier","totalMultiplier","nativeRate","isCrossChainNativeSelected","customFee","nativeAssetPriceInUSD","getNetworkSymbol","nativeAssetSymbol","TxnPreview","onDismiss","isFirstFailing","disableDismiss","disableDismissLabel","isExpanded","setExpanded","contractName","getName","networkDetails","summary","extended","entry","item","foundToken","backgroundImage","stopPropagation","disabled","canShowLink","parseExtendedSummaryItem","setKnownAddressNames","isKnown","BrowserRouter","createHistory","_this","props","render","Router","children","Component","HashRouter","resolveToLocation","currentLocation","normalizeToLocation","createLocation","forwardRefShim","C","forwardRef","shiftKey","LinkAnchor","forwardedRef","innerRef","navigate","rest","event","ex","preventDefault","defaultPrevented","button","metaKey","altKey","ctrlKey","isModifiedEvent","ref","Link","component","RouterContext","Consumer","context","invariant","location","createHref","isDuplicateNavigation","createPath","createElement","NavLink","ariaCurrent","activeClassName","activeStyle","classNameProp","exact","isActiveProp","isActive","locationProp","sensitive","strict","styleProp","toLocation","path","pathname","escapedPath","matchPath","joinClassnames","classnames"],"mappings":"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","file":"static/js/16.0c684ab8.chunk.js","sourcesContent":["import './Transactions.scss'\nimport { FaSignature } from 'react-icons/fa'\nimport { BsCoin, BsCalendarWeek, BsGlobe2, BsCheck2All } from 'react-icons/bs'\nimport { MdOutlinePendingActions, MdShuffle, MdCheck, MdOutlineSavings } from 'react-icons/md'\nimport { useRelayerData } from 'hooks'\nimport TxnPreview from 'components/common/TxnPreview/TxnPreview'\nimport { Loading, Button } from 'components/common'\nimport networks from 'consts/networks'\nimport { getTransactionSummary } from 'lib/humanReadableTransactions'\nimport { Bundle } from 'adex-protocol-eth'\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport fetch from 'node-fetch'\nimport { useToasts } from 'hooks/toasts'\nimport { toBundleTxn } from 'ambire-common/src/services/requestToBundleTxn'\nimport { HiOutlineChevronLeft, HiOutlineChevronRight } from 'react-icons/hi'\nimport { useHistory, useParams } from 'react-router-dom/cjs/react-router-dom.min'\nimport { formatFloatTokenAmount } from 'lib/formatters'\nimport { formatUnits } from 'ethers/lib/utils'\nimport { ToolTip } from 'components/common' \n// eslint-disable-next-line import/no-relative-parent-imports\nimport { getAddedGas } from '../../SendTransaction/helpers'\nimport useConstants from 'hooks/useConstants'\n\n// 10% in geth and most EVM chain RPCs; relayer wants 12%\nconst RBF_THRESHOLD = 1.14\nconst TO_GAS_TANK = `to Gas Tank`\n\n\nfunction Transactions ({ relayerURL, selectedAcc, selectedNetwork, showSendTxns, addRequest, eligibleRequests, setSendTxnState }) {\n  const { addToast } = useToasts()\n  const history = useHistory()\n  const params = useParams()\n\n  const [cacheBreak, setCacheBreak] = useState(() => Date.now())\n  \n  // @TODO refresh this after we submit a bundle; perhaps with the upcoming transactions service\n  // We want this pretty much on every rerender with a 5 sec debounce\n  useEffect(() => {\n    if ((Date.now() - cacheBreak) > 5000) setCacheBreak(Date.now())\n    const intvl = setTimeout(() => setCacheBreak(Date.now()), 10000)\n    return () => clearTimeout(intvl)\n  }, [cacheBreak])\n  const url = relayerURL\n    ? `${relayerURL}/identity/${selectedAcc}/${selectedNetwork.id}/transactions?cacheBreak=${cacheBreak}`\n    : null\n  const { data, errMsg, isLoading } = useRelayerData({ url })\n  const urlGetFeeAssets = relayerURL ? `${relayerURL}/gas-tank/assets?cacheBreak=${cacheBreak}` : null\n  const { data: feeAssets } = useRelayerData({ url: urlGetFeeAssets })\n\n  const showSendTxnsForReplacement = useCallback(bundle => {\n    bundle.txns\n      .forEach((txn, index) => {\n        addRequest({\n          id: 'replace_'+index,\n          dateAdded: new Date().valueOf(),\n          chainId: selectedNetwork.chainId,\n          account: selectedAcc,\n          type: 'eth_sendTransaction',\n          txn: {\n            to: txn[0].toLowerCase(),\n            value: txn[1] === \"0x\" ? \"0x0\" : txn[1],\n            data: txn[2]\n          }\n        })\n      })\n\n    setSendTxnState({ showing: true, replaceByDefault: true, mustReplaceNonce: bundle.nonce })\n  }, [addRequest, selectedNetwork, selectedAcc, setSendTxnState])\n\n  const maxBundlePerPage = 10\n  const executedTransactions = data ? data.txns.filter(x => x.executed) : []\n  const maxPages = Math.ceil(executedTransactions.length / maxBundlePerPage)\n\n  const defaultPage = useMemo(() => Math.min(Math.max(Number(params.page), 1), maxPages) || 1, [params.page, maxPages])\n  const [page, setPage] = useState(defaultPage)\n\n  const bundlesList = executedTransactions\n    .slice((page - 1) * maxBundlePerPage, page * maxBundlePerPage)\n    .map(bundle => <BundlePreview bundle={bundle} mined={true} feeAssets={feeAssets} />)\n\n  useEffect(() => !isLoading && history.replace(`/wallet/transactions/${page}`), [page, history, isLoading])\n  useEffect(() => setPage(defaultPage), [selectedAcc, selectedNetwork, defaultPage])\n\n  // @TODO implement a service that stores sent transactions locally that will be used in relayerless mode\n  if (!relayerURL) return (<section id='transactions'>\n    <h3 className='validation-error'>Unsupported: not currently connected to a relayer.</h3>\n  </section>)\n\n  // Removed fee txn if Gas tank is not used for payment method\n  const removeFeeTxnFromBundleIfGasTankDisabled = bundle => !bundle.gasTankFee ?  { ...bundle, txns: bundle.txns.slice(0, -1) } : bundle\n\n  // @TODO: visualize other pending bundles\n  const allPending = data && data.txns.filter(x => !x.executed && !x.replaced)\n  const firstPending = allPending && allPending[0]\n\n  const mapToBundle = (relayerBundle, extra = {}) => (new Bundle({\n    ...relayerBundle,\n    nonce: relayerBundle.nonce.num,\n    gasLimit: null,\n    // Instruct the relayer to abide by this minimum fee in USD per gas, to ensure we are truly replacing the txn\n    minFeeInUSDPerGas: relayerBundle.feeInUSDPerGas * RBF_THRESHOLD,\n    ...extra\n  }))\n  const cancelByReplacing = relayerBundle => setSendTxnState({\n    showing: true,\n    replacementBundle: mapToBundle(relayerBundle, {\n      txns: [[selectedAcc, '0x0', '0x']],\n    }),\n    mustReplaceNonce: relayerBundle.nonce.num\n  })\n  const cancel = relayerBundle => {\n    // @TODO relayerless\n    mapToBundle(relayerBundle).cancel({ relayerURL, fetch })\n      .then(({ success, message }) => {\n        if (!success) {\n          if (message.includes('not possible to cancel')) {\n            addToast('Transaction already picked up by the network, you will need to pay a fee to replace it with a cancellation transaction.')\n          } else {\n            addToast(`Not possible to cancel: ${message}, you will need to pay a fee to replace it with a cancellation transaction.`)\n          }\n          cancelByReplacing(relayerBundle)\n        } else {\n          addToast('Transaction cancelled successfully')\n        }\n      })\n      .catch(e => {\n        console.error(e)\n        cancelByReplacing(relayerBundle)\n      })\n  }\n\n  // @TODO: we are currently assuming the last txn is a fee; change that (detect it)\n  const speedup = relayerBundle => setSendTxnState({\n    showing: true,\n    replacementBundle: mapToBundle(removeFeeTxnFromBundleIfGasTankDisabled(relayerBundle)),\n    mustReplaceNonce: relayerBundle.nonce.num\n  })\n  const replace = relayerBundle => showSendTxnsForReplacement(mapToBundle(removeFeeTxnFromBundleIfGasTankDisabled(relayerBundle)))\n\n  const paginationControls = (\n    <div className='pagination-controls'>\n      <div className='pagination-title'>Page</div>\n      <Button clear mini onClick={() => page > 1 && setPage(page => page - 1)}><HiOutlineChevronLeft/></Button>\n      <div className='pagination-current'>{ page } <span>/ { maxPages }</span></div>\n      <Button clear mini onClick={() => page < maxPages && setPage(page => page + 1)}><HiOutlineChevronRight/></Button>\n    </div>\n  )\n\n  return (\n    <section id='transactions'>\n      {!!eligibleRequests.length && (<div className='panel' id=\"waiting-transactions\">\n        <div className='panel-heading'>\n          <div className='title'><FaSignature size={25}/>Waiting to be signed (current batch)</div>\n        </div>\n        <div className=\"content\">\n          <div className=\"bundle\">\n            <div className=\"bundle-list\" onClick={() => showSendTxns(null)}>\n              {eligibleRequests.map(req => (\n                <TxnPreview\n                  key={req.id}\n                  network={selectedNetwork.id}\n                  account={selectedAcc}\n                  disableExpand={true}\n                  txn={toBundleTxn(req.txn, selectedAcc)}\n                />\n              ))}\n            </div>\n              <div className='actions'>\n                {/*\n                <Button small className='cancel' onClick={\n                  () => resolveMany(eligibleRequests.map(x => x.id), { message: 'Ambire user rejected all requests' })\n                }>Reject all</Button>*/}\n                <Button small clear icon={<MdCheck/>} onClick={() => showSendTxns(null)}>Sign or reject</Button>\n              </div>\n          </div>\n        </div>\n      </div>)}\n      { !!firstPending && (<div className='panel' id=\"pending\">\n        <div className='panel-heading'>\n          <div className='title'><MdOutlinePendingActions/>Pending transaction bundle</div>\n        </div>\n        <div className=\"content\">\n          <div className=\"bundle\">\n            <BundlePreview bundle={firstPending} feeAssets={feeAssets} />\n            <div className='actions'>\n              <Button small onClick={() => replace(firstPending)}>Replace or modify</Button>\n              <Button small className='cancel' onClick={() => cancel(firstPending)}>Cancel</Button>\n              <Button small onClick={() => speedup(firstPending)}>Speed up</Button>\n            </div>\n          </div>\n        </div>\n      </div>) }\n      {allPending && allPending.length > 1 && (<h4>NOTE: There are a total of {allPending.length} pending transaction bundles.</h4>)}\n\n      <div id=\"confirmed\" className=\"panel\">\n        <div className=\"panel-heading\">\n          <div className='title'>\n            <BsCheck2All/>\n            {(data && data.txns.length === 0) ? 'No transactions yet.' : 'Confirmed transactions'}\n          </div>\n          { !bundlesList.length ? null : paginationControls }\n        </div>\n        <div className=\"content\">\n          {!relayerURL && (<h3 className='validation-error'>Unsupported: not currently connected to a relayer.</h3>)}\n          {errMsg && (<h3 className='validation-error'>Error getting list of transactions: {errMsg}</h3>)}\n          {\n            isLoading && !data ? <Loading /> :\n              !bundlesList.length ? null :\n                <>\n                  { bundlesList }\n                  { paginationControls }\n                </>\n          }\n        </div>\n      </div>\n    </section>\n  )\n}\n\nconst BundlePreview = React.memo(({ bundle, mined = false, feeAssets }) => {\n  const { constants: { tokenList, humanizerInfo } } = useConstants()\n  const network = networks.find(x => x.id === bundle.network)\n  if (!Array.isArray(bundle.txns)) return (<h3 className='error'>Bundle has no transactions (should never happen)</h3>)\n  const lastTxn = bundle.txns[bundle.txns.length - 1]\n  // terribly hacky; @TODO fix\n  // all of the values are prob checksummed so we may not need toLowerCase\n  const lastTxnSummary = getTransactionSummary(humanizerInfo, tokenList, lastTxn, bundle.network, bundle.identity)\n  const hasFeeMatch = (bundle.txns.length > 1) && lastTxnSummary.match(new RegExp(TO_GAS_TANK, 'i'))\n  const txns = (hasFeeMatch && !bundle.gasTankFee) ? bundle.txns.slice(0, -1) : bundle.txns\n  const toLocaleDateTime = date => `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`\n  const feeTokenDetails = feeAssets ? feeAssets.find(i => i.symbol === bundle.feeToken) : null\n  const savedGas = feeTokenDetails ? getAddedGas(feeTokenDetails) : null\n  const splittedLastTxnSummary = lastTxnSummary.split(' ')\n  const fee = splittedLastTxnSummary.length ? splittedLastTxnSummary[1] + ' ' + splittedLastTxnSummary[2] : []\n  const cashback = (bundle.gasTankFee && bundle.gasTankFee.cashback && feeTokenDetails) ? \n    (formatUnits(bundle.gasTankFee.cashback.toString(), feeTokenDetails?.decimals).toString() * feeTokenDetails?.price) : 0\n  const totalSaved =  savedGas && \n    ((bundle.feeInUSDPerGas * savedGas) + cashback)\n\n  return (<div className='bundlePreview bundle' key={bundle._id}>\n    {txns.map((txn, i) => (<TxnPreview\n      key={i} // safe to do this, individual TxnPreviews won't change within a specific bundle\n      txn={txn} network={bundle.network} account={bundle.identity} mined={mined} \n      addressLabel={!!bundle.meta && bundle.meta.addressLabel}\n      feeAssets={feeAssets}\n      />\n    ))}\n    <ul className=\"details\">\n      {\n        (hasFeeMatch && !bundle.gasTankFee) ?\n          <li>\n            <label><BsCoin/>Fee</label>\n            <p>{ fee.split(' ').map((x, i) => i === 0 ? formatFloatTokenAmount(x, true, 8) : x).join(' ') }</p>\n          </li>\n          :\n          null\n      }\n      {\n        bundle.executed && !bundle.executed.success && (\n          <li>\n            <label>Error</label>\n            <p>{bundle.executed.errorMsg || 'unknown error'}</p>\n          </li>\n        )\n      }\n      {\n        bundle.gasTankFee && (feeTokenDetails !== null) && mined && (\n        <>\n          { savedGas &&(\n            <ToolTip label={`\n              You saved $ ${formatFloatTokenAmount(bundle.feeInUSDPerGas * savedGas, true, 6)}, ${ (cashback > 0) ? `and got back $ ${formatFloatTokenAmount(cashback, true, 6)} as cashback,` : ''} ended up paying only $ ${formatFloatTokenAmount(((bundle.feeInUSDPerGas * bundle.gasLimit) - cashback), true, 6)}\n            `}>\n              <li>\n                <label><BsCoin/>Fee (Paid with Gas Tank)</label>\n                <p>$ {formatFloatTokenAmount(((bundle.feeInUSDPerGas * bundle.gasLimit) - cashback), true, 6)}</p>\n              </li>\n            </ToolTip>\n          )}\n          { savedGas && ( \n            <ToolTip label={`\n              Saved: $ ${formatFloatTokenAmount(bundle.feeInUSDPerGas * savedGas, true, 6)}\n              ${ (cashback > 0) ? `Cashback: $ ${formatFloatTokenAmount(cashback, true, 6)}` : ''}\n            `}>\n              <li>\n                <label><MdOutlineSavings/>Total Saved</label>\n                $ {formatFloatTokenAmount(totalSaved, true, 6)}\n              </li>\n            </ToolTip>\n          )}\n        </>) \n      }\n      <li>\n        <label><BsCalendarWeek/>Submitted on</label>\n        <p>{bundle.submittedAt && (toLocaleDateTime(new Date(bundle.submittedAt))).toString()}</p>\n      </li>\n      { bundle.gasTankFee && !mined && (\n            <li>\n              <label><MdOutlineSavings/>Saved by Gas Tank</label>\n              $ { formatFloatTokenAmount(bundle.feeInUSDPerGas * savedGas, true, 6) }\n              <span style={{color: '#ebaf40'}}>+ cashback is pending</span>\n            </li>\n          )}\n      {\n        bundle.replacesTxId ?\n          <li>\n            <label><MdShuffle/>Replaces transaction</label>\n            <p>{bundle.replacesTxId}</p>\n          </li>\n          :\n          null\n      }\n      {\n        bundle.txId ?\n          <li>\n            <label><BsGlobe2/>Block Explorer</label>\n            <p><a className='explorer-url' href={network.explorerUrl+'/tx/'+bundle.txId} target='_blank' rel='noreferrer'>{network.explorerUrl.split('/')[2]}</a></p>\n          </li>\n          :\n          null\n      }\n    </ul>\n  </div>)\n})\n\nexport default Transactions\n","var isProduction = process.env.NODE_ENV === 'production';\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;\n","const { BN } = require('bn.js')\n\nfunction Uint256(x) {\n\tconst bn = new BN(x, 10)\n\tif (bn.isNeg()) throw new Error('uint256 expected, negative number given')\n\treturn bn\n}\n\nfunction Address(x) {\n\tif (!(typeof x === 'string' && x.length === 42 && x.startsWith('0x')))\n\t\tthrow new Error('invalid address: must start with a 0x and be 42 characters long')\n\treturn x\n}\n\nfunction Bytes32(b) {\n\tif (typeof b === 'string' && b.startsWith('0x') && b.length === 66) {\n\t\treturn Buffer.from(b.slice(2), 'hex')\n\t}\n\tif (!(b.length === 32 && Buffer.isBuffer(b))) throw new Error('32 byte Buffer expected')\n\treturn b\n}\n\nfunction Bytes(b) {\n\tif (typeof b === 'string' && b.startsWith('0x')) {\n\t\treturn Buffer.from(b.slice(2), 'hex')\n\t}\n\tif (!Buffer.isBuffer(b)) throw new Error('Buffer expected')\n\treturn b\n}\n\nfunction Bytes32Array(bytes32Array, size) {\n\t// no size specified\n\tif (size === -1 || size === undefined) {\n\t\treturn bytes32Array.map(x => Bytes32(x))\n\t}\n\treturn bytes32Array.length === size && bytes32Array.map(x => Bytes32(x))\n}\n\nfunction Channel(channel) {\n\tAddress(channel.leader)\n\tAddress(channel.follower)\n\tAddress(channel.guardian)\n\tAddress(channel.tokenAddr)\n\tBytes32(channel.nonce)\n\treturn channel\n}\n\nmodule.exports = { Uint256, Bytes32, Address, Bytes, Bytes32Array, Channel }\n","'use strict';\n\nvar isHexPrefixed = require('is-hex-prefixed');\nvar stripHexPrefix = require('strip-hex-prefix');\n\n/**\n * Pads a `String` to have an even length\n * @param {String} value\n * @return {String} output\n */\nfunction padToEven(value) {\n  var a = value; // eslint-disable-line\n\n  if (typeof a !== 'string') {\n    throw new Error('[ethjs-util] while padding to even, value must be string, is currently ' + typeof a + ', while padToEven.');\n  }\n\n  if (a.length % 2) {\n    a = '0' + a;\n  }\n\n  return a;\n}\n\n/**\n * Converts a `Number` into a hex `String`\n * @param {Number} i\n * @return {String}\n */\nfunction intToHex(i) {\n  var hex = i.toString(16); // eslint-disable-line\n\n  return '0x' + hex;\n}\n\n/**\n * Converts an `Number` to a `Buffer`\n * @param {Number} i\n * @return {Buffer}\n */\nfunction intToBuffer(i) {\n  var hex = intToHex(i);\n\n  return new Buffer(padToEven(hex.slice(2)), 'hex');\n}\n\n/**\n * Get the binary size of a string\n * @param {String} str\n * @return {Number}\n */\nfunction getBinarySize(str) {\n  if (typeof str !== 'string') {\n    throw new Error('[ethjs-util] while getting binary size, method getBinarySize requires input \\'str\\' to be type String, got \\'' + typeof str + '\\'.');\n  }\n\n  return Buffer.byteLength(str, 'utf8');\n}\n\n/**\n * Returns TRUE if the first specified array contains all elements\n * from the second one. FALSE otherwise.\n *\n * @param {array} superset\n * @param {array} subset\n *\n * @returns {boolean}\n */\nfunction arrayContainsArray(superset, subset, some) {\n  if (Array.isArray(superset) !== true) {\n    throw new Error('[ethjs-util] method arrayContainsArray requires input \\'superset\\' to be an array got type \\'' + typeof superset + '\\'');\n  }\n  if (Array.isArray(subset) !== true) {\n    throw new Error('[ethjs-util] method arrayContainsArray requires input \\'subset\\' to be an array got type \\'' + typeof subset + '\\'');\n  }\n\n  return subset[Boolean(some) && 'some' || 'every'](function (value) {\n    return superset.indexOf(value) >= 0;\n  });\n}\n\n/**\n * Should be called to get utf8 from it's hex representation\n *\n * @method toUtf8\n * @param {String} string in hex\n * @returns {String} ascii string representation of hex value\n */\nfunction toUtf8(hex) {\n  var bufferValue = new Buffer(padToEven(stripHexPrefix(hex).replace(/^0+|0+$/g, '')), 'hex');\n\n  return bufferValue.toString('utf8');\n}\n\n/**\n * Should be called to get ascii from it's hex representation\n *\n * @method toAscii\n * @param {String} string in hex\n * @returns {String} ascii string representation of hex value\n */\nfunction toAscii(hex) {\n  var str = ''; // eslint-disable-line\n  var i = 0,\n      l = hex.length; // eslint-disable-line\n\n  if (hex.substring(0, 2) === '0x') {\n    i = 2;\n  }\n\n  for (; i < l; i += 2) {\n    var code = parseInt(hex.substr(i, 2), 16);\n    str += String.fromCharCode(code);\n  }\n\n  return str;\n}\n\n/**\n * Should be called to get hex representation (prefixed by 0x) of utf8 string\n *\n * @method fromUtf8\n * @param {String} string\n * @param {Number} optional padding\n * @returns {String} hex representation of input string\n */\nfunction fromUtf8(stringValue) {\n  var str = new Buffer(stringValue, 'utf8');\n\n  return '0x' + padToEven(str.toString('hex')).replace(/^0+|0+$/g, '');\n}\n\n/**\n * Should be called to get hex representation (prefixed by 0x) of ascii string\n *\n * @method fromAscii\n * @param {String} string\n * @param {Number} optional padding\n * @returns {String} hex representation of input string\n */\nfunction fromAscii(stringValue) {\n  var hex = ''; // eslint-disable-line\n  for (var i = 0; i < stringValue.length; i++) {\n    // eslint-disable-line\n    var code = stringValue.charCodeAt(i);\n    var n = code.toString(16);\n    hex += n.length < 2 ? '0' + n : n;\n  }\n\n  return '0x' + hex;\n}\n\n/**\n * getKeys([{a: 1, b: 2}, {a: 3, b: 4}], 'a') => [1, 3]\n *\n * @method getKeys get specific key from inner object array of objects\n * @param {String} params\n * @param {String} key\n * @param {Boolean} allowEmpty\n * @returns {Array} output just a simple array of output keys\n */\nfunction getKeys(params, key, allowEmpty) {\n  if (!Array.isArray(params)) {\n    throw new Error('[ethjs-util] method getKeys expecting type Array as \\'params\\' input, got \\'' + typeof params + '\\'');\n  }\n  if (typeof key !== 'string') {\n    throw new Error('[ethjs-util] method getKeys expecting type String for input \\'key\\' got \\'' + typeof key + '\\'.');\n  }\n\n  var result = []; // eslint-disable-line\n\n  for (var i = 0; i < params.length; i++) {\n    // eslint-disable-line\n    var value = params[i][key]; // eslint-disable-line\n    if (allowEmpty && !value) {\n      value = '';\n    } else if (typeof value !== 'string') {\n      throw new Error('invalid abi');\n    }\n    result.push(value);\n  }\n\n  return result;\n}\n\n/**\n * Is the string a hex string.\n *\n * @method check if string is hex string of specific length\n * @param {String} value\n * @param {Number} length\n * @returns {Boolean} output the string is a hex string\n */\nfunction isHexString(value, length) {\n  if (typeof value !== 'string' || !value.match(/^0x[0-9A-Fa-f]*$/)) {\n    return false;\n  }\n\n  if (length && value.length !== 2 + 2 * length) {\n    return false;\n  }\n\n  return true;\n}\n\nmodule.exports = {\n  arrayContainsArray: arrayContainsArray,\n  intToBuffer: intToBuffer,\n  getBinarySize: getBinarySize,\n  isHexPrefixed: isHexPrefixed,\n  stripHexPrefix: stripHexPrefix,\n  padToEven: padToEven,\n  intToHex: intToHex,\n  fromAscii: fromAscii,\n  fromUtf8: fromUtf8,\n  toAscii: toAscii,\n  toUtf8: toUtf8,\n  getKeys: getKeys,\n  isHexString: isHexString\n};","const customIcons = {\n    '0xb468a1e5596cfbcdf561f21a10490d99b4bb7b68': 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Jeff_Sessions_with_Elmo_and_Rosita_%28cropped%29.jpg/220px-Jeff_Sessions_with_Elmo_and_Rosita_%28cropped%29.jpg', // TEST Polygon ELMO token,\n    '0x88800092ff476844f74dc2fc427974bbee2794ae': 'https://raw.githubusercontent.com/AmbireTech/ambire-brand/main/logos/ambire_logo_white_bg_250x250.png', // Ambire Wallet Token\n    '0x47cd7e91c3cbaaf266369fe8518345fc4fc12935': 'https://raw.githubusercontent.com/AmbireTech/ambire-brand/main/logos/xwallet_250x250.png', //xWallet\n    '0xb6456b57f03352be48bf101b46c1752a0813491a': 'https://raw.githubusercontent.com/AmbireTech/adex-brand/master/logos/vaporwave-adex-2.png', // ADX-STAKING\n    '0xd9a4cb9dc9296e111c66dfacab8be034ee2e1c2c': 'https://raw.githubusercontent.com/AmbireTech/adex-brand/master/logos/ADX-loyalty%40256x256.png', // ADX-LOYALTY\n    '0xec3b10ce9cabab5dbf49f946a623e294963fbb4e': 'https://raw.githubusercontent.com/AmbireTech/ambire-brand/main/logos/xwallet_250x250.png', // Polygons test xWallet\n    '0xe9415e904143e42007865e6864f7f632bd054a08': 'https://raw.githubusercontent.com/AmbireTech/ambire-brand/main/logos/Ambire_logo_250x250.png', // Polygons test Wallet\n    '0xade00c28244d5ce17d72e40330b1c318cd12b7c3': 'https://raw.githubusercontent.com/AmbireTech/ambire-brand/main/official-logos/Ambire-AdEx/Ambire_AdEx_Symbol_color_white_bg.png' //ADX-TOKEN\n}\n\nconst zapperStorageTokenIcons = 'https://storage.googleapis.com/zapper-fi-assets/tokens'\n\nexport function getTokenIcon(networkId = '', address = '') {\n    const addr = address.toLowerCase()\n    const net = networkId.toLowerCase()\n    return customIcons[addr] || `${zapperStorageTokenIcons}/${net}/${addr}.png`\n}\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export function formatFloatTokenAmount(amount, useGrouping = true, maximumFractionDigits = 18) {\n    if (isNaN(amount) || isNaN(parseFloat(amount)) || !(typeof amount === 'number' || typeof amount === 'string')) return amount\n\n    try {\n        const minimumFractionDigits = Math.min(2, maximumFractionDigits || 0)\n        return ((typeof amount === 'number') ? amount : parseFloat(amount))\n            .toLocaleString(undefined,\n                {\n                    useGrouping,\n                    maximumFractionDigits: Math.max(minimumFractionDigits, maximumFractionDigits),\n                    minimumFractionDigits\n                })\n    } catch (err) {\n        console.error(err)\n        return amount\n    }\n}\n\n// Round a floating point number to a specific decimal places, i.e. 1.156 => 1.16\nexport function roundFloatingNumber(number, places = 2) {\n  const decimals = Math.pow(10, places)\n\n  return Math.round((number + Number.EPSILON) * decimals) / decimals\n}\n","var defineProperty = require(\"./defineProperty\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread2;","const { AbiCoder, hexlify, arrayify, keccak256, Interface } = require('ethers').utils\nconst { Contract, BigNumber } = require('ethers')\n\nconst ensure = require('./ensureTypes')\n\nconst IdentityABI = require('../abi/Identity5.2')\nconst QuickAccManagerABI = require('../abi/QuickAccManager')\n\nconst IdentityInterface = new Interface(IdentityABI)\n\nfunction Bundle(args) {\n\tthis.identity = ensure.Address(args.identity)\n\tthis.network = args.network\n\t// @TODO validate this\n\tthis.signer = args.signer\n\tthis.txns = args.txns\n\tthis.gasLimit = args.gasLimit\n\tthis.nonce = args.nonce\n\tthis.signature = args.signature\n\tthis.minFeeInUSDPerGas = args.minFeeInUSDPerGas\n\tthis.recoveryMode = args.recoveryMode\n\tthis.meta = args.meta\n\tthis.gasTankFee = args.gasTankFee\n\treturn this\n}\n\nBundle.prototype.getNonce = async function(provider) {\n\tthis.nonce = await getNonce(provider, this)\n\treturn this.nonce\n}\n\nBundle.prototype.estimate = async function({ fetch, relayerURL, replacing, getNextNonce, gasTank }) {\n\tconst queryParams = Object.fromEntries(Object.entries({getNextNonce, gasTank}).filter(([_, v]) => v))\n\tconst res = await fetchPost(\n\t\tfetch,\n\t\t`${relayerURL}/identity/${this.identity}/${this.network}/estimate?${\n\t\t\t(new URLSearchParams(queryParams)).toString()\n\t\t}`,\n\t\t{ txns: this.txns, signer: this.signer, replacing, minFeeInUSDPerGas: this.minFeeInUSDPerGas }\n\t)\n\tthis.gasLimit = res.gasLimit\n\treturn res\n}\n\nBundle.prototype.sign = async function(wallet, isSingleSigMode) {\n\tif (isNaN(this.nonce)) throw new Error('nonce is not set')\n\tif (isNaN(this.gasLimit)) throw new Error('gasLimit is not set')\n\tconst encoded = getSignable(this, isSingleSigMode)\n\tconst hash = arrayify(keccak256(encoded))\n\tconst signature = await signMsg(wallet, hash)\n\tthis.signature = signature\n\treturn signature\n}\n\nBundle.prototype.submit = async function({ fetch, relayerURL }) {\n\tconst res = await fetchPost(\n\t\tfetch,\n\t\t`${relayerURL}/identity/${this.identity}/${this.network}/submit`,\n\t\t{\n\t\t\tnonce: this.nonce,\n\t\t\tsigner: this.signer,\n\t\t\ttxns: this.txns,\n\t\t\tgasLimit: this.gasLimit,\n\t\t\tsignature: this.signature,\n\t\t\tsignatureTwo: this.signatureTwo,\n\t\t\tmeta: this.meta,\n\t\t\tgasTankFee: this.gasTankFee\n\t\t}\n\t)\n\treturn res\n}\n\nBundle.prototype.cancel = async function({ fetch, relayerURL }) {\n\tconst res = await fetchPost(\n\t\tfetch,\n\t\t`${relayerURL}/identity/${this.identity}/${this.network}/cancel`,\n\t\t{ nonce: this.nonce, signer: this.signer }\n\t)\n\treturn res\n}\n\nconst UNPREDICTABLE_GAS_REGEX = /gas required exceeds allowance|always failing transaction|execution reverted/\nBundle.prototype.estimateNoRelayer = async function({ provider, replacing }) {\n\tconst txParams = {\n\t\tfrom: this.signer.quickAccManager || this.signer.address,\n\t\tto: this.identity,\n\t\tdata: IdentityInterface.encodeFunctionData('executeBySender', [this.txns])\n\t}\n\tconst blockTag = replacing ? 'latest' : 'pending'\n\tconst { error, gasLimit } = await estimateGasWithCatch(provider, blockTag, txParams)\n\tif (error && error.message.startsWith('execution reverted: ')) {\n\t\tconst message = error.message.slice(20)\n\t\treturn { success: false, message }\n\t}\n\tif (error) {\n\t\t// Match both the code and the regex to handle both errs from ethers and raw ones from nodes in case we use .send\n\t\tif (!(error.code === 'UNPREDICTABLE_GAS_LIMIT' || error.message.match(UNPREDICTABLE_GAS_REGEX)))\n\t\t\tthrow error\n\t\treturn { success: false, message: await getErrMsg(provider, txParams, blockTag) }\n\t}\n\tthis.gasLimit = gasLimit.toNumber()\n\t// @TODO EIP1559-optimized estimations (good first issue for external contributors)\n\tconst feeData = await provider.getFeeData()\n\tconst gasPrice = feeData.gasPrice.toNumber()\n\tconst baseFee = (gasPrice * gasLimit) / 1e18\n\treturn {\n\t\tsuccess: true,\n\t\tgasLimit: this.gasLimit,\n\t\tgasPrice,\n\t\tfeeInNative: {\n\t\t\tslow: baseFee * 0.9,\n\t\t\tmedium: baseFee * 1.0,\n\t\t\tfast: baseFee * 1.15,\n\t\t\tape: baseFee * 1.4\n\t\t}\n\t}\n}\n\nasync function signMessage(wallet, identity, signer, message, signatureTwo) {\n\tif (signer.address) return signMsg(wallet, message, true)\n\tif (signer.quickAccManager) {\n\t\tconst signatureOne = await signMsg(wallet, message, true)\n\t\t// the inner sig is the one that the QuickAccManager interprets by doing an abi.decode and sending each individual signature to isValidSignature\n\t\tconst abiCoder = new AbiCoder()\n\t\tconst sigInner = abiCoder.encode(\n\t\t\t['uint', 'bytes', 'bytes'],\n\t\t\t[signer.timelock, signatureOne, signatureTwo]\n\t\t)\n\t\t// 02 is the SmartWallet type sig; we're essentially formatting this as a smart wallet type sig, verified by the quickAccManager\n\t\tconst sig = `${sigInner + abiCoder.encode(['address'], [signer.quickAccManager]).slice(2)}02`\n\t\treturn sig\n\t}\n\tthrow new Error(`invalid signer object`)\n}\n\n\nasync function signMessage712(wallet, identity, signer, domain, types, value, signatureTwo) {\n\tif (signer.address) return signMsg712(wallet, domain, types, value)\n\tif (signer.quickAccManager) {\n\t\tconst signatureOne = await signMsg712(wallet, domain, types, value)\n\t\t// the inner sig is the one that the QuickAccManager interprets by doing an abi.decode and sending each individual signature to isValidSignature\n\t\tconst abiCoder = new AbiCoder()\n\t\tconst sigInner = abiCoder.encode(\n\t\t\t['uint', 'bytes', 'bytes'],\n\t\t\t[signer.timelock, signatureOne, signatureTwo]\n\t\t)\n\t\t// 02 is the SmartWallet type sig; we're essentially formatting this as a smart wallet type sig, verified by the quickAccManager\n\t\tconst sig = `${sigInner + abiCoder.encode(['address'], [signer.quickAccManager]).slice(2)}02`\n\t\treturn sig\n\t}\n\tthrow new Error(`invalid signer object`)\n}\n\nfunction getSignable(userTxnBundle, isSingleSigMode) {\n\tconst abiCoder = new AbiCoder()\n\tconst signer = userTxnBundle.signer\n\tif (signer.address)\n\t\treturn abiCoder.encode(\n\t\t\t['address', 'uint', 'uint', 'tuple(address, uint, bytes)[]'],\n\t\t\t[\n\t\t\t\tuserTxnBundle.identity,\n\t\t\t\tgetChainID(userTxnBundle.network),\n\t\t\t\tuserTxnBundle.nonce,\n\t\t\t\tuserTxnBundle.txns\n\t\t\t]\n\t\t)\n\tif (signer.quickAccManager) {\n\t\tconst accHash = keccak256(\n\t\t\tabiCoder.encode(\n\t\t\t\t['tuple(uint, address, address)'],\n\t\t\t\t[[userTxnBundle.signer.timelock, userTxnBundle.signer.one, userTxnBundle.signer.two]]\n\t\t\t)\n\t\t)\n\t\t// @TODO typed data\n\t\t// if (signer.isTypedData)\n\t\treturn abiCoder.encode(\n\t\t\t['address', 'uint', 'address', 'bytes32', 'uint', 'tuple(address, uint, bytes)[]', 'bool'],\n\t\t\t[\n\t\t\t\tsigner.quickAccManager,\n\t\t\t\tgetChainID(userTxnBundle.network),\n\t\t\t\tuserTxnBundle.identity,\n\t\t\t\taccHash,\n\t\t\t\tuserTxnBundle.nonce,\n\t\t\t\tuserTxnBundle.txns,\n\t\t\t\t!isSingleSigMode\n\t\t\t]\n\t\t)\n\t}\n\tthrow new Error(`invalid signer object`)\n}\n\nfunction getChainID(network) {\n\tif (network === 'ethereum') return 1\n\tif (network === 'polygon') return 137\n\tif (network === 'binance-smart-chain') return 56\n\tif (network === 'bsc') return 56\n\tif (network === 'fantom') return 250\n\tif (network === 'avalanche') return 43114\n\tif (network === 'arbitrum') return 42161\n\tif (network === 'moonbeam') return 1284\n\tif (network === 'moonriver') return 1285\n\tif (network === 'gnosis') return 100\n\tif (network === 'kucoin') return 321\n\tif (network === 'andromeda') return 1088\n\tif (network === 'cronos') return 25\n\tif (network === 'aurora') return 1313161554\n\tif (network === 'rinkeby') return 4\n\tif (network === 'optimism') return 10\n\tthrow new Error(`unsupported network ${network}`)\n}\n\nfunction mapSignatureV(sigRaw) {\n\tconst sig = arrayify(sigRaw)\n\tif (sig[64] < 27) sig[64] += 27\n\treturn hexlify(sig)\n}\n\nasync function signMsg(wallet, message, useFinalDigestSigMode = false) {\n\t// assert.equal(hash.length, 32, 'hash must be 32byte array buffer')\n\t// was 01 originally but to avoid prefixing in solidity, we changed it to 00\n\treturn `${mapSignatureV(await wallet.signMessage(message))}${useFinalDigestSigMode ? '00' : '01'}`\n}\n\nasync function signMsg712(wallet, domain, types, value) {\n\t// 00 is the enum number of SignatureMode.EIP712\n\tconst typedDataSign = await wallet._signTypedData(domain, types, value)\n\treturn `${mapSignatureV(typedDataSign)}00`\n}\n\nasync function getNonce(provider, userTxnBundle) {\n\ttry {\n\t\treturn (userTxnBundle.signer.quickAccManager\n\t\t\t? await new Contract(\n\t\t\t\t\tuserTxnBundle.signer.quickAccManager,\n\t\t\t\t\tQuickAccManagerABI,\n\t\t\t\t\tprovider\n\t\t\t  ).nonces(userTxnBundle.identity)\n\t\t\t: await new Contract(userTxnBundle.identity, IdentityABI, provider).nonce()\n\t\t).toNumber()\n\t} catch (e) {\n\t\t// means the identity isn't deployed, which certainly implies nonce 0\n\t\tif (e.code === 'CALL_EXCEPTION' && (await provider.getCode(userTxnBundle.identity)) === '0x')\n\t\t\treturn 0\n\t\tthrow e\n\t}\n}\n\nasync function fetchPost(fetch, url, body) {\n\tconst r = await fetch(url, {\n\t\theaders: { 'content-type': 'application/json' },\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(body)\n\t})\n\treturn r.json()\n}\n\n// helpers for estimateNoRelayer\n\n// Signature of Error(string)\nconst ERROR_SIG = '0x08c379a0'\n\nasync function getErrMsg(provider, txParams, blockTag) {\n\t// .call always returns a hex string with ethers\n\ttry {\n\t\tconst returnData = await provider.call(txParams, blockTag)\n\t\treturn returnData.startsWith(ERROR_SIG)\n\t\t\t? new AbiCoder().decode(['string'], `0x${returnData.slice(10)}`)[0]\n\t\t\t: returnData\n\t} catch (e) {\n\t\t// weird infura case\n\t\tif (e.code === 'UNPREDICTABLE_GAS_LIMIT' && e.error) return e.error.message.slice(20)\n\t\tif (e.code === 'CALL_EXCEPTION') return 'no error string, possibly insufficient amount'\n\t\tif (e.code === 'INVALID_ARGUMENT') return `unable to deserialize: ${hexlify(e.value)}`\n\t\tthrow e\n\t}\n}\n\nasync function estimateGasWithCatch(provider, blockTag, tx) {\n\treturn (\n\t\tprovider\n\t\t\t.send('eth_estimateGas', [tx, blockTag])\n\t\t\t.then(gasLimit => ({ gasLimit: BigNumber.from(gasLimit) }))\n\t\t\t// with .send, the error is wrapped in another error\n\t\t\t.catch(e => (e.code === 'SERVER_ERROR' ? { error: e.error } : { error: e }))\n\t)\n}\n\n// getNonce(require('ethers').getDefaultProvider('homestead'), { identity: '0x23c2c34f38ce66ccc10e71e9bb2a06532d52c5e8', signer: {address: '0x942f9CE5D9a33a82F88D233AEb3292E680230348'}, txns: [] }).then(console.log)\n\nmodule.exports = { Bundle, signMessage, signMessage712, getSignable, signMsg, signMsg712 }\n","// Needed for OUTPACE\nconst channelLib = require('./Channel')\nconst withdrawalLib = require('./Withdraw')\nconst MerkleTree = require('./MerkleTree')\nconst splitSig = require('./splitSig')\n\n// Other utilities\nconst unbondCommitmentlLib = require('./UnbondCommitment')\nconst Permit = require('./Permit')\n\n// Identity and QuickAccManager\nconst bundleLib = require('./Bundle')\n\nmodule.exports = {\n\t...channelLib,\n\t...withdrawalLib,\n\t...unbondCommitmentlLib,\n\t...Permit,\n\t...bundleLib,\n\tMerkleTree,\n\tsplitSig\n}\n","const abi = require('ethereumjs-abi')\nconst keccak256 = require('js-sha3').keccak256\nconst ensure = require('./ensureTypes')\n\nconst ChannelState = {\n\t// hex representation of solidity type(uint256).max\n\tChallenged: '115792089237316195423570985008687907853269984665640564039457584007913129639935',\n\tActive: '0'\n}\n\nfunction Channel(args) {\n\tthis.leader = ensure.Address(args.leader)\n\tthis.follower = ensure.Address(args.follower)\n\tthis.guardian = ensure.Address(args.guardian)\n\tthis.tokenAddr = ensure.Address(args.tokenAddr)\n\tthis.nonce = ensure.Bytes32(args.nonce)\n\n\tObject.freeze(this)\n\n\treturn this\n}\n\nChannel.prototype.hash = function() {\n\treturn Buffer.from(\n\t\tkeccak256.arrayBuffer(\n\t\t\tabi.rawEncode(\n\t\t\t\t['address', 'address', 'address', 'address', 'bytes32'],\n\t\t\t\t[this.leader, this.follower, this.guardian, this.tokenAddr, this.nonce]\n\t\t\t)\n\t\t)\n\t)\n}\n\nChannel.prototype.hashHex = function() {\n\treturn `0x${this.hash().toString('hex')}`\n}\n\nChannel.prototype.toSolidityTuple = function() {\n\treturn [this.leader, this.follower, this.guardian, this.tokenAddr, this.nonce]\n}\n\nChannel.prototype.hashToSign = function(contractAddr, balanceRoot) {\n\t// contains the channel hash (channelId), so that it's not replayable\n\treturn Channel.getSignableStateRoot(contractAddr, this.hashHex(), balanceRoot)\n}\n\nChannel.prototype.hashToSignHex = function(contractAddr, stateRoot) {\n\treturn `0x${this.hashToSign(contractAddr, stateRoot).toString('hex')}`\n}\n\nChannel.prototype.getResumeSignableMessage = function(challengeExpires) {\n\treturn Buffer.from(\n\t\tkeccak256.arrayBuffer(\n\t\t\tabi.solidityPack(\n\t\t\t\t['string', 'bytes32', 'uint256'],\n\t\t\t\t['resume', this.hashHex(), challengeExpires]\n\t\t\t)\n\t\t)\n\t)\n}\n\nChannel.prototype.getResumeSignableMessageHex = function(challengeExpires) {\n\treturn `0x${this.getResumeSignableMessage(challengeExpires).toString('hex')}`\n}\n\n// This returns the same as .hashToSign, .hashToSignHex, but it takes the channelId rather than (the whole channel + contract addr)\nChannel.getSignableStateRoot = function(contractAddr, channelId, balanceRoot) {\n\treturn Buffer.from(\n\t\tkeccak256.arrayBuffer(\n\t\t\tabi.rawEncode(['address', 'bytes32', 'bytes32'], [contractAddr, channelId, balanceRoot])\n\t\t)\n\t)\n}\n\nChannel.getBalanceLeaf = function(acc, amnt) {\n\treturn Buffer.from(keccak256.arrayBuffer(abi.rawEncode(['address', 'uint256'], [acc, amnt])))\n}\n\nChannel.getSpenderBalanceLeaf = function(acc, amnt) {\n\treturn Buffer.from(\n\t\tkeccak256.arrayBuffer(abi.rawEncode(['address', 'string', 'uint256'], [acc, 'spender', amnt]))\n\t)\n}\n\nmodule.exports = { Channel, ChannelState }\n","const ensure = require('./ensureTypes')\n\nfunction Withdraw(args) {\n\tthis.channel = args.channel\n\tthis.balanceTreeAmount = ensure.Uint256(args.balanceTreeAmount)\n\tthis.stateRoot = ensure.Bytes32(args.stateRoot)\n\tthis.sigLeader = ensure.Bytes32Array(args.sigLeader, 3)\n\tthis.sigFollower = ensure.Bytes32Array(args.sigFollower, 3)\n\tthis.proof = ensure.Bytes32Array(args.proof, -1)\n\n\tObject.freeze(this)\n\n\treturn this\n}\n\nWithdraw.prototype.toSolidityTuple = function() {\n\t// etherjs doesn't seem to want BN.js instances; hex is the lowest common denominator for web3/ethers\n\treturn [\n\t\tthis.channel.toSolidityTuple(),\n\t\t`0x${this.balanceTreeAmount.toString(16)}`,\n\t\tthis.stateRoot,\n\t\tthis.sigLeader,\n\t\tthis.sigFollower,\n\t\tthis.proof\n\t]\n}\n\nmodule.exports = { Withdraw }\n","// from https://github.com/ConnextProject/connext-client/blob/master/src/helpers/MerkleTree.js\nconst Buffer = require('buffer').Buffer\nconst keccak256 = require('js-sha3').keccak256\n\nfunction combinedHash(first, second) {\n\tif (!second) {\n\t\treturn first\n\t}\n\tif (!first) {\n\t\treturn second\n\t}\n\tconst sorted = Buffer.concat([first, second].sort(Buffer.compare))\n\n\treturn Buffer.from(keccak256.arrayBuffer(sorted))\n}\n\nfunction deduplicate(buffers) {\n\t// NOTE: performance?\n\treturn buffers.filter((buffer, i) => {\n\t\treturn buffers.findIndex(e => e.equals(buffer)) === i\n\t})\n}\n\nfunction getPair(index, layer) {\n\tconst pairIndex = index % 2 ? index - 1 : index + 1\n\tif (pairIndex < layer.length) {\n\t\treturn layer[pairIndex]\n\t}\n\treturn null\n}\n\nfunction getLayers(elements) {\n\tif (elements.length === 0) {\n\t\treturn [[Buffer.from('')]]\n\t}\n\tconst layers = []\n\tlayers.push(elements)\n\twhile (layers[layers.length - 1].length > 1) {\n\t\tlayers.push(getNextLayer(layers[layers.length - 1]))\n\t}\n\treturn layers\n}\n\nfunction getNextLayer(elements) {\n\treturn elements.reduce((layer, element, index, arr) => {\n\t\tif (index % 2 === 0) {\n\t\t\tlayer.push(combinedHash(element, arr[index + 1]))\n\t\t}\n\t\treturn layer\n\t}, [])\n}\n\nclass MerkleTree {\n\tconstructor(_elements) {\n\t\tif (!_elements.every(b => b.length === 32 && Buffer.isBuffer(b))) {\n\t\t\tthrow new Error('elements must be 32 byte buffers')\n\t\t}\n\t\tconst e = { elements: deduplicate(_elements) }\n\t\tObject.assign(this, e)\n\t\tthis.elements.sort(Buffer.compare)\n\n\t\tconst l = { layers: getLayers(this.elements) }\n\t\tObject.assign(this, l)\n\t}\n\n\tgetRoot() {\n\t\tif (!this.root) {\n\t\t\tconst r = { root: this.layers[this.layers.length - 1][0] }\n\t\t\tObject.assign(this, r)\n\t\t}\n\t\treturn this.root\n\t}\n\n\tverify(proof, element) {\n\t\treturn this.getRoot().equals(proof.reduce((hash, pair) => combinedHash(hash, pair), element))\n\t}\n\n\tproof(element) {\n\t\tlet index = this.elements.findIndex(e => e.equals(element))\n\n\t\tif (index === -1) {\n\t\t\tthrow new Error('element not found in merkle tree')\n\t\t}\n\n\t\treturn this.layers.reduce((proof, layer) => {\n\t\t\tconst pair = getPair(index, layer)\n\t\t\tif (pair) {\n\t\t\t\tproof.push(pair)\n\t\t\t}\n\t\t\tindex = Math.floor(index / 2)\n\t\t\treturn proof\n\t\t}, [])\n\t}\n}\nmodule.exports = MerkleTree\n","function splitSig(inputSig) {\n\tconst sig = inputSig.startsWith('0x') ? inputSig.slice(2) : inputSig\n\tconst r = `0x${sig.substring(0, 64)}`\n\tconst s = `0x${sig.substring(64, 128)}`\n\tlet v = parseInt(sig.substring(128, 130), 16)\n\tif (v < 27) v += 27\n\t// 02 mode is GETH\n\tconst pack = `${'0x02'}${v.toString(\n\t\t16\n\t)}000000000000000000000000000000000000000000000000000000000000`\n\treturn [pack, r, s]\n}\n\nmodule.exports = splitSig\n","const abi = require('ethereumjs-abi')\nconst keccak256 = require('js-sha3').keccak256\nconst ensure = require('./ensureTypes')\n\nfunction UnbondCommitment(args) {\n\tthis.owner = ensure.Address(args.owner)\n\tthis.shares = ensure.Uint256(args.shares)\n\tthis.unlocksAt = ensure.Uint256(args.unlocksAt)\n\n\tObject.freeze(this)\n\treturn this\n}\n\nUnbondCommitment.prototype.hash = function() {\n\tconst buf = abi.rawEncode(\n\t\t['address', 'uint256', 'uint256'],\n\t\t[this.owner, this.shares, this.unlocksAt]\n\t)\n\treturn Buffer.from(keccak256.arrayBuffer(buf))\n}\n\nUnbondCommitment.prototype.hashHex = function() {\n\treturn `0x${this.hash().toString('hex')}`\n}\n\nmodule.exports = { UnbondCommitment }\n","const { keccak256, defaultAbiCoder, toUtf8Bytes, solidityPack } = require('ethers').utils\n\nconst PERMIT_TYPEHASH = keccak256(\n\ttoUtf8Bytes('Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)')\n)\n\nfunction getDomainSeparator(name, tokenAddress, chainId) {\n\treturn keccak256(\n\t\tdefaultAbiCoder.encode(\n\t\t\t['bytes32', 'bytes32', 'bytes32', 'uint256', 'address'],\n\t\t\t[\n\t\t\t\tkeccak256(\n\t\t\t\t\ttoUtf8Bytes(\n\t\t\t\t\t\t'EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)'\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\tkeccak256(toUtf8Bytes(name)),\n\t\t\t\tkeccak256(toUtf8Bytes('1')),\n\t\t\t\tchainId,\n\t\t\t\ttokenAddress\n\t\t\t]\n\t\t)\n\t)\n}\n\nfunction getApprovalDigest(token, approve, nonce, deadline) {\n\tconst DOMAIN_SEPARATOR = getDomainSeparator(token.name, token.address, token.chainId)\n\n\treturn keccak256(\n\t\tsolidityPack(\n\t\t\t['bytes1', 'bytes1', 'bytes32', 'bytes32'],\n\t\t\t[\n\t\t\t\t'0x19',\n\t\t\t\t'0x01',\n\t\t\t\tDOMAIN_SEPARATOR,\n\t\t\t\tkeccak256(\n\t\t\t\t\tdefaultAbiCoder.encode(\n\t\t\t\t\t\t['bytes32', 'address', 'address', 'uint256', 'uint256', 'uint256'],\n\t\t\t\t\t\t[PERMIT_TYPEHASH, approve.owner, approve.spender, approve.value, nonce, deadline]\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t]\n\t\t)\n\t)\n}\n\nmodule.exports = { getDomainSeparator, getApprovalDigest }\n","/**\n * Returns a `Boolean` on whether or not the a `String` starts with '0x'\n * @param {String} str the string input value\n * @return {Boolean} a boolean if it is or is not hex prefixed\n * @throws if the str input is not a string\n */\nmodule.exports = function isHexPrefixed(str) {\n  if (typeof str !== 'string') {\n    throw new Error(\"[is-hex-prefixed] value must be type 'string', is currently type \" + (typeof str) + \", while checking isHexPrefixed.\");\n  }\n\n  return str.slice(0, 2) === '0x';\n}\n","// It costs around 19k to send a token, if that token was interacted with before in the same transaction,\n// because of SLOAD costs - they depend on whether a slot has been read\n// however, it costs 30k if the token has not been interacted with\n// we may decrease it a bit and lean on the relayer failsafe values (cfg.gasAddedOnEstimate) later on\nconst ADDED_GAS_TOKEN = 30000\nconst ADDED_GAS_NATIVE = 12000\n\nexport function isTokenEligible(token, speed, estimation, isGasTankEnabled, network) {\n  if (estimation?.relayerless && token?.address === '0x0000000000000000000000000000000000000000') return true\n  if (!token) return false\n  const { feeInFeeToken } = getFeesData(token, estimation, speed, isGasTankEnabled, network)\n  const balanceInFeeToken = (parseInt(token.balance) / Math.pow(10, token.decimals))\n  return balanceInFeeToken > feeInFeeToken\n}\n\nexport function getAddedGas(token) {\n  return !token?.address || token?.address === '0x0000000000000000000000000000000000000000'\n    ? ADDED_GAS_NATIVE\n    : ADDED_GAS_TOKEN\n}\n\n// can't think of a less funny name for that\nexport function getFeePaymentConsequences(token, estimation, isGasTankEnabled) {\n  // Relayerless mode\n  if (!estimation?.feeInUSD || !token) return { multiplier: 1, addedGas: 0 }\n  // Relayer mode\n  const addedGas = getAddedGas(token)\n  // If Gas Tank enabled\n  if (!!isGasTankEnabled) return { addedGas: 0, multiplier: 1 }\n\n  return {\n    // otherwise we get very long floating point numbers with trailing .999999\n    multiplier: parseFloat(((estimation.gasLimit + addedGas) / estimation.gasLimit).toFixed(4)),\n    addedGas\n  }\n}\n\nconst contractErrors = ['caller is a contract', 'caller is another contract', 'contract not allowed', 'contract not supported', 'No contractz allowed', 'o contracts', /*no */'contracts allowed', /* c or C*/'ontract is not allowed', 'aller must be user', 'aller must be a user', 'ontract call not allowed']\n\nexport function mapTxnErrMsg(msg) {\n  if (!msg) return\n  if (msg.includes('Router: EXPIRED')) return 'Swap expired'\n  if (msg.includes('Router: INSUFFICIENT_OUTPUT_AMOUNT')) return 'Swap will suffer slippage higher than your requirements'\n  if (msg.includes('INSUFFICIENT_PRIVILEGE')) return 'Your signer address is not authorized.'\n  if (contractErrors.find(contractMsg => msg.includes(contractMsg))) return 'This dApp does not support smart wallets.'\n  return msg\n}\n\nexport function getErrHint(msg) {\n  if (!msg) return\n  if (msg.includes('Router: EXPIRED')) return 'Try performing the swap again'\n  if (msg.includes('Router: INSUFFICIENT_OUTPUT_AMOUNT')) return 'Try performing the swap again or increase your slippage requirements'\n  if (msg.includes('INSUFFICIENT_PRIVILEGE')) return 'If you set a new signer for this account, try re-adding the account.'\n  if (contractErrors.find(contractMsg => msg.includes(contractMsg))) {\n    return 'WARNING! We detected that this dApp intentionally blocks smart contract calls. This is a highly disruptive practice, as it breaks support for all smart wallets (Ambire, Gnosis Safe and others). We recommend you report this to the dApp ASAP and ask them to fix it.'\n    // return 'This dApp does not support smart wallets or purposefully excludes them. Contact the dApp developers to tell them to implement smart wallets by not blocking contract interactions and/or implementing EIP1271.'\n  }\n  return 'Sending this transaction batch would have resulted in an error, so we prevented it.'\n}\n\nexport function checkIfDAppIncompatible(msg) {\n  return contractErrors.find(contractMsg => msg.includes(contractMsg))\n}\n\nexport function toHexAmount(amnt, decimals) {\n  return '0x' + Math.round(amnt * Math.pow(10, decimals)).toString(16)\n}\n\nexport function getDiscountApplied(amnt, discount = 0) {\n  if (!discount) return 0\n  if (!amnt) return 0\n  if (discount === 1) return amnt\n  return amnt / (1 - discount) * discount\n}\n\n// Returns feeToken data with all multipliers applied\nexport function getFeesData(feeToken, estimation, speed, isGasTankEnabled, network) {\n  const { addedGas, multiplier } = getFeePaymentConsequences(feeToken, estimation, isGasTankEnabled)\n  const savedGas = getAddedGas(feeToken)\n  const discountMultiplier = 1 - (feeToken?.discount || 0)\n  const totalMultiplier = multiplier * discountMultiplier\n  const nativeRate = feeToken?.nativeRate || 1\n  const isCrossChainNativeSelected = isGasTankEnabled && feeToken.address === '0x0000000000000000000000000000000000000000' && (network.id !== feeToken.network)\n  const feeInNative = estimation.customFee\n    ? ((estimation.customFee * discountMultiplier) / nativeRate)\n    : !isCrossChainNativeSelected ? \n        estimation.feeInNative[speed] * totalMultiplier : \n        (((estimation.feeInNative[speed] * totalMultiplier) / nativeRate) * estimation.nativeAssetPriceInUSD) / feeToken.price\n  const feeInUSD = !isNaN(estimation.nativeAssetPriceInUSD) ? \n    !isCrossChainNativeSelected ? \n      feeInNative * estimation.nativeAssetPriceInUSD : \n      feeInNative * feeToken.price : \n    undefined\n  const feeInFeeToken = feeInNative * nativeRate\n\n  return {\n    feeInNative,\n    feeInUSD,\n    feeInFeeToken,\n    addedGas, // use it bundle data\n    savedGas,\n  }\n}\n","var isHexPrefixed = require('is-hex-prefixed');\n\n/**\n * Removes '0x' from a given `String` is present\n * @param {String} str the string value\n * @return {String|Optional} a string by pass if necessary\n */\nmodule.exports = function stripHexPrefix(str) {\n  if (typeof str !== 'string') {\n    return str;\n  }\n\n  return isHexPrefixed(str) ? str.slice(2) : str;\n}\n","import './TxnPreview.scss'\n\nimport { useState, Fragment, useEffect  } from 'react'\n\nimport { getName, getTransactionSummary, isKnown } from 'lib/humanReadableTransactions'\nimport networks from 'consts/networks'\nimport { formatUnits } from 'ethers/lib/utils'\nimport { ToolTip } from 'components/common'\nimport { HiOutlineExternalLink } from 'react-icons/hi'\nimport { MdOutlineClose } from 'react-icons/md'\nimport { BsChevronDown, BsChevronUp } from 'react-icons/bs'\nimport { getTokenIcon } from 'lib/icons'\nimport { formatFloatTokenAmount } from 'lib/formatters'\nimport { setKnownAddressNames } from 'lib/humanReadableTransactions'\nimport useConstants from 'hooks/useConstants'\n\nfunction getNetworkSymbol(networkId) {\n  const network = networks.find(x => x.id === networkId)\n  return network ? network.nativeAssetSymbol : 'UNKNW'\n}\n\nfunction parseExtendedSummaryItem(item, i, networkDetails, feeAssets) {\n  if (item.length === 1) return item\n\n  if (i === 0) return (<div className={`action ${item.toLowerCase()}`} key={`item-${i}`}>{ item }</div>)\n\n  if (!item.type) return (<div className='word' key={`item-${i}`}>{ item }</div>)\n  if (item.type === 'token') {\n    const foundToken = feeAssets && feeAssets.find(i => (i.address === item.address) && (i.symbol.toLowerCase() === item.symbol.toLowerCase()))\n    return (\n    <div className='token' key={`item-${i}`}>\n      { item.amount > 0 && <span>{ formatFloatTokenAmount(item.amount, true, item.decimals) }</span> }\n      { item.decimals !== null && item.symbol ? \n        <Fragment>\n          {item.address &&\n            <div className='icon' \n              style={{ backgroundImage: `url(${foundToken ? foundToken.icon : getTokenIcon(networkDetails.id, item.address)})` }}>\n            </div>}\n          {item.symbol}\n        </Fragment>\n        : (item.amount > 0) ? 'units of unknown token' : null \n      }\n    </div>\n  )}\n\n  if (item.type === 'address') return (\n    <a\n      className='address'\n      key={`item-${i}`}\n      href={item.address ? `${networkDetails.explorerUrl}/address/${item.address}` : null}\n      target=\"_blank\"\n      rel=\"noreferrer\"\n      onClick={e => e.stopPropagation()}\n    >\n      <ToolTip disabled={!item.address} label={item.address}>\n        { item.name ? item.name : item.address }\n        { item.address ? <HiOutlineExternalLink/> : null }\n      </ToolTip>\n    </a>\n  )\n\n  if (item.type === 'network') return (\n    <div className='network' key={`item-${i}`}>\n      { item.icon ? <div className='icon' style={{ backgroundImage: `url(${item.icon})` }}></div> : null }\n      { item.name }\n    </div>\n  )\n\n  if (item.type === 'erc721') {\n    const canShowLink = item.network && item.address && item.id\n    return (\n      <a\n        className='erc721'\n        key={`item-${i}`}\n        href={canShowLink ? `#/wallet/nft/${item.network}/${item.address}/${item.id}` : null}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        onClick={e => e.stopPropagation()}\n      >\n        { item.name }\n        { canShowLink ? <HiOutlineExternalLink/> : null }\n      </a>\n    )\n  }\n\n  return <></>\n}\n\nexport default function TxnPreview ({ txn, onDismiss, network, account, isFirstFailing, mined, disableExpand, disableDismiss, disableDismissLabel, addressLabel = null, feeAssets }) {\n  const { constants: { tokenList, humanizerInfo } } = useConstants()\n  const [isExpanded, setExpanded] = useState(false)\n  const contractName = getName(humanizerInfo, txn[0])\n\n  const networkDetails = networks.find(({ id }) => id === network)\n  const extendedSummary = getTransactionSummary(humanizerInfo, tokenList, txn, network, account, { mined, extended: true })\n\n  const summary = (extendedSummary.map(entry => Array.isArray(entry) ? entry.map((item, i) => parseExtendedSummaryItem(item, i, networkDetails, feeAssets)) : (entry))) // If entry is extended summary parse it\n  useEffect(() => !!addressLabel && setKnownAddressNames(addressLabel), [addressLabel])\n  \n  return (\n    <div className={isFirstFailing ? 'txnPreview firstFailing' : 'txnPreview'}>\n        <div className=\"heading\">\n          <div className=\"info\" onClick={() => !disableExpand && setExpanded(e => !e)}>\n            <div className=\"summary-container\">\n              {!disableExpand && (<div className='expandTxn'>\n                {isExpanded ? (<BsChevronUp/>) : (<BsChevronDown/>)}\n              </div>)}\n              <div className=\"summary\">{ summary }</div>\n            </div>\n            {isFirstFailing && (<div className='firstFailingLabel'>This is the first failing transaction.</div>)}\n              {!isFirstFailing && !mined && !isKnown(humanizerInfo, txn, account) && (<div className='unknownWarning'>Warning: interacting with an unknown contract or address.</div>)}\n          </div>\n          <div className='actionIcons'>\n            {onDismiss ? (\n              <ToolTip disabled={!disableDismiss || !disableDismissLabel} label={disableDismissLabel}>\n                <div className={`dismissTxn ${disableDismiss ? 'disabled' : ''}`} onClick={e => { e.stopPropagation(); !disableDismiss && onDismiss.apply(this, e) }}><MdOutlineClose/></div>\n              </ToolTip>\n            ) : (<></>)}\n          </div>\n        </div>\n        {\n          isExpanded ? (<div className='advanced'>\n            <div><b>Interacting with (<i>to</i>):</b> {txn[0]}{contractName ? ` (${contractName})` : ''}</div>\n            <div><b>Value to be sent (<i>value</i>):</b> {formatUnits(txn[1] || '0x0', 18)} {getNetworkSymbol(network)}</div>\n            <div><b>Data:</b> {txn[2]}</div>\n          </div>) : (<></>)\n        }\n    </div>\n  )\n}\n","import React from \"react\";\nimport { Router } from \"react-router\";\nimport { createBrowserHistory as createHistory } from \"history\";\nimport PropTypes from \"prop-types\";\nimport warning from \"tiny-warning\";\n\n/**\n * The public API for a <Router> that uses HTML5 history.\n */\nclass BrowserRouter extends React.Component {\n  history = createHistory(this.props);\n\n  render() {\n    return <Router history={this.history} children={this.props.children} />;\n  }\n}\n\nif (__DEV__) {\n  BrowserRouter.propTypes = {\n    basename: PropTypes.string,\n    children: PropTypes.node,\n    forceRefresh: PropTypes.bool,\n    getUserConfirmation: PropTypes.func,\n    keyLength: PropTypes.number\n  };\n\n  BrowserRouter.prototype.componentDidMount = function() {\n    warning(\n      !this.props.history,\n      \"<BrowserRouter> ignores the history prop. To use a custom history, \" +\n        \"use `import { Router }` instead of `import { BrowserRouter as Router }`.\"\n    );\n  };\n}\n\nexport default BrowserRouter;\n","import React from \"react\";\nimport { Router } from \"react-router\";\nimport { createHashHistory as createHistory } from \"history\";\nimport PropTypes from \"prop-types\";\nimport warning from \"tiny-warning\";\n\n/**\n * The public API for a <Router> that uses window.location.hash.\n */\nclass HashRouter extends React.Component {\n  history = createHistory(this.props);\n\n  render() {\n    return <Router history={this.history} children={this.props.children} />;\n  }\n}\n\nif (__DEV__) {\n  HashRouter.propTypes = {\n    basename: PropTypes.string,\n    children: PropTypes.node,\n    getUserConfirmation: PropTypes.func,\n    hashType: PropTypes.oneOf([\"hashbang\", \"noslash\", \"slash\"])\n  };\n\n  HashRouter.prototype.componentDidMount = function() {\n    warning(\n      !this.props.history,\n      \"<HashRouter> ignores the history prop. To use a custom history, \" +\n        \"use `import { Router }` instead of `import { HashRouter as Router }`.\"\n    );\n  };\n}\n\nexport default HashRouter;\n","import { createLocation } from \"history\";\n\nexport const resolveToLocation = (to, currentLocation) =>\n  typeof to === \"function\" ? to(currentLocation) : to;\n\nexport const normalizeToLocation = (to, currentLocation) => {\n  return typeof to === \"string\"\n    ? createLocation(to, null, null, currentLocation)\n    : to;\n};\n","import React from \"react\";\nimport { __RouterContext as RouterContext } from \"react-router\";\nimport { createPath } from 'history';\nimport PropTypes from \"prop-types\";\nimport invariant from \"tiny-invariant\";\nimport {\n  resolveToLocation,\n  normalizeToLocation\n} from \"./utils/locationUtils.js\";\n\n// React 15 compat\nconst forwardRefShim = C => C;\nlet { forwardRef } = React;\nif (typeof forwardRef === \"undefined\") {\n  forwardRef = forwardRefShim;\n}\n\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\n\nconst LinkAnchor = forwardRef(\n  (\n    {\n      innerRef, // TODO: deprecate\n      navigate,\n      onClick,\n      ...rest\n    },\n    forwardedRef\n  ) => {\n    const { target } = rest;\n\n    let props = {\n      ...rest,\n      onClick: event => {\n        try {\n          if (onClick) onClick(event);\n        } catch (ex) {\n          event.preventDefault();\n          throw ex;\n        }\n\n        if (\n          !event.defaultPrevented && // onClick prevented default\n          event.button === 0 && // ignore everything but left clicks\n          (!target || target === \"_self\") && // let browser handle \"target=_blank\" etc.\n          !isModifiedEvent(event) // ignore clicks with modifier keys\n        ) {\n          event.preventDefault();\n          navigate();\n        }\n      }\n    };\n\n    // React 15 compat\n    if (forwardRefShim !== forwardRef) {\n      props.ref = forwardedRef || innerRef;\n    } else {\n      props.ref = innerRef;\n    }\n\n    /* eslint-disable-next-line jsx-a11y/anchor-has-content */\n    return <a {...props} />;\n  }\n);\n\nif (__DEV__) {\n  LinkAnchor.displayName = \"LinkAnchor\";\n}\n\n/**\n * The public API for rendering a history-aware <a>.\n */\nconst Link = forwardRef(\n  (\n    {\n      component = LinkAnchor,\n      replace,\n      to,\n      innerRef, // TODO: deprecate\n      ...rest\n    },\n    forwardedRef\n  ) => {\n    return (\n      <RouterContext.Consumer>\n        {context => {\n          invariant(context, \"You should not use <Link> outside a <Router>\");\n\n          const { history } = context;\n\n          const location = normalizeToLocation(\n            resolveToLocation(to, context.location),\n            context.location\n          );\n\n          const href = location ? history.createHref(location) : \"\";\n          const props = {\n            ...rest,\n            href,\n            navigate() {\n              const location = resolveToLocation(to, context.location);\n              const isDuplicateNavigation = createPath(context.location) === createPath(normalizeToLocation(location));\n              const method = (replace || isDuplicateNavigation) ? history.replace : history.push;\n\n              method(location);\n            }\n          };\n\n          // React 15 compat\n          if (forwardRefShim !== forwardRef) {\n            props.ref = forwardedRef || innerRef;\n          } else {\n            props.innerRef = innerRef;\n          }\n\n          return React.createElement(component, props);\n        }}\n      </RouterContext.Consumer>\n    );\n  }\n);\n\nif (__DEV__) {\n  const toType = PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.object,\n    PropTypes.func\n  ]);\n  const refType = PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.any })\n  ]);\n\n  Link.displayName = \"Link\";\n\n  Link.propTypes = {\n    innerRef: refType,\n    onClick: PropTypes.func,\n    replace: PropTypes.bool,\n    target: PropTypes.string,\n    to: toType.isRequired\n  };\n}\n\nexport default Link;\n","import React from \"react\";\nimport { __RouterContext as RouterContext, matchPath } from \"react-router\";\nimport PropTypes from \"prop-types\";\nimport invariant from \"tiny-invariant\";\nimport Link from \"./Link.js\";\nimport {\n  resolveToLocation,\n  normalizeToLocation\n} from \"./utils/locationUtils.js\";\n\n// React 15 compat\nconst forwardRefShim = C => C;\nlet { forwardRef } = React;\nif (typeof forwardRef === \"undefined\") {\n  forwardRef = forwardRefShim;\n}\n\nfunction joinClassnames(...classnames) {\n  return classnames.filter(i => i).join(\" \");\n}\n\n/**\n * A <Link> wrapper that knows if it's \"active\" or not.\n */\nconst NavLink = forwardRef(\n  (\n    {\n      \"aria-current\": ariaCurrent = \"page\",\n      activeClassName = \"active\", // TODO: deprecate\n      activeStyle, // TODO: deprecate\n      className: classNameProp,\n      exact,\n      isActive: isActiveProp,\n      location: locationProp,\n      sensitive,\n      strict,\n      style: styleProp,\n      to,\n      innerRef, // TODO: deprecate\n      ...rest\n    },\n    forwardedRef\n  ) => {\n    return (\n      <RouterContext.Consumer>\n        {context => {\n          invariant(context, \"You should not use <NavLink> outside a <Router>\");\n\n          const currentLocation = locationProp || context.location;\n          const toLocation = normalizeToLocation(\n            resolveToLocation(to, currentLocation),\n            currentLocation\n          );\n          const { pathname: path } = toLocation;\n          // Regex taken from: https://github.com/pillarjs/path-to-regexp/blob/master/index.js#L202\n          const escapedPath =\n            path && path.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n\n          const match = escapedPath\n            ? matchPath(currentLocation.pathname, {\n                path: escapedPath,\n                exact,\n                sensitive,\n                strict\n              })\n            : null;\n          const isActive = !!(isActiveProp\n            ? isActiveProp(match, currentLocation)\n            : match);\n\n          let className =\n            typeof classNameProp === \"function\"\n              ? classNameProp(isActive)\n              : classNameProp;\n\n          let style =\n            typeof styleProp === \"function\" ? styleProp(isActive) : styleProp;\n\n          if (isActive) {\n            className = joinClassnames(className, activeClassName);\n            style = { ...style, ...activeStyle };\n          }\n\n          const props = {\n            \"aria-current\": (isActive && ariaCurrent) || null,\n            className,\n            style,\n            to: toLocation,\n            ...rest\n          };\n\n          // React 15 compat\n          if (forwardRefShim !== forwardRef) {\n            props.ref = forwardedRef || innerRef;\n          } else {\n            props.innerRef = innerRef;\n          }\n\n          return <Link {...props} />;\n        }}\n      </RouterContext.Consumer>\n    );\n  }\n);\n\nif (__DEV__) {\n  NavLink.displayName = \"NavLink\";\n\n  const ariaCurrentType = PropTypes.oneOf([\n    \"page\",\n    \"step\",\n    \"location\",\n    \"date\",\n    \"time\",\n    \"true\",\n    \"false\"\n  ]);\n\n  NavLink.propTypes = {\n    ...Link.propTypes,\n    \"aria-current\": ariaCurrentType,\n    activeClassName: PropTypes.string,\n    activeStyle: PropTypes.object,\n    className: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    exact: PropTypes.bool,\n    isActive: PropTypes.func,\n    location: PropTypes.object,\n    sensitive: PropTypes.bool,\n    strict: PropTypes.bool,\n    style: PropTypes.oneOfType([PropTypes.object, PropTypes.func])\n  };\n}\n\nexport default NavLink;\n"],"sourceRoot":""}